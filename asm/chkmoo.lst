


      / CHEKMO II                                                         Page 1


    1              / CHEKMO II
    2        0063  ZZZ=63
    3              /AUTHOR    JOHN E. COMEAU
    4              
    5              
    6              
    7              
    8              
    9              
   10              
   11              
   12              
   13              
   14              
   15              
   16              
   17              
   18              
   19              
   20              
   21              /   :::::::::::::::::::::::::::::::
   22              /   :                             :
   23              /   :                             :
   24              /   :                             :
   25              /   :           CHEKMO II         :
   26              /   :     CHESS PROGRAM  2/74     :
   27              /   :                             :
   28              /   :                             :
   29              /   :                             :
   30              /   :::::::::::::::::::::::::::::::
   31              
   32              
   33              
   34              
   35              / FIELD 0  CORE UTILIZATION
   36              
   37              /       0000-0177       CONSTANTS AND POINTERS
   38              /       0200-0377       INITIALIZATION
   39              /       0400-4777       THE THINKER PART
   40              /       5000-6377       INPUT/OUTPUT ROUTINES
   41              /       6400-7377       PUSH DOWN LIST AREA
   42              /       7400-7577       BOARD & MISC. TABLES
   43              /       7600-7777       BINARY LOADER PROGRAM
   44              /SYMBOL DEFINITIONS
   45              /MISC. SYMBOLS
   46        6400  PDLS=6400       /BEGINING OF 1000(OCTAL) WORDS RESERVED FOR PUSH DOWN LISTS
   47              
   48              /PIECE VALUES DEFINED
   49              DECIMAL
   50        0740  KING=   15^32   /15. RELATIVE TO A PAWNS VALUE



      / CHEKMO II                                                         Page 2


   51        0440  QUEEN=  9^32    /9.0 RELATIVE TO A PAWNS VALUE
   52        0240  ROOK=   5^32    /5.0 RELATIVE TO A PAWNS VALUE
   53        0152  BISHOP= 3^32+10 /3.3 RELATIVE TO A PAWNS VALUE
   54        0144  KNIGHT= 3^32+4  /3.1 RELATIVE TO A PAWNS VALUE
   55        0040  PAWN=   1^32    /1.0 RELATIVE TO A PAWNS VALUE
   56              
   57              OCTAL
   58              
   59              /PSEUDO INSTRUCTIONS DEFINED
   60        4577  PUSH1=  JMS  I  [PUSH01 /PUSH THE AC INTO PUSH DOWN LIST #1
   61        4576  POP1=   JMS  I  [POP01  /POP THE TOP ENTRY OF PUSH DOWN LIST #1 INTO THE AC
   62        4575  PRINTO= JMS  I  [MES    /PRINT 6BIT 2CHAR/WORD TEXT AT ADDRESS SPECIFIED IN THE AC
   63        4574  IPDL1=  JMS  I  [IPDL01 /INITIALIZE PUSH DOWN LIST #1
   64        4573  PUSH2=  JMS  I  [PUSHIT /PUSH THE CONTENTS OF THE AC INTO PUSH DOWN LIST #2
   65        4572  POP2=   JMS  I  [POPIT  /POP THE TOP ENTRY OF PUSH DOWN LIST #2 INTO THE AC
   66        4571  IPDL2=  JMS  I  [PDLIN  /INITIALIZE PUSH DOWN LIST #2
   67        4570  SNO=    JMS  I  [RFOFL  /SKIP NO OVERFLOW (C(AC)>=0 & C(AC8)=0)
   68              
   69              /PDP 8/E IOTS DEFINED
   70        6007  CAF= 6007
   71        6661  PSKF=6661
   72        6662  PCLF=6662
   73        6663  PSKE=6663
   74        6664  PSTB=6664
   75        6667  PCIE=6667
   76              
   77              /CONDITIONAL ASSEMBLY DEFINITIONS
   78        0001  OS8=1                   /NO SPECIAL MEANING TO "^C"
   79        0001  LPTREE=1                /DON'T INCLUDE LINE PRINTER CAPABILITIES
   80        0001  DEBUG=1                 /OPT FOR DYNAMIC ERROR DETECTION
   81        0001  RANVAL=1                /NOISY EVALUATIONS PLEASE
   82              
   83              /DEFAULT ASSEMBLY DEFINITIONS
   84              IFNDEF  OS8     <OS8=0>         /NON OS8 SYSTEM
   85              IFNDEF  DEBUG   <DEBUG=0>       /DEBUG SWITCH CLEARED
   86              IFNDEF  LPTREE  <LPTREE=0>      /DONT INCLUDE TREE PRINTOUT CAPABILITIES
   87              IFNDEF  RANVAL  <RANVAL=1>      /INCLUDE A SMIDGEN OF RANDOMNESS IN EVALUATIONS
   88              
   89              /ABREVIATIONS USED
   90              
   91              / SQR   SQUARE
   92              / INC   INCREMENT
   93              / #     NUMBER
   94              / =     EQUALS
   95              / -     MINUS, NEGATIVE OR TO
   96              / &     AND
   97              / INFO  INFORMATION
   98              / AC    ACCUMULATOR
   99              / TEMP  TEMPORARY
  100              /K-SIDE KING SIDE



      / CHEKMO II                                                         Page 3


  101              /Q-SIDE QUEEN SIDE
  102              / LOC   LOCATION
  103              / CR    CARRIAGE RETURN
  104              / LF    LINE FEED
  105              / MSW   MOVE SQUARE WORD
  106              / MDW   MOVE DATA WORD
  107              / CHAR  CHARACTER
  108              / W/    WITH
  109              / <     LESS THAN
  110              / >     GREATER THAN
  111              / PSW   POSITION STATUS WORD
  112              / ADDR  ADDRESS
  113              / PDL   PUSH DOWN LIST
  114              / PDL#1 PUSH DOWN LIST #1
  115              / PDL#2 PUSH DOWN LIST #2
  116              / ABS   ABSOLUTE
  117              / PROM  PROMOTION
  118              / ARG   ARGUMENT
  119              / VAL   VALUE
  120              
  121              /              MOVE SQUARE WORD(MSW) FORMAT
  122              /
  123              /  -------------------------------------------------------------------------  
  124              /  I     I     I     I     I     I     I     I     I     I     I     I     I
  125              /  I  0  I  1  I  2  I  3  I  4  I  5  I  6  I  7  I  8  I  9  I  10 I  11 I
  126              /  I     I     I     I     I     I     I     I     I     I     I     I     I  
  127              /  -------------------------------------------------------------------------  
  128              /  I                                  I I                                 I  
  129              /   -----------------I----------------- -----------------I-----------------  
  130              / 
  131              /         SIXBIT ADDRESS OF THE                SIXBIT ADDRESS OF THE   
  132              /            "FROM SQUARE"                         "TO SQUARE"
  133              
  134              
  135              
  136              
  137              
  138              
  139              /               MOVE DATA WORD(MDW) FORMAT
  140              /  -------------------------------------------------------------------------  
  141              /  I     I     I     I     I     I     I     I     I     I     I     I     I
  142              /  I  0  I  1  I  2  I  3  I  4  I  5  I  6  I  7  I  8  I  9  I  10 I  11 I  
  143              /  I     I     I     I     I     I     I     I     I     I     I     I     I  
  144              /  -------------------------------------------------------------------------  
  145              /     I   I         I I                                 I I               I  
  146              /     I    ----I----   ----------------I----------------   -------I-------   
  147              /     I   
  148              /     I      UNUSED       = THE SIXBIT ADDRESS OF       0 = NORMAL  
  149              /     I      ALLWAYS      THE "TO SQUARE" IF THE        1 = QUEEN SIDE CASTLING 
  150              /     I      EQUALS 0     MOVE IS A 2 SQUARE            2 = KING SIDE CASTLING  



      / CHEKMO II                                                         Page 4


  151              /     I                   PAWN MOVE                     3 = EN PASSANT CAPTURE  
  152              /     I                                                 4 = PAWN PROM. TO KNIGHT
  153              /     I                                                 5 = PAWN PROM. TO BISHOP
  154              /     I                                                 6 = PAWN PROM. TO ROOK
  155              /     I                                                 7 = PAWN PROM. TO QUEEN
  156              /     I  
  157              /     I  
  158              /     I  
  159              /     I  
  160              / 
  161              / = 1 IF THIS MOVE 
  162              / IS A CAPTURE     
  163              
  164              
  165        0000  *0000
  166              /INTERRUPT!
  167 00000  0000  IFRM,   0000
  168 00001  5402          JMP  I  .+1
  169 00002  5000          INTHAN          /ADDRESS OF THE INTERUPT HANDLER
  170 00003  0063  REV,    ZZZ             /LOC 3 HOLDS PROGRAM REVISION #
  171 00004  0000  ODT4,   0000    /LOCATIONS 4, 5, AND 6 ARE RESERVED FOR DEBUGERS
  172 00005  0000  ODT5,   0000
  173 00006  0000  ODT6,   0000
  174              
  175              / ZERO PAGE CONSTANTS
  176        0011  *11
  177 00011  0000  RANDOM, 0000
  178 00012  0000  XR0,    0000
  179 00013  0000  ITMP0,  0000
  180 00014  0000  ITMP1,  0000            /AUTO-INCREMENT TEMPORARY STORAGE
  181 00015  0000  ITMP2,  0000
  182 00016  7447  CLIST,  KBUF-1          /INPUT BUFFER POINTER
  183 00017  0000  LIST2,  0000
  184 00020  0000  TEMP,   0000            /TEMPORARY STORAGE LOCATIONS
  185 00021  0000  TEMP1,  0000            /           .
  186 00022  0000  TEMP2,  0000            /           .
  187 00023  0000  TEMP3,  0000            /           .
  188 00024  0000  TEMP4,  0000            /           .
  189 00025  0000  TMP,    0000            /TEMPORARY STORAGE
  190 00026  5231  ZOUT,   OUT             /POINTS TO OUTPUT ROUTINE
  191 00027  0000  CHAR,   0000            /TEMP. STORAGE PLACE FOR A CHARACTER
  192 00030  5240  ZCRLF,  CRLF            /POINTS TO CR-LF PRINTING ROUTINE
  193 00031  0000  XXXX,   0000            /TEMPORARY STORAGE
  194 00032  5252  ZBEGIN, BEGIN           /POINTS TO INPUT INITIATING ROUTINE
  195 00033  0000  CNTCHR, 0000            /CHARACTER COUNT
  196 00034  0000  ISW,    0000            /INPUT SWITCH
  197 00035  5263  ZGETC,  GETC            /POINTS TO INPUT BUFFER READING ROUTINE
  198 00036  0001  PONDIR, 0001            /PAWN DIRECTION CONSTANT
  199 00037  0000  M1,     0000
  200 00040  0000  M2,     0000



      / CHEKMO II                                                         Page 5


  201 00041  0000  M3,     0000
  202 00042  0000  M4,     0000
  203 00043  0000  GN1,    0000            /COMMON STORAGE FOR THE MOVE GENERATION ROUTINES
  204 00044  0000  GN2,    0000            /               .
  205 00045  0000  GN3,    0000            /               .
  206 00046  0000  GN4,    0000            /               .
  207 00047  0000  GNMSW,  0000            /               .
  208 00050  0000  GNMDW,  0000            /               .
  209 00051  7777  FSTRNK, 7777            /-VALUE OF THE FIRST RANK
  210 00052  5070  ZCHKIO, CHKIO           /POINTS TO IO STALL ROUTINE
  211 00053  0000  WPSW,   0000            /WHITES POSITION STATUS WORD
  212 00054  0000  BPSW,   0000            /BLACKS POSITION STATUS WORD
  213 00055  0000  CPSW,   0000            /ADDRESS OF CURRENT POSITION STATUS WORD IS KEPT HERE
  214 00056  0000  GMAP,   0000
  215 00057  0000  OMAP,   0000
  216 00060  0000  TOMAK1, 0000            /MOVE SQUARE WORD HERE
  217 00061  0000  TOMAK2, 0000            /MOVE DATA WORD HERE
  218 00062  0000  DIR1,   0000
  219 00063  0000  DIR2,   0000
  220 00064  0000  CNTR1,  0000
  221 00065  0000  WKING,  0000            /ADDRESS OF THE WHITE KING IS STORED HERE
  222 00066  0000  BKING,  0000            /ADDRESS OF THE BLACK KING IS STORED HERE
  223 00067  0000  CKING,  0000            /ADRESS OF THE KING BEING TESTED
  224 00070  0000  TKING,  0000            /TEMP STORAGE FOR KING ADDR
  225 00071  0000  LSTMV,  0000            /LOCATION WHICH DESCRIBES THE LAST MOVE MADE IF DOUBLE PAWN MOVE
  226 00072  0400  ZGNMV,  GNMV            /POINTS TO MOVE GENERATION ROUTINE
  227 00073  2624  ZMKMV,  MKMV            /POINTS TO THE MOVE MAKING ROUTINE
  228 00074  3000  ZUNMV,  UNMV            /POINTS TO THE MOVE UNMAKING ROUTINE
  229 00075  1515  ZMAPEC, MAPEC           /POINTS TO PIECE MAP ROUTINE
  230 00076  0000  PW,     0000            /SET = TO TOTAL VALUE OF ALL PIECES ON THE BOARD BY 'MAPEC'
  231 00077  0000  WHOSE,  0000            /THIS LOC =0 IF IT IS WHITES MOVE, =-1 IF BLACKS
  232 00100  0000  PCNT,   0000            /USED BY CHKATK =# OF PIECES ATTACKING THE SQUARE
  233 00101  0000  PVAL,   0000            /USED BY CHKATK =LEAST VALUABLE ATTACKER
  234 00102  0000  PSQR,   0000            /USED BY CHKATK =ADDRESS OF THE LEAST VALUABLE ATTACKING PIECE
  235 00103  3130  ZSPLIT, SPLIT           /POINTS TO A SUBROUTINE WHICH SPLITS UP A MSW
  236 00104  2400  ZTSTCH, TSTCHK          /POINTS TO CHECK TESTING ROUTINE
  237 00105  2400  ZFNL,   TSTCHK          /POINTS TO FINAL LEGAL MOVE VERIFICATION ROUTINE
  238 00106  0000  GNCNT,  0000            /LOC=NUMBER OF MOVES GENERATED BY GNWMV
  239 00107  0000  TOADR,  0000
  240 00110  0000  IOMDW,  0000            /ARGUMENT STORAGE FOR I/O ROUTINES
  241 00111  0000  IOMSW,  0000            /ARGUMENT STORAGE FOR I/O ROUTINES
  242 00112  0000  CMSW,   0000            /CHECKMATE SWITCH
  243 00113  0000  SMSW,   0000            /STALEMATE SWITCH
  244 00114  0000  COMP,   0000
  245 00115  3400  ZLOOKA, LOOKA           /POINTS TO THE RECURSIVE LOOKAHEAD SUBROUTINE
  246 00116  0000  UVAL1,  0000
  247 00117  3777  CVAL1,  3777
  248 00120  0000  RVAL1,  0000
  249 00121  0000  MVAL1,  0000            /HOLDS MOBILITY VALUE
  250 00122  0000  PLY,    0000            /HOLDS CURRENT RECURSION LEVEL OF THE "LOOKA" SUBROUTINE



      / CHEKMO II                                                         Page 6


  251 00123  0003  DEPTH,  0003            /HOLDS THE MAXIMUM RECURSION LEVEL FOR THE "LOOKA" SUBROUTINE
  252 00124  0000  RDEPTH, 0000
  253 00125  0000  BUG,    0000
  254 00126  0000  RNKKNT, 0000            /TEMP STORAGE FOR BOARD OUTPRINT & BOARD INPUT ROUTINES
  255 00127  0000  FILKNT, 0
  256 00130  0000  PIECE,  0
  257 00131  0000  COLOR,  0
  258 00132  0000  RNKPTR, 0
  259 00133  0000  MOBMOD, 0000
  260 00134  0000  KNGBLK, 0000            /SET BY "GNMV" TO # OF KING MOVES ILLEGAL BECAUSE OF CHECK
  261 00135  0000  MOB0,   0000
  262 00136  0000  MOB1,   0000
  263 00137  0000  CTNEED, 0000
  264 00140  0000  STRATG, 0000            /HOLDS STRATEGIC VALUE
  265 00141  0000  PC01,   0000            /POINTER FOR PUSH DOWN LIST #1
  266 00142  0000  PDLADR, 0000            /POINTER FOR PUSH DOWN LIST #2
  267              IFNZRO  DEBUG<
  268 00143  0000  ENO,    0000
  269 00144  0000  ENOB,   0000
  270              >
  271 00145  0000  WHOWHI, 0000
  272 00146  0000  WHOBLK, 0000
  273 00147  0000  COMTMP, 0000
  274 00150  0000  BOGUS,  0000
  275 00151  0000  DOMAP,  0000
  276        0200  *200
  277              START,  IFNZRO LPTREE   <
  278 00200  1377          TAD     (OUT
  279 00201  3026          DCA     ZOUT    /MAKE SURE OUTPUT GOES TO THE TTY
  280              >
  281 00202  4430          JMS  I  ZCRLF
  282 00203  4575          PRINTO; NAME    /PRINT "CHEKMO-II"
      00204  5552
  283 00205  4430          JMS  I  ZCRLF
  284 00206  3077          DCA     WHOSE
  285 00207  4776@         JMS     SETBRD  /SETUP THE BOARD
  286 00210  3145  COMPN,  DCA     WHOWHI  /RESET SWITCH FOR THE USER TO PLAY WHITE
  287 00211  3146          DCA     WHOBLK  /RESET SWITCH FOR THE USER TO PLAY BLACK
  288 00212  4571  COMMAN, IPDL2           /INITIALIZE PUSH DOWN LISTS
  289 00213  4574          IPDL1
  290 00214  2151          ISZ     DOMAP   /MAKE SURE A PIECE MAP IS REALY DONE
  291 00215  4775@         JMS     QMATE   /TEST FOR SIDE TO MOVE IN CHECKMATE OR STALEMATE
  292 00216  1077          TAD     WHOSE   /GET "WHOSE MOVE" SWITCH
  293 00217  7710          SPA CLA         /IS IT WHITES OR BLACKS MOVE?
  294 00220  5301          JMP     BLKMVE  /BLACKS
  295 00221  4575          PRINTO; MESG23  /PRINT "W. "
      00222  6350
  296 00223  1145          TAD     WHOWHI  /GET THE "WHO PLAYS WHITE" SWITCH
  297 00224  7640          SZA CLA         /DOES THE COMPUTER PLAY ON BEHALF OF WHITE?
  298 00225  5306          JMP     CMOVE   /YES



      / CHEKMO II                                                         Page 7


  299 00226  4575  USER,   PRINTO; MESG24  /PRINT "YOUR MOVE?"
      00227  5155
  300 00230  4432          JMS  I  ZBEGIN  /SETUP TO ACCEPT A LINE OF INPUT
  301 00231  6001          ION             /ACCEPT IT ANY TIME NOW
  302 00232  4452          JMS  I  ZCHKIO  /WAIT FOR IT TO FINISH
  303 00233  4435          JMS  I  ZGETC   /GET 1ST CHAR
  304 00234  0167          AND     [0077   /ONLY NEED 6 BITS
  305 00235  7106          RTL CLL         /MOVE THEM TO THE HIGH ORDER 6 BITS
  306 00236  7006          RTL             /POSITION
  307 00237  7006          RTL
  308 00240  3147          DCA     COMTMP  /STORE FOR A WHILE
  309 00241  4435          JMS  I  ZGETC   /GET 2ND CHAR
  310 00242  0167          AND     [0077   /ONLY NEED 6 BITS
  311 00243  1147          TAD     COMTMP  /WE NOW HAVE THE FIRST 2 INPUT CHARS PACKED
  312 00244  3147          DCA     COMTMP  /6BIT STYLE IN 1 WORD
  313 00245  1374          TAD     (COMLST-2/ADDRESS-2 OF THE COMMAND LIST
  314 00246  3012          DCA     XR0     /TO AUTO INDEX REGISTER
  315 00247  2012  NUTHER, ISZ     XR0     /INC POINTER TO POINT AT A 6BIT COMMAND IN THE COMMAND LIST
  316 00250  1412          TAD  I  XR0     /GET A LEGAL 6BIT COMMAND
  317 00251  7450          SNA             /WERE THERE ANY MORE TO GET?
  318 00252  5271          JMP     UINP    /NO. THE USER MUST BE TRYING TO ENTER A MOVE
  319 00253  1147          TAD     COMTMP  /YES. COMPARE WITH THE ONE THE USER JUST INPUTED
  320 00254  7640          SZA CLA         /IS IT A MATCH?
  321 00255  5247          JMP     NUTHER  /NO. TRY AGAIN
  322 00256  1412          TAD  I  XR0     /YES. GET THE TRANSFER ADDRESS
  323 00257  3020          DCA     TEMP
  324 00260  5420          JMP  I  TEMP    /TRANSFER
  325              
  326 00261  2145  COMPW,  ISZ     WHOWHI  /SET SWITCH TO INDICATE THAT WHITE IS PLAYED 
  327 00262  5212          JMP     COMMAN  /BY THE COMPUTER
  328              
  329 00263  2146  COMPB,  ISZ     WHOBLK  /SET THE SWITCH TO INDICATE THAT BLACK IS PLAYED
  330 00264  5212          JMP     COMMAN  /BY THE COMPUTER
  331              
  332 00265  4773@ COMBD,  JMS     DISPLAY /DISPLAY THE BOARD ON THE TELLETYPE
  333 00266  5212          JMP     COMMAN
  334              
  335 00267  4772@ COMIP,  JMS     INPUT   /GET THE INPUT OF A POSITION FROM THE TELLETYPE
  336 00270  5210          JMP     COMPN
  337              
  338 00271  4432  UINP,   JMS  I  ZBEGIN  /REINIT THE KEYBOARD BUFFER POINTER
  339 00272  4771@         JMS     INMV    /WAS A LEGAL MOVE TYPED IN?
  340 00273  7610          SKP CLA         /NO.
  341 00274  5212          JMP     COMMAN  /YES. IT WAS ALSO MADE BY THE "INMOVE" SUBROUTINE
  342 00275  1370          TAD     ("?     /PRINT A "?"
  343 00276  4426          JMS  I  ZOUT    /TO INDICATE THE ERROR
  344 00277  4430          JMS  I  ZCRLF
  345 00300  5212          JMP     COMMAN  /TRY AGAIN
  346              
  347 00301  4575  BLKMVE, PRINTO; MESG22  /BRINT "B. "



      / CHEKMO II                                                         Page 8


      00302  6346
  348 00303  1146          TAD     WHOBLK
  349 00304  7650          SNA CLA         /DOES THE USER PLAY BLACK, OR DOES THE COMPUTER?
  350 00305  5226          JMP     USER    /THE USER
  351 00306  7200  CMOVE,  CLA             /COMPUTER NOW MAKES A MOVE
  352 00307  1367          TAD     (3777   /INITIALIZE SEARCH VALUE TO PREVENT PRUNING AT THE FIRST PLY
  353 00310  3117          DCA     CVAL1
  354 00311  3122          DCA     PLY     /MAKE SURE PLY # IS 0 BEFORE ENTERING RECURSIVE EVALUATOR
  355                      IFNZRO  LPTREE<
  356 00312  1366          TAD     (LPTOUT /SWITCH OUTPUT DEVICE TO LINE PRINTER
  357 00313  3026          DCA     ZOUT
  358 00314  4430          JMS  I  ZCRLF
  359 00315  4773@         JMS     DISPLA  /PRINT THE BOARD AT PLY 0
  360 00316  4765@         JMS     TABPLY
  361              >
  362 00317  7240          CMA CLA
  363 00320  1123          TAD     DEPTH   /DO A SHORT "PRE ANALYSIS"
  364 00321  7450          SNA             /UNLESS WE ARE IN "BLITZ MODE" (DEPTH OF 1)
  365 00322  5332          JMP     CMOVE1  /WHICH WE ARE
  366 00323  7001          IAC
  367 00324  3124          DCA     RDEPTH  /SAVE THE REAL DEPTH
  368 00325  7001          IAC
  369 00326  3123          DCA     DEPTH   /SET THE DEPTH TO 1 TEMPORARILY
  370 00327  4515          JMS  I  ZLOOKA  /FIND OUT WHICH MOVE LOOKS THE BEST
  371 00330  1124          TAD     RDEPTH
  372 00331  3123          DCA     DEPTH   /RESTORE THE REAL DEPTH
  373 00332  4515  CMOVE1, JMS  I  ZLOOKA  /FIGURE OUT WHICH MOVE TO MAKE
  374                      IFNZRO  LPTREE<
  375 00333  1377          TAD     (OUT    /SWITCH OUTPUT DEV. BACK TO TTY
  376 00334  3026          DCA     ZOUT
  377              >
  378 00335  1764@         TAD     BESTBL
  379 00336  3111          DCA     IOMSW
  380 00337  1763@         TAD     BESTBL+1
  381 00340  3110          DCA     IOMDW
  382 00341  1764@         TAD     BESTBL  /GET THE LAST MOVE TO WIN A COMPARE ON PLY #1
  383 00342  3060          DCA     TOMAK1  /FROM THE TABLE OF BEST MOVES
  384 00343  1763@         TAD     BESTBL+1
  385 00344  3061          DCA     TOMAK2
  386 00345  4473          JMS  I  ZMKMV   /MAKE THE MOVE
  387 00346  4762@         JMS     OUTMV   /PRINT OUT THE MOVE JUST MADE
  388 00347  4761@         JMS     GNMVSM  /GENERATE MOVES FOR THE SIDE TO MOVE
  389 00350  1760@         TAD     GNCHEK  /GET # OF ATTACKS ON THE KING
  390 00351  7640          SZA CLA         /IS THE SIDE TO MOVE IN CHECK?
  391 00352  1357          TAD     ("+     /YES. PRINT A "+" TO INDICATE IT
  392 00353  4426          JMS  I  ZOUT
  393 00354  4430          JMS  I  ZCRLF
  394 00355  5212          JMP     COMMAN
  395              
      00357  0253



      / CHEKMO II                                                         Page 9


      00360  0513
      00361  3526
      00362  5600
      00363  3673
      00364  3672
      00365  5347
      00366  6007
      00367  3777
      00370  0277
      00371  5400
      00372  6200
      00373  6035
      00374  5116
      00375  5720
      00376  4704
      00377  5231
  396              PAGE
  397              /THIS SUBROUTINE GENERATES ALL MOVES FOR A SIDE
  398              /AND STICKS THEM INTO PDL2.
  399              /THIS SUBROUTINE IN ADDITION...
  400              /SETS "GNCNT" TO THE # OF MOVES GENERATED
  401              /SETS "CMSW" TO A NON-ZERO VALUE IF NO MOVES CAN BE GENERATED BECAUSE OF CHECKMATE
  402              /SETS "SMSW" TO A NON-ZERO VALUE IF NO MOVES CAN BE GENERATED BECAUSE OF STALEMATE
  403              /SETS "GNCHEK" TO THE NUMBER OF PIECES ATTACKING THE KING IF THE KING IS IN CHECK
  404              /SETS "KNGBLK" TO THE NUMBER OF ADJACENT SQUARES THE KING CANNOT MOVE
  405              /INTO BECAUSE THAT WOULD PUT HIM IN CHECK
  406              /SETS "MOBMOD" TO THE MOVING SIDES MOBILITY VALUE, BASED ON "GNCNT" AND
  407              /THE NUMBER OF MOVES THAT ARE ILLEGAL BECAUSE THEY DO NOT
  408              /GET THE KING OUT OF CHECK, BUT ARE OTHERWISE LEGAL, MINUS
  409              /50% OF THE TOTAL # OF QUEEN MOVES.
  410              /IF THIS ROUTINE IS CALLED WITH "BOGUS" SET TO A NON-ZERO VALUE
  411              /THIS SUBROUTINE WILL NOT PUT ANY MOVES IN PDL#2 OR TRY TO GENERATE
  412              /EN PASSANT PAWN CAPTURES
  413              /THIS SUBROUTINE SETS BOGUS TO ZERO BEFORE RETURNING
  414 00400  0000  GNMV,   0000
  415 00401  7300          CLL CLA
  416 00402  3133          DCA     MOBMOD  /INITIALIZE THE MOBMOD COUNTER
  417 00403  3134          DCA     KNGBLK  /INITIALIZE THE BLOCKED KING MOVE COUNTER
  418 00404  3112          DCA     CMSW    /INITIALIZE CHECKMATE SWITCH TO = NO CHECKMATE
  419 00405  3113          DCA     SMSW    /INITIALIZE STALEMATE SWITCH TO = NO STALEMATE
  420 00406  3312          DCA     QMVCNT  /INIT QUEEN MOVE COUNTER
  421 00407  1067          TAD     CKING   /TEST FOR KING IN CHECK
  422 00410  3020          DCA     TEMP
  423 00411  4777@         JMS     CHKATK  /CALL W/AC CLEAR---FIND ALL ATTACKS ON THE KING
  424 00412  1100          TAD     PCNT    /GET # OF ATTACKS
  425 00413  3313          DCA     GNCHEK  /SAVE THE # OF ATTACKS ON THE KING
  426 00414  3106          DCA     GNCNT   /INITIALIZE GENERATION COUNT = 0
  427 00415  1150          TAD     BOGUS
  428 00416  7640          SZA CLA         /ARE WE GOING TO BE PUTTING MOVES IN PDL#2?
  429 00417  5222          JMP     .+3     /NO. NO NEED FOR MARKERS THEN



      / CHEKMO II                                                        Page 10


  430 00420  4573          PUSH2           /YES. FIRST THING TO DO IS PUSH 2 BLANK WORDS
  431 00421  4573          PUSH2           /TO MARK LIST PLACE
  432 00422  1067          TAD     CKING   /SETUP TO GENERATE KING MOVES
  433 00423  3064          DCA     CNTR1
  434 00424  1064          TAD     CNTR1   /SPLIT THE KINGS SQUARES ADDR UP INTO RANK AND FILE #'S
  435 00425  0166          AND     [0007
  436 00426  3044          DCA     GN2     /STORE THE FILE #
  437 00427  1064          TAD     CNTR1
  438 00430  7012          RTR
  439 00431  7010          RAR
  440 00432  0166          AND     [0007
  441 00433  3043          DCA     GN1     /STORE THE RANK #
  442 00434  4776@         JMS     GKM     /GENERATE THOSE KING MOVES
  443 00435  1313          TAD     GNCHEK  /GET THE NUMBER OF PIECES PRESENTLY CHECKING THE KING
  444 00436  7110          RAR CLL         /NO COMMENT
  445 00437  7640          SZA CLA         /IS THE KING IN DOUBLE CHECK?
  446 00440  5314          JMP     TSCMSM  /YES. NO USE TRYING TO GENERATE MOVES BY OTHER PIECES
  447 00441  1150          TAD     BOGUS   /NO.
  448 00442  7650          SNA CLA         /IS THIS FOR REAL?
  449 00443  4775@         JMS     GNEP    /YES. GENERATE ANY POSIBLE 'EN PASSANT' PAWN CAPTURES NOW
  450 00444  1056          TAD     GMAP    /ADDRESS-1 OF MAP
  451 00445  3015          DCA     ITMP2   /STORE IT
  452 00446  7300  NXTSQR, CLL CLA
  453 00447  1415          TAD  I  ITMP2   /GET THE ADDRESS OF THE NEXT PIECE
  454 00450  7450          SNA             /IS IT REALY A PIECE?
  455 00451  5314          JMP     TSCMSM  /NO. MOVES ARE ALL GENERATED.
  456 00452  3064          DCA     CNTR1   /YES. STORE ITS ADDRESS
  457 00453  7001          IAC
  458 00454  3137          DCA     CTNEED  /INITIALIZE THE CHECK TEST NEED SWITCH
  459 00455  1064          TAD     CNTR1   /NOW STRIP RANK AND FILE NUMBERS FROM THE ADDRESS
  460 00456  0166          AND     [0007
  461 00457  3044          DCA     GN2     /STORE THE FILE NUMBER
  462 00460  1064          TAD     CNTR1
  463 00461  7012          RTR
  464 00462  7010          RAR
  465 00463  0166          AND     [0007
  466 00464  3043          DCA     GN1     /STORE THE RANK NUMBER
  467 00465  1464          TAD  I  CNTR1   /GET THE VALUE OF THE PIECE ON THE SQUARE
  468 00466  4774@         JMS     CLRFIX
  469 00467  1165          TAD     [-PAWN
  470 00470  7450          SNA             /IS IT A PAWN?
  471 00471  5773@         JMP     GPM     /YES
  472 00472  1372          TAD     (PAWN-KNIGHT
  473 00473  7450          SNA             /IS IT A KNIGHT?
  474 00474  5771@         JMP     GNM     /YES
  475 00475  1370          TAD     (KNIGHT-BISHOP
  476 00476  7450          SNA             /IS IT A BISHOP?
  477 00477  5767@         JMP     GBM     /YES
  478 00500  1366          TAD     (BISHOP-ROOK
  479 00501  7450          SNA             /IS IT A ROOK?



      / CHEKMO II                                                        Page 11


  480 00502  5765@         JMP     GRM     /YES
  481 00503  1364          TAD     (ROOK-KING
  482 00504  7450          SNA             /IS IT A KING?
  483 00505  5246          JMP     NXTSQR  /YES. TRY NEXT PIECE SINCE KING MOVES HAVE ALLREADY BEEN GENERATED
  484 00506  1363          TAD     (KING-QUEEN
  485 00507  7450          SNA             /IS IT A QUEEN?
  486 00510  5762@         JMP     GQM     /YES
  487 00511  7402          HLT             /NO. SOMTHINGS WRONG HERE !
  488              
  489 00512  0000  QMVCNT, 0000
  490 00513  0000  GNCHEK, 0000
  491              
  492 00514  1312  TSCMSM, TAD     QMVCNT  /ADD # OF QUEEN MOVES & QUEEN MOVE REJECTS
  493 00515  7110          CLL RAR         /DIVIDE BY 2
  494 00516  1312          TAD     QMVCNT
  495 00517  7110          CLL RAR         /AC WIL EQUAL 3/4 OF THE # OF QUEEN MOVES & REJECTS
  496 00520  7041          CIA             /SUBTRACT
  497 00521  1133          TAD     MOBMOD  /FROM THE MOBILITY MODIFIER
  498 00522  1106          TAD     GNCNT   /ADD "REAL" MOBILITY IN WITH THE MOBILITY MODIFIER
  499 00523  3133          DCA     MOBMOD
  500 00524  3150          DCA     BOGUS
  501 00525  1106          TAD     GNCNT   /GET # OF MOVES GENERATED
  502 00526  7640          SZA CLA         /ANY?
  503 00527  5600          JMP  I  GNMV    /YES: RETURN
  504 00530  1313          TAD     GNCHEK  /NO. ITS EITHER A CHECKMATE OR STALEMATE POSITION
  505 00531  7450          SNA             /WAS THE KING IN CHECK?
  506 00532  2113          ISZ     SMSW    /NO. SET THE STALEMATE SWITCH
  507 00533  3112          DCA     CMSW    /IF KING WAS IN CHECK (GNCHEK>=1) SET THE CHECKMATE SWITCH
  508 00534  5600          JMP  I  GNMV    /RETURN
  509              
  510              IFNZRO DEBUG<
  511              /ROUTINE TO ALLOW THE TIMING OF THE "GNMV" SUBROUTINE
  512              /CALLS IT 4000(OCTAL) TIMES, THEN HALTS
  513 00535  4571  TIME,   IPDL2
  514 00536  4574          IPDL1
  515 00537  4761@         JMS     GNWMV
  516 00540  2342          ISZ     .+2
  517 00541  5335          JMP     .-4
  518 00542  4000          4000            /# OF ITTERATIONS OF THE TIMING LOOP
  519 00543  7402          HLT
  520              >
  521              
  522              /  SNO -- SKIP NO OVERFLOW
  523              /PSEUDO-INSTRUCTION TO TEST FOR RANK OR FILE OVERFLOW.
  524              /EFFECTIVLY SKIPS IF NO OVERFLOW. CALL WITH RANK OR FILE
  525              /NUMBER IN AC. RETURN WITH NUMBER IN AC IF NO OVERFLOW, GARBAGE OTHERWISE
  526 00544  0000  RFOFL,  0000
  527 00545  7510          SPA             /LESS THAN ZERO?
  528 00546  5744          JMP  I  RFOFL   /YES. RETURN
  529 00547  7012          RTR             /SHIFT BIT 8 INTO LINK



      / CHEKMO II                                                        Page 12


  530 00550  7012          RTR             /IF IT'S SET OVERFLOW HAS OCCURED
  531 00551  7430          SZL             /GREATER THAN 7?
  532 00552  5744          JMP  I  RFOFL   /YES. RETURN (WITH A GARBLED ACCUMULATOR)
  533 00553  7006          RTL
  534 00554  7006          RTL             /SHIFT THE WORD BACK TO NORMAL
  535 00555  2344          ISZ     RFOFL   /INC RETURN ADDRESS
  536 00556  5744          JMP  I  RFOFL   /RETURN
      00561  2513
      00562  0676
      00563  0300
      00564  7300
      00565  0704
      00566  7712
      00567  0712
      00570  7772
      00571  1353
      00572  7674
      00573  1057
      00574  1410
      00575  1413
      00576  1200
      00577  2200
  537              PAGE
  538              
  539              /THIS ROUTINE GENERATES ALL THE MOVES OF A 'STRAIGHT LINE' MOVING
  540              /PIECE. ITMP0 MUST BE PRESET TO THE ADDRESS-1 OF THE MOVE GENERATION
  541              /DIRECTION LIST. LCNT MUST BE SET TO MINUS THE NUMBER OF 2-WORD
  542              /ENTRIES IN THAT LIST
  543 00600  7200  LINE,   CLA
  544 00601  1413          TAD  I  ITMP0   /GET THE VERTICAL DIRECTION
  545 00602  3062          DCA     DIR1    /SAVE IT
  546 00603  1413          TAD  I  ITMP0   /GET THE HORIZINTAL DIRECTION
  547 00604  3063          DCA     DIR2    /SAVE THAT ALSO
  548 00605  1043          TAD     GN1
  549 00606  3045          DCA     GN3
  550 00607  1044          TAD     GN2
  551 00610  3046          DCA     GN4
  552 00611  1045  LINEM,  TAD     GN3     /BUILD SQUARE RANK NUMBER
  553 00612  1062          TAD     DIR1
  554 00613  4570          SNO             /IS THAT RANK REALY ON THE BOARD?
  555 00614  5242          JMP     XXOX    /NO. IT DOES NOT EXIST
  556 00615  3045          DCA     GN3
  557 00616  1063          TAD     DIR2
  558 00617  1046          TAD     GN4
  559 00620  4262          JMS     XYZ
  560 00621  5242          JMP     XXOX
  561 00622  1464          TAD  I  CNTR1   /GET VALUE OF THE MOVING PIECE
  562 00623  4777@         JMS     CLRFIX
  563 00624  1376          TAD     (-QUEEN
  564 00625  7650          SNA CLA         /ARE WE TESTING FOR A LEGAL QUEEN MOVE?



      / CHEKMO II                                                        Page 13


  565 00626  2775@         ISZ     QMVCNT  /YES. INC QUEEN MOVE COUNTER
  566 00627  1047          TAD     GNMSW
  567 00630  4505          JMS  I  ZFNL    /DO FINAL TEST FOR KING CHECK
  568 00631  5237          JMP     XOOO    /MOVE ILLEGAL: KING IS IN CHECK
  569 00632  1507          TAD  I  TOADR   /GET VALUE OF THE 'TO' SQUARE
  570 00633  7640          SZA CLA         /IS THE MOVE A CAPTURE?
  571 00634  7130          STL RAR         /YES: SET CAPTURE BIT
  572 00635  3050          DCA     GNMDW
  573 00636  4247          JMS     GNSTR   /PUSH THE MOVE INTO THE STACK
  574 00637  1507  XOOO,   TAD  I  TOADR   /GET THE VALUE OF THE PIECE ON THE 'TO SQUARE'
  575 00640  7650          SNA CLA         /WAS THE MOVE A CAPTURE?
  576 00641  5211          JMP     LINEM   /NO. COULD BE MORE MOVES IN THIS DIRECTION
  577 00642  7200  XXOX,   CLA             /YES. NO MORE MOVES IN THIS DIRECTION
  578 00643  2246          ISZ     LCNT    /DONE ALL DIRECTIONS?
  579 00644  5200          JMP     LINE    /NO. TRY ANOTHER
  580 00645  5774@         JMP     NXTSQR  /YES. DONE WITH THIS PIECE. TRY NEXT
  581 00646  0000  LCNT,   0000
  582              
  583              /ROUTINE TO STORE THE MSW AND MDW IN THE PDL
  584 00647  0000  GNSTR,  0000
  585 00650  2106          ISZ     GNCNT   /INC GENERATION COUNT
  586 00651  7200          CLA
  587 00652  1150          TAD     BOGUS
  588 00653  7640          SZA CLA         /SHOULD THESE MOVES GO INTO PDL#2?
  589 00654  5647          JMP  I  GNSTR   /NO. DONT PUT ANY THERE!
  590 00655  1047          TAD     GNMSW   /GET MSW
  591 00656  4573          PUSH2           /PUSH IT INTO THE LIST
  592 00657  1050          TAD     GNMDW   /GET THE MDW
  593 00660  4573          PUSH2           /PUSH IT INTO LIST
  594 00661  5647          JMP  I  GNSTR   /RETURN
  595              
  596              /SUBROUTINE TO TEST IF THE 'TO' SQUARE IS OCCUPIED BY OWN PIECE
  597              /IF NOT SKIP FOR RETURN AND BUILD MSW
  598 00662  0000  XYZ,    0000
  599 00663  4570          SNO             /DID IT GO OFF THE BOARD?
  600 00664  5662          JMP  I  XYZ     /YES: RETURN
  601 00665  3046          DCA     GN4     /NO: SAVE THIS HALF
  602 00666  4773@         JMS     BLDTO   /BUILD 'TO' ADDR
  603 00667  1507          TAD  I  TOADR   /GET VALUE OF THE 'TO' SQUARE
  604 00670  4777@         JMS     CLRFIX
  605 00671  7740          SMA SZA CLA     /OCCUPIED BY OWN PIECE?
  606 00672  5662          JMP  I  XYZ     /YES: RETURN
  607 00673  4320          JMS     BLDMSW  /NO: BUILD THE MSW
  608 00674  2262          ISZ     XYZ     /INC RETURN ADDR
  609 00675  5662          JMP  I  XYZ     /RETURN
  610              
  611 00676  7200  GQM,    CLA             /GENERATE QUEEN MOVES
  612 00677  1164          TAD     [-10    /DO ALL DIRECTIONS
  613 00700  3246          DCA     LCNT
  614 00701  1372          TAD     (OTRX-1 /DIAGONAL  AND  ORTHOGONAL



      / CHEKMO II                                                        Page 14


  615 00702  3013          DCA     ITMP0
  616 00703  5200          JMP     LINE
  617              
  618 00704  7200  GRM,    CLA             /GENERATE ROOK MOVES
  619 00705  1371          TAD     (-4     /DO ONLY HALF OF THE DIRECTIONS
  620 00706  3246          DCA     LCNT
  621 00707  1370          TAD     (OTR-1  /THE ORTHOGONAL ONES
  622 00710  3013          DCA     ITMP0
  623 00711  5200          JMP     LINE
  624              
  625 00712  7200  GBM,    CLA             /GENERATE BISHOP MOVES
  626 00713  1371          TAD     (-4     /DO ONLY HALF OF THE DIRECTIONS
  627 00714  3246          DCA     LCNT
  628 00715  1372          TAD     (OTRX-1 /THE DIAGONAL ONES
  629 00716  3013          DCA     ITMP0
  630 00717  5200          JMP     LINE
  631              
  632              /SUBROUTINE TO BUILD AN MSW. CALL WITH ADDRESS OF THE 'TO SQUARE' IN LOCATION
  633              /'TOADR', AND THE LOCATION OF THE 'FROM SQUARE IN LOCATION "CNTR1". RETURN WITH THE
  634              /NEW MSW IN LOCATION 'GNMSW
  635 00720  0000  BLDMSW, 0000
  636 00721  7200          CLA
  637 00722  1107          TAD     TOADR
  638 00723  0167          AND     [0077   /STRIP THE 'TO SQUARE' ADDRESS DOWN INTO 6BIT
  639 00724  3047          DCA     GNMSW   /STORE IT TEMPORARILY
  640 00725  1064          TAD     CNTR1
  641 00726  0167          AND     [0077   /DO THE SAME FOR THE 'FROM SQUARE' ADDRESS
  642 00727  7106          RTL CLL         /BUT INSTEAD OF STORING IT,  ROTATE IT INTO BITS 0-5
  643 00730  7006          RTL
  644 00731  7006          RTL
  645 00732  1047          TAD     GNMSW   /NOW PACK THE 6BIT 'TO SQUARE' ADDRESS IN WITH IT
  646 00733  3047          DCA     GNMSW   /STORE AWAY THE NEW MSW
  647 00734  5720          JMP  I  BLDMSW  /RETURN
  648              
  649 00735  0000  PUSHIT, 0000            /PUSH ROUTINE
  650 00736  3542          DCA  I  PDLADR  /PUT NEW ITEM ON TOP
  651 00737  2142          ISZ     PDLADR  /PUSH
  652 00740  4767@         JMS     OFLOW   /TEST FOR LIST OVERLAP
  653 00741  5735          JMP  I  PUSHIT  /RETURN
  654              
  655 00742  0000  POPIT,  0000            /POP ROUTINE
  656 00743  7240          CLA CMA
  657 00744  1142          TAD     PDLADR  /MOVE LIST POINTER DOWN
  658 00745  7500          SMA             /MAKE SURE LIST DOESN'T GO WILD
  659 00746  7402          HLT             /IT DID! MANY EXTRA POPS
  660 00747  3142          DCA     PDLADR
  661 00750  1542          TAD  I  PDLADR  /GRAB THE TOP WORD
  662 00751  5742          JMP  I  POPIT   /RETURN WITH IT
  663              
  664 00752  0000  PUSH01, 0000



      / CHEKMO II                                                        Page 15


  665 00753  3541          DCA  I  PC01    /PUT NEW ITEM ON TOP
  666 00754  7040          CMA
  667 00755  1141          TAD     PC01
  668 00756  3141          DCA     PC01    /PUSH IT DOWN
  669 00757  4767@         JMS     OFLOW   /TEST FOR PDL OVERFLOW
  670 00760  5752          JMP  I  PUSH01  /RETURN
  671              
  672 00761  0000  POP01,  0000
  673 00762  2141          ISZ     PC01    /MOVE THE LIST POINTER DOWN
  674 00763  7610          SKP CLA
  675 00764  7402          HLT             /LOTS OF EXTRA POPS
  676 00765  1541          TAD  I  PC01    /GRAB THE WORD ON TOP
  677 00766  5761          JMP  I  POP01   /RETURN WITH IT
  678              
      00767  1746
      00770  1131
      00771  7774
      00772  1121
      00773  1400
      00774  0446
      00775  0512
      00776  7340
      00777  1410
  679              PAGE
  680              /ROUTINE TO GENERATE ALL MOVES OF A KING OR KNIGHT
  681              /CALLED WITH THE MOVE GENERATION LIST ADDRESS-1 IN AC
  682 01000  0000  SNGMV,  0000
  683 01001  3013          DCA     ITMP0   /STORE THE ADDRESS OF THE LIST
  684 01002  1164          TAD     [7770
  685 01003  3256          DCA     SCNT    /THERE ARE 8 DIRECTIONS
  686 01004  3050          DCA     GNMDW   /INITIALIZE THE MDW
  687 01005  1043          TAD     GN1
  688 01006  1413          TAD  I  ITMP0
  689 01007  4570          SNO             /OFF THE BOARD
  690 01010  5251          JMP     XXXO-1  /YES TRY ANOTHER DIRECTION
  691 01011  3045          DCA     GN3
  692 01012  1044          TAD     GN2
  693 01013  1413          TAD  I  ITMP0
  694 01014  4777@         JMS     XYZ
  695 01015  5252          JMP     XXXO
  696 01016  1464          TAD  I  CNTR1   /GET VALUE OF THE MOVING PIECE
  697 01017  4776@         JMS     CLRFIX
  698 01020  1375          TAD     (-KING
  699 01021  7640          SZA CLA         /IS IT A KING?
  700 01022  5237          JMP     SNGKNT  /NO: ITS A KNIGHT
  701 01023  1047          TAD     GNMSW   /YES
  702 01024  4774@         JMS     MMOVE   /MAKE THE KING MOVE
  703 01025  1107          TAD     TOADR
  704 01026  3020          DCA     TEMP    /TEST FOR AN ATTACK ON THE KINGS NEW SQUARE
  705 01027  7001          IAC             /AND RETURN AFTER THE FIRST ATTACK IS FOUND



      / CHEKMO II                                                        Page 16


  706 01030  4773@         JMS     CHKATK
  707 01031  4772@         JMS     UMOVE   /UNMAKE THE MOVE
  708 01032  1100          TAD     PCNT    /NOW WORRY ABOUT LEGAL OR ILLEGAL
  709 01033  7650          SNA CLA         /WAS THE KING IN CHECK?
  710 01034  5242          JMP     SNGLGL  /NO. MOVE IS LEGAL
  711 01035  2134          ISZ     KNGBLK  /YES. INC BLOCKED KING MOVE COUNTER
  712 01036  5252          JMP     XXXO    /GO TO THE ILLEGAL PLACE
  713 01037  1047  SNGKNT, TAD     GNMSW
  714 01040  4505          JMS  I  ZFNL    /DO FINAL CHECK
  715 01041  5252          JMP     XXXO    /KING IS ATTACKED: KNIGHT MOVE NO GOOD
  716 01042  1507  SNGLGL, TAD  I  TOADR   /GET VALUE OF THE 'TO' SQUARE
  717 01043  7640          SZA CLA         /IS THE MOVE A CAPTURE?
  718 01044  7330          CLA STL RAR     /YES: SET CAPTURE BIT
  719 01045  1050          TAD     GNMDW
  720 01046  3050          DCA     GNMDW   /STORE MDW AGAIN
  721 01047  4771@         JMS     GNSTR   /PUSH MOVE INTO LIST
  722 01050  7410          SKP
  723 01051  2013          ISZ     ITMP0   /FAILED ON FIRST LIST ELEMENT. PASS OVER SECOND
  724 01052  7200  XXXO,   CLA
  725 01053  2256          ISZ     SCNT    /TESTED ALL DIRECTIONS?
  726 01054  5204          JMP     SNGMV+4 /NO. TRY THE NEXT ONE
  727 01055  5600          JMP  I  SNGMV   /YES. RETURN
  728              
  729 01056  0000  SCNT,   0000            /DIRECTION COUNTER
  730              
  731              
  732 01057  7200  GPM,    CLA             /GENERATE THE MOVES OF A PAWN
  733 01060  3050          DCA     GNMDW
  734 01061  1044          TAD     GN2
  735 01062  3046          DCA     GN4
  736 01063  1043          TAD     GN1
  737 01064  4770@         JMS     PST
  738 01065  5277          JMP     GPM1    /MOVING 1 FORWARD BLOCKED: FORGET 2
  739 01066  1043          TAD     GN1     /MOVING 1 FORWARD IS NOT BLOCKED. NOW TEST FOR 2
  740 01067  1051          TAD     FSTRNK
  741 01070  7640          SZA CLA
  742 01071  5277          JMP     GPM1    /NOT THIS PAWNS FIRST MOVE. CAN'T MOVE 2
  743 01072  7332          CLA STL RTR
  744 01073  3050          DCA     GNMDW   /SETUP MDW TO INDICATE DOUBLE PAWN MOVE(TEMPORARY INDICATION)
  745 01074  1045          TAD     GN3
  746 01075  4770@         JMS     PST
  747 01076  7000          NOP             /MUST BE HERE CAUSE "PST" SUBROUTINE SOMETIMES RETURNS TO ADDRESS+2 OF THE CALLING JMS
  748 01077  7200  GPM1,   CLA             /NOW TEST CAPTURES
  749 01100  1043          TAD     GN1
  750 01101  1036          TAD     PONDIR
  751 01102  3045          DCA     GN3
  752 01103  7001          IAC
  753 01104  1044          TAD     GN2
  754 01105  3046          DCA     GN4
  755 01106  1046          TAD     GN4



      / CHEKMO II                                                        Page 17


  756 01107  0164          AND     [7770
  757 01110  7640          SZA CLA         /CAN IT CAPTURE TO THE HIGH SIDE?
  758 01111  5313          JMP     .+2     /NO. IT WAS ON THE EDGE OF THE HIGH SIDE
  759 01112  4767@         JMS     CAPTST
  760 01113  7240          CLA CMA
  761 01114  1044          TAD     GN2
  762 01115  7510          SPA             /CAN IT CAPTURE TO THE LOW SIDE?
  763 01116  5321          JMP     .+3     /NO. IT WAS ON THE LOW EDGE
  764 01117  3046          DCA     GN4
  765 01120  4767@         JMS     CAPTST
  766 01121  5766@         JMP     NXTSQR
  767              /FOLLOWING ARE THE MOVE GENERATION DIRECTION LISTS
  768 01122  0001  OTRX,   1               /BISHOP MOVE DIRECTION LIST
  769 01123  7777          -1
  770              
  771 01124  0001          1
  772 01125  0001          1
  773              
  774 01126  7777          -1
  775 01127  7777          -1
  776              
  777 01130  7777          -1
  778 01131  0001          1
  779              
  780 01132  0001  OTR,    1               /ROOK MOVE DIRECTION LIST
  781 01133  0000          0
  782              
  783 01134  0000          0
  784 01135  7777          -1
  785              
  786 01136  0000          0
  787 01137  0001          1
  788              
  789 01140  7777          -1
  790 01141  0000          0
  791              
  792 01142  0002  KNLST,  2               /KNIGHT MOVE DIRECTION LIST
  793 01143  7777          -1
  794              
  795 01144  0002          2
  796 01145  0001          1
  797              
  798 01146  0001          1
  799 01147  0002          2
  800              
  801 01150  7777          -1
  802 01151  0002          2
  803              
  804 01152  7776          -2
  805 01153  0001          1



      / CHEKMO II                                                        Page 18


  806              
  807 01154  7776          -2
  808 01155  7777          -1
  809              
  810 01156  7777          -1
  811 01157  7776          -2
  812              
  813 01160  0001          1
  814 01161  7776          -2
  815              
      01166  0446
      01167  1637
      01170  1655
      01171  0647
      01172  2500
      01173  2200
      01174  2466
      01175  7040
      01176  1410
      01177  0662
  816              PAGE
  817              /GENERATE KING MOVES
  818 01200  0000  GKM,    0000
  819                                      /FIRST TRY CASTLING
  820 01201  7201          IAC CLA         /SETUP MDW TO INDICATE CASTLING
  821 01202  3050          DCA     GNMDW
  822 01203  1036          TAD     PONDIR  /BUILD THE ADDRESS OF THE KINGS ORIGINAL SQUARE
  823 01204  0377          AND     (0070
  824 01205  1376          TAD     (BOARD+4/KING IS ON FILE E
  825 01206  3020          DCA     TEMP    /STORE THE ADDRESS OF THE KINGS ORIGINAL SQUARE
  826 01207  1420          TAD  I  TEMP    /GET THE VALUE OF THE PIECE ON IT
  827 01210  4775@         JMS     CLRFIX
  828 01211  1374          TAD     (-KING
  829 01212  7650          SNA CLA         /IS IT A KING?
  830 01213  5221          JMP     GKM2    /YES
  831 01214  1455          TAD  I  CPSW    /NO. MAKE 'CPSW' REFLECT THIS
  832 01215  0166          AND     [0007   /SAVE BITS 9-11 IN CASE HE IS CASTLED
  833 01216  1373          TAD     (3000   /SET THE "NO MORE CASTLING" BITS
  834 01217  3455          DCA  I  CPSW    /NO MORE CASTLING
  835 01220  5336          JMP     GKM1    /BUT NORMAL KING MOVES ARE OK. GENERATE THEM NOW
  836 01221  1020  GKM2,   TAD     TEMP    /CHANGE 'TEMP' TO EQUAL THE ADDRESS OF THE QUEENS ROOK
  837 01222  0164          AND     [7770   /BY CHANGING THE FILE TO A
  838 01223  3020          DCA     TEMP    /STORE ADDRESS OF QUEENS ROOK
  839 01224  1455          TAD  I  CPSW
  840 01225  7006          RTL             /MOVE 'QUEEN ROOK BIT' INTO AC0
  841 01226  7710          SPA CLA         /IF ITS SET THE QUEENS ROOK HAS MOVED
  842 01227  5275          JMP     CAKR    /QUEENS ROOK HAS MOVED ALLREADY: TRY KING SIDE CASTLING
  843 01230  1420          TAD  I  TEMP    /GET VALUE OF PIECE ON A1(A8)
  844 01231  4775@         JMS     CLRFIX
  845 01232  1372          TAD     (-ROOK



      / CHEKMO II                                                        Page 19


  846 01233  7650          SNA CLA         /IS IT A ROOK?
  847 01234  5241          JMP     .+5     /YES. CONTINUE
  848 01235  1371          TAD     (1000   /NO. 'QUEEN ROOK BIT' LIED
  849 01236  1455          TAD  I  CPSW    /CHANGE IT TO GIVE A TRUE INDICATION
  850 01237  3455          DCA  I  CPSW    /NO MARE CASTLING WITH THE QUEENS ROOK
  851 01240  5275          JMP     CAKR    /AND TRY KING-SIDE CASTLING
  852 01241  1770@         TAD     GNCHEK  /FIND OUT IF THE KING IS IN CHECK
  853 01242  7640          SZA CLA         /IS THE KING IN CHECK
  854 01243  5275          JMP     CAKR    /YES. GO SEE IF THE KINGS ROOK HAS MOVED
  855 01244  2020          ISZ     TEMP    /NO. INC 'TEMP' SO THAT IT EQUALS THE ADDRESS OF B1(B8)
  856 01245  1420          TAD  I  TEMP    /GET THE VALUE OF THE SQUARE
  857 01246  7640          SZA CLA         /IS IT EMPTY?
  858 01247  5275          JMP     CAKR    /NO. TRY KING-SIDE CASTLING
  859 01250  2020          ISZ     TEMP    /INC 'TEMP' SO THAT IT EQUALS THE ADDRESS OF C1(C8)
  860 01251  1420          TAD  I  TEMP    /GET THE VALUE OF THE SQUARE
  861 01252  7640          SZA CLA         /IS IT EMPTY?
  862 01253  5275          JMP     CAKR    /NO. TRY KING-SIDE CASTLING
  863 01254  4767@         JMS     CHKATK  /CHECK FOR AN ATTACK ON THAT SQUARE BY AN ENEMY PIECE
  864 01255  1100          TAD     PCNT    /GET # OF ATTACKS
  865 01256  7640          SZA CLA         /ANY?
  866 01257  5275          JMP     CAKR    /YES. Q-SIDE CASTLING ILLEGAL, TRY K-SIDE
  867 01260  2020          ISZ     TEMP    /INC 'TEMP' TO EQUAL ADDRESS OF D1(D8)
  868 01261  1420          TAD  I  TEMP    /GET THE SQUARES VALUE
  869 01262  7640          SZA CLA         /IS IT OCCUPIED?
  870 01263  5275          JMP     CAKR    /YES. TRY K-SIDE CASTLING INSTEAD
  871 01264  4767@         JMS     CHKATK  /CHECK FOR ATTACKS ON SQUARE D1(D8)
  872 01265  1100          TAD     PCNT    /GET # OF ATTACKS
  873 01266  7640          SZA CLA         /ARE THERE ANY?
  874 01267  5275          JMP     CAKR    /YES. TRY K-SIDE CASTLING
  875 01270  1036          TAD     PONDIR  /NO. QUEEN SIDE CASTLING IS LEGAL!!
  876 01271  0366          AND     (7070   /BUILD AN MSW FOR QUEEN SIDE CASTLING
  877 01272  1365          TAD     (0402
  878 01273  3047          DCA     GNMSW   /STORE THE NEW MSW
  879 01274  4764@         JMS     GNSTR   /PUSH THE MOVE ONTO PDL2
  880 01275  7200  CAKR,   CLA
  881 01276  1455          TAD  I  CPSW    /TRY TO GENERATE A KING SIDE CASTLING MOVE
  882 01277  7004          RAL             /MOVE 'KING ROOK BIT' OF THE PSW INTO AC0
  883 01300  7710          SPA CLA         /IS IT SET?
  884 01301  5336          JMP     GKM1    /YES. KINGS ROOK HAS ALLREADY MOVED
  885 01302  1020          TAD     TEMP    /NO. BUILD ADDRESS OF THE KINGS ROOK
  886 01303  0164          AND     [7770
  887 01304  1166          TAD     [0007
  888 01305  3020          DCA     TEMP
  889 01306  1420          TAD  I  TEMP    /GET THE VALUE OF THE PIECE ON H1(H8)
  890 01307  4775@         JMS     CLRFIX
  891 01310  1372          TAD     (-ROOK
  892 01311  7650          SNA CLA         /IS IT A ROOK?
  893 01312  5317          JMP     .+5     /YES CONTINUE
  894 01313  7332          CLA STL RTR     /NO. 'KING ROOK BIT' LIED: FIX IT
  895 01314  1455          TAD  I  CPSW



      / CHEKMO II                                                        Page 20


  896 01315  3455          DCA  I  CPSW
  897 01316  5336          JMP     GKM1    /GO TRY PROPER STYLE KING MOVES
  898 01317  1770@         TAD     GNCHEK  /TEST FOR KING IN CHECK
  899 01320  7640          SZA CLA         /IS THEKING IN CHECK?
  900 01321  5336          JMP     GKM1    /YES. GO TRY REGULAR STYLE KING MOVES
  901 01322  1020          TAD     TEMP    /NO. CONTINUE TRYING FOR KING SIDE CASTLING
  902 01323  1363          TAD     (-2
  903 01324  3020          DCA     TEMP    /SET 'TEMP' = THE ADDRESS OF SQUARE E1(E8)
  904 01325  4342          JMS     CAKR1   /TEST TO SEE IF THE SQUARE IS OCUPIED OR ATTACKED
  905 01326  2020          ISZ     TEMP    /NO. INC 'TEMP' TO EQUAL THE ADDRESS OF F1(F8)
  906 01327  4342          JMS     CAKR1   /TEST THE SQUARE FOR OCCUPATION OR ATTACKS
  907 01330  1036          TAD     PONDIR  /NO. BUILD AN MSW CAUSE KING SIDE CASTLING IS LEGAL!!
  908 01331  0366          AND     (7070
  909 01332  1362          TAD     (0406
  910 01333  3047          DCA     GNMSW
  911 01334  2050          ISZ     GNMDW   /INC MDW SO THAT IT INDICATES KING SIDE CASTLING
  912 01335  4764@         JMS     GNSTR   /STORE THE MOVE IN PDL2
  913 01336  7200  GKM1,   CLA
  914 01337  1361          TAD     (OTRX-1 /NOW GENERATE 'NORMAL' KING MOVES
  915 01340  4771@         JMS     SNGMV
  916 01341  5600          JMP  I  GKM     /RETURN
  917              
  918 01342  0000  CAKR1, 0000
  919 01343  1420          TAD  I  TEMP    /GET THE VALUE OF THE SQUARE
  920 01344  7640          SZA CLA         /IS THERE A PIECE ON IT?
  921 01345  5336          JMP     GKM1    /YES. MOVE ON TO NORMAL KING MOVES
  922 01346  4767@         JMS     CHKATK  /NO. TEST FOR ATTACKS ON THAT SQUARE BY ENEMY PIECES
  923 01347  1100          TAD     PCNT    /GET # OF ATTACKS
  924 01350  7640          SZA CLA         /ANY?
  925 01351  5336          JMP     GKM1    /YES.
  926 01352  5742          JMP  I  CAKR1   /RETURN
  927              
  928 01353  7200  GNM,    CLA             /GENERATE KNIGHT MOVES
  929 01354  1360          TAD     (KNLST-1/GET ADDRESS OF THE KNIGHT MOVE GENERATION LIST
  930 01355  4771@         JMS     SNGMV
  931 01356  5757@         JMP     NXTSQR
      01357  0446
      01360  1141
      01361  1121
      01362  0406
      01363  7776
      01364  0647
      01365  0402
      01366  7070
      01367  2200
      01370  0513
      01371  1000
      01372  7540
      01373  3000
      01374  7040



      / CHEKMO II                                                        Page 21


      01375  1410
      01376  7504
      01377  0070
  932              PAGE
  933              /SUBROUTINE TO BUILD A 'TO SQUARE' ADDRESS
  934              /RETURN WITH ADDRESS IN LOC 'TOADR'
  935 01400  0000  BLDTO,  0000
  936 01401  1045          TAD     GN3     /GET RANK # AND ROTATE IT
  937 01402  7106          RTL CLL         /INTO ITS PROPER PLACE(BITS 6-8)
  938 01403  7004          RAL
  939 01404  1046          TAD     GN4     /ADD IN THE FILE #
  940 01405  1163          TAD     [BOARD  /ADD IN BOARD ADDRESS CONSTANT
  941 01406  3107          DCA     TOADR   /STORE THE ADDRESS
  942 01407  5600          JMP  I  BLDTO   /RETURN
  943              
  944              
  945              /SUBROUTINE TO FIX THE COLOR PROBLEM, AND ALLOW ANY SUBROUTINE
  946              /TO WORK WITH BLACK PIECES AS WELL AS WHITE PIECES
  947 01410  0000  CLRFIX, 0000
  948 01411  7402  COLR,   HLT             /=NOP FOR WHITE, =CIA FOR BLACK
  949 01412  5610          JMP  I  CLRFIX  /RETURN
  950              /SUBROUTINE TO GENERATE 'EN PASSANT' PAWN CAPTURES
  951              /IF PAWNS MYSTERYOUSLY CHANGE COLOR, THIS ROUTINE IS THE LIKLEY SUSPECT
  952 01413  0000  GNEP,   0000
  953 01414  7240          CMA CLA         /-1 TO THE AC
  954 01415  3137          DCA     CTNEED  /ALWAYS TEST FOR KING IN CHECK
  955 01416  1071          TAD     LSTMV   /GET SOME INFORMATION ON THE LAST MOVE MADE
  956 01417  0377          AND     (0770   /ISOLATE THE 'DOUBLE PAWN MOVE' INFO
  957 01420  7450          SNA             /WAS THE LAST MOVE MADE A DOUBLE PAWN MOVE?
  958 01421  5613          JMP  I  GNEP    /NO. 'EN PASSANT' CAPTURES ARE NOT POSIBLE. RETURN
  959 01422  7112          RTR CLL         /YES. ROTATE THE INFO(6BIT 'TO ADDRESS') INTO BITS 6-11
  960 01423  7010          RAR
  961 01424  1163          TAD     [BOARD  /ADD IN BOARD ADDRESS CONSTANT
  962 01425  3064          DCA     CNTR1   /STORE THE ADDRESS OF THE CAPTURED PAWN
  963 01426  1064          TAD     CNTR1
  964 01427  3314          DCA     GNEPTM  /STORE THE ADDRESS OF THE CAPTURED PAWN
  965 01430  3714          DCA  I  GNEPTM  /TAKE THE PAWN OFF THE BOARD NOW FOR CONVIENIENCE
  966 01431  1064          TAD     CNTR1   /BUILD A 'TO RANK' THEN A 'TO ADDRESS'
  967 01432  7112          RTR CLL         /FIRST ROTATE THE OLD 'TO RANK' INTO BITS 9-11
  968 01433  7010          RAR
  969 01434  0166          AND     [0007
  970 01435  1036          TAD     PONDIR  /NEW 'TO RANK' IS 1 MOVE GREATER THAN THE OLD ONE
  971 01436  7106          RTL CLL         /ROTATE THE 'TO RANK' BACK INTO PLACE AGAIN
  972 01437  7004          RAL
  973 01440  3050          DCA     GNMDW   /STORE IT TEMPORARILY
  974 01441  1064          TAD     CNTR1   /GET THE ADDRESS OF THE PAWN BEING CAPTURED
  975 01442  0376          AND     (7707   /CLEAR OUT ROOM FOR THE NEW 'TO RANK'
  976 01443  1050          TAD     GNMDW   /ADD THE NEW 'TO RANK' IN
  977 01444  3107          DCA     TOADR   /STORE THE 'TO SQUARE' ADDRESS
  978 01445  1375          TAD     (4003   /4003 IS THE MDW REPRESENTING AN 'EN PASSANT' CAPTURE



      / CHEKMO II                                                        Page 22


  979 01446  3050          DCA     GNMDW   /STORE THE NEW MDW
  980 01447  2064          ISZ     CNTR1   /TRY THE ADDJACENT FILE ON THE HIGH SIDE FIRST
  981 01450  1064          TAD     CNTR1
  982 01451  0166          AND     [0007
  983 01452  7650          SNA CLA         /IS THERE REALY A FILE ON THAT SIDE?
  984 01453  5266          JMP     GNOTF   /NO. TRY THE OTHER SIDE
  985 01454  1464          TAD  I  CNTR1   /GET THE VALUE OF THE PIECE ON THE SQUARE
  986 01455  4210          JMS     CLRFIX
  987 01456  1165          TAD     [-PAWN
  988 01457  7640          SZA CLA         /IS IT A PAWN?
  989 01460  5266          JMP     GNOTF   /NO. TRY THE OTHER ADDJACENT FILE
  990 01461  4774@         JMS     BLDMSW  /YES. MOVE SEEMS OK. BUILD AN MSW FOR IT
  991 01462  1047          TAD     GNMSW   /LOAD THE MSW INTO THE AC
  992 01463  4504          JMS  I  ZTSTCH  /TEST IF THE MOVE IS ILLEGAL BY VIRTUE OF KING IN CHECK
  993 01464  7410          SKP             /IT IS ILLEGAL DONT STORE IT IN THE PUSH DOWN LIST
  994 01465  4773@         JMS     GNSTR   /MOVE IS LEGAL STORE IT IN PDL2
  995 01466  7200  GNOTF,  CLA
  996 01467  1064          TAD     CNTR1   /GET THE 'FROM SQUARE ADDRESS'
  997 01470  1372          TAD     (-2     /CHANGE IT TO POINT TO THE  ADDJACENT FILE ON THE OTHER SIDE
  998 01471  3064          DCA     CNTR1
  999 01472  1314          TAD     GNEPTM  /NOW TEST IF THAT FILE REALY EXISTS
 1000 01473  0166          AND     [0007   /IF THE FILE IS 0 WE'RE ON THE EDGE
 1001 01474  7650          SNA CLA         /DOES THE FILE REALY EXIST, OR IS THE PAWN ON THE EDGE OF THE BOARD
 1002 01475  5310          JMP     GNEPDN  /DOES NOT EXIST!
 1003 01476  1464          TAD  I  CNTR1   /GET THE VALUE OF THE PIECE ON THAT SQUARE
 1004 01477  4210          JMS     CLRFIX
 1005 01500  1165          TAD     [-PAWN
 1006 01501  7640          SZA CLA         /IS IT A PAWN?
 1007 01502  5310          JMP     GNEPDN  /NO
 1008 01503  4774@         JMS     BLDMSW  /YES. BUILD AN MSW
 1009 01504  1047          TAD     GNMSW
 1010 01505  4504          JMS I   ZTSTCH  /IS THE KING IN CHECK IF THAT MOVE IS MADE
 1011 01506  7410          SKP             /YES. DONT STORE THE MOVE IN THE PDL
 1012 01507  4773@         JMS     GNSTR   /NO. STORE THE MOVE IN PDL2
 1013 01510  1165  GNEPDN, TAD     [-PAWN
 1014 01511  4210          JMS     CLRFIX
 1015 01512  3714          DCA  I  GNEPTM  /REPLACE THE PAWN THAT WAS REMOVED EARLIER
 1016 01513  5613          JMP  I  GNEP    /RETURN
 1017 01514  0000  GNEPTM, 0000            /LOCATION FOR STORAGE OF THE CAPTURED PAWNS ADDRESS
 1018              
 1019              /SUBROUTINE TO MAP THE PIECES IF NECCESARY(IF DOMAP=-1).
 1020              /MAP IS IN TWO PARTS, 1 FOR EACH COLOR
 1021              /WHITE MAP STARTS AT LOC 7400. BLACK MAP STARTS AT LOC 7424.
 1022              /MAP FORMAT-- 1 WORD PER PIECE, REPRESENTING THE ADDRESS OF THAT PIECE
 1023 01515  0000  MAPEC,  0000
 1024 01516  7240          CLA CMA
 1025 01517  1163          TAD     [BOARD  /SETUP BOARD ADDRESS
 1026 01520  3015          DCA     ITMP2
 1027 01521  1151          TAD     DOMAP
 1028 01522  7650          SNA CLA         /IS A MAP REALY NECCESARY?



      / CHEKMO II                                                        Page 23


 1029 01523  5715          JMP  I  MAPEC   /NO. RETURN
 1030 01524  3151          DCA     DOMAP
 1031 01525  1371          TAD     (MAP-1  /YES. SETUP MAP OF WHITES PIECE ADDRESSES
 1032 01526  3013          DCA     ITMP0
 1033 01527  1370          TAD     (MAP+23 /SETUP MAP OF BLACK PIECE ADDRESSES
 1034 01530  3014          DCA     ITMP1
 1035 01531  1367          TAD     (-100   /SETUP COUNT FOR 100(OCTAL) SQUARES ON THE BOARD
 1036 01532  3024          DCA     TEMP4
 1037 01533  1415          TAD  I  ITMP2   /GET VALUE OF THE PIECE ON THE SQUARE
 1038 01534  7440          SZA             /IS SQUARE OCCUPIED?
 1039 01535  5343          JMP     MAPOC   /YES
 1040 01536  2024  MAPGO,  ISZ     TEMP4   /FINISHED BOARD YET?
 1041 01537  5333          JMP     .-4     /NO. DO MORE SQUARES
 1042 01540  3413          DCA  I  ITMP0   /YES. PUT A 0000 AT THE END OF THE WHITE MAP
 1043 01541  3414          DCA  I  ITMP1   /ALSO AT THE END OF THE BLACK MAP
 1044 01542  5715          JMP  I  MAPEC   /RETURN
 1045 01543  7510  MAPOC,  SPA             /IS IT WHITE OR BLACK?
 1046 01544  5355          JMP     MAPOCB  /ITS BLACK
 1047 01545  1366          TAD     (-KING  /ITS WHITE. IS IT A KING?
 1048 01546  7640          SZA CLA
 1049 01547  5352          JMP     .+3     /NO
 1050 01550  1015          TAD     ITMP2   /YES
 1051 01551  3065          DCA     WKING   /STORE ADDRESS OF THE WHITE KING
 1052 01552  1015          TAD     ITMP2
 1053 01553  3413          DCA  I  ITMP0   /PUT IT IN THE WHITE MAP WHATEVER IT IS
 1054 01554  5336          JMP     MAPGO
 1055 01555  1365  MAPOCB, TAD     (KING   /IS IT THE BLACK KING?
 1056 01556  7640          SZA CLA
 1057 01557  5362          JMP     .+3     /NO. PROCEDE NORMALY
 1058 01560  1015          TAD     ITMP2   /YES, GET ITS ADDRESS
 1059 01561  3066          DCA     BKING   /STORE IT
 1060 01562  1015          TAD     ITMP2   /GET THE ADDRESS
 1061 01563  3414          DCA  I  ITMP1   /EITHER WAY, PUT IT IN THE BLACK MAP
 1062 01564  5336         JMP     MAPGO
      01565  0740
      01566  7040
      01567  7700
      01570  7423
      01571  7377
      01572  7776
      01573  0647
      01574  0720
      01575  4003
      01576  7707
      01577  0770
 1063              PAGE
 1064              /SUBROUTINE TO CHECK FOR A 'DOUBLE PAWN MOVE', AND MODIFY THE
 1065              /MDW IF IT IS. ALSO TEST IF A LEGAL PAWN MOVE IS ALSO A PROMOTING MOVE
 1066              /APPROPRIATE ACTION IS TAKEN IF IT IS. IN ANY CASE THIS ROUTINE CALLS
 1067              /'GNSTR' TO STORE MSW & MDW IN PDL2



      / CHEKMO II                                                        Page 24


 1068 01600  0000  PROMCK, 0000
 1069 01601  7200          CLA
 1070 01602  1050          TAD     GNMDW   /GET THE MOVE DATA WORD
 1071 01603  7006          RTL             /ROTATE AC BIT 1 INTO THE LINK
 1072 01604  7630          SZL CLA         /DOES IT SAY 'DOUBLE PAWN MOVE'?
 1073 01605  5226          JMP     PROM1   /YES. SET THE MDW TO SHOW IT
 1074 01606  1045          TAD     GN3     /BUILD THE RANK OF THE PAWN, IF IT WERE TO BE
 1075 01607  1036          TAD     PONDIR  /MOVED ONE MORE TIME
 1076 01610  4570          SNO             /IS IT STILL ON THE BOARD?
 1077 01611  7610          SKP CLA         /NO: IT'S A PROMOTIMG MOVE
 1078 01612  5224          JMP     PPLSTR  /YES: IT'S NOT A PROMOTING MOVE
 1079 01613  1050          TAD     GNMDW
 1080 01614  1162          TAD     [0004   /SET 'PAWN PROMOTION BIT' (BIT 9) OF THE MDW
 1081 01615  3050          DCA     GNMDW
 1082 01616  4777@         JMS     GNSTR   /STORE PROMOTION TO KNIGHT MOVE IN PDL2
 1083 01617  2050          ISZ     GNMDW   /CHANGE MDW TO INDICATE PROMOTION TO A BISHOP
 1084 01620  4777@         JMS     GNSTR   /STORE MOVE IN PDL2
 1085 01621  2050          ISZ     GNMDW   /CHANGE MDW TO INDICATE PROMOTION TO A ROOK
 1086 01622  4777@         JMS     GNSTR   /STORE MOVE IN PDL2
 1087 01623  2050          ISZ     GNMDW   /CHANGE THE MDW TO INDICATE PROMOTION TO A QUEEN
 1088 01624  4777@ PPLSTR, JMS     GNSTR   /STORE MOVE IN PDL2
 1089 01625  5600          JMP  I  PROMCK  /RETURN
 1090 01626  7112  PROM1,  CLL RTR         /CLEAR LINK(BIT 1)AND REROTATE THE MDW BACK INTO POSITION
 1091 01627  3050          DCA     GNMDW   /RESTORE THE MDW
 1092 01630  1047          TAD     GNMSW   /NOW GET THE MSW
 1093 01631  0167          AND     [0077   /EXTRACT 'TO SQUARE' INFO
 1094 01632  7106          RTL CLL         /ROTATE THE INFO SO THAT IT FITS IN MDW BITS 3-8
 1095 01633  7004          RAL
 1096 01634  1050          TAD     GNMDW   /ADD IT TO THE MDW
 1097 01635  3050          DCA     GNMDW   /THERES THE NEW MDW!!!
 1098 01636  5224          JMP     PPLSTR  /IF THE PAWN MOVE A DOUBLE MOVE, IT WASN'T QUEENING
 1099              
 1100              /SUBROUTINE TO CHECK FOR LEGAL PAWN CAPTURES
 1101 01637  0000  CAPTST, 0000
 1102 01640  4776@         JMS     BLDTO   /BUILD THE ADDRESS OF THE 'TO' SQUARE
 1103 01641  1507          TAD  I  TOADR   /GET THE VALUE OF THE SQUARE
 1104 01642  4775@         JMS     CLRFIX
 1105 01643  7700          SMA CLA         /IS IT AN ENEMY PIECE?
 1106 01644  5637          JMP  I  CAPTST  /YES. CAN ONLY CAPTURE OPPOSING PIECES
 1107 01645  4774@         JMS     BLDMSW  /NO. CAPTURE SEEMS LEGAL. BUILD AN MSW
 1108 01646  7330          CLA STL RAR     /BUILD AN MDW WHICH INDICATES CASTLING
 1109 01647  3050          DCA     GNMDW
 1110 01650  1047          TAD     GNMSW   /FINAL TEST FOR MOVE LEGALITY COMING UP
 1111 01651  4505          JMS  I  ZFNL    /IS KING IN CHECK?
 1112 01652  5637          JMP  I  CAPTST  /YES: MOVE ILLEGAL
 1113 01653  4200          JMS     PROMCK  /NO: CHECK FOR PROMOTION
 1114 01654  5637          JMP  I  CAPTST  /RETURN
 1115              
 1116 01655  0000  PST,   0000
 1117 01656  1036          TAD     PONDIR



      / CHEKMO II                                                        Page 25


 1118 01657  3045          DCA     GN3
 1119 01660  4776@         JMS     BLDTO   /BUILD THE 'TO' ADDR
 1120 01661  1507          TAD  I  TOADR   /GET VALUE OF 'TO' SQUARE
 1121 01662  7640          SZA CLA         /IS THE SQUARE OCCUPIED?
 1122 01663  5655          JMP  I  PST     /YES, MOVE NO GOOD
 1123 01664  4774@         JMS     BLDMSW  /NO. PACK IT INTO 12 BITS.
 1124 01665  1047          TAD     GNMSW
 1125 01666  4505          JMS  I  ZFNL    /IS KING IN CHECK?
 1126 01667  7410          SKP             /YES: MOVE NO GOOD
 1127 01670  4200          JMS     PROMCK  /MOVE IS LEGAL. CHECK FOR PAWN PROMOTION
 1128 01671  2255          ISZ     PST     /INC RETURN ADDRESS IF "TO" SQUARE WAS NOT OCCUPIED
 1129 01672  5655          JMP  I  PST
 1130              
 1131              /TEST FOR LEGAL KNIGHT CAPTURE: 
 1132 01673  7340  ISLNM,  CLA CLL CMA
 1133 01674  7004          RAL             /AC WILL=-2
 1134 01675  3333          DCA     TOOS
 1135 01676  1037          TAD     M1      /COMPARE RANKS
 1136 01677  7041          CIA
 1137 01700  1041          TAD     M3
 1138 01701  7500          SMA
 1139 01702  7041          CIA
 1140 01703  7001          IAC
 1141 01704  7450          SNA
 1142 01705  5312          JMP     .+5
 1143 01706  7001          IAC
 1144 01707  7640          SZA CLA
 1145 01710  5773@         JMP     BATAK
 1146 01711  2333          ISZ     TOOS
 1147 01712  1040          TAD     M2
 1148 01713  7041          CIA
 1149 01714  1042          TAD     M4
 1150 01715  7500          SMA
 1151 01716  7041          CIA
 1152 01717  7001          IAC
 1153 01720  7450          SNA
 1154 01721  5326          JMP     .+5
 1155 01722  7001          IAC
 1156 01723  7640          SZA CLA
 1157 01724  5773@         JMP     BATAK
 1158 01725  2333          ISZ     TOOS
 1159 01726  7410          SKP
 1160 01727  5773@         JMP     BATAK
 1161 01730  2333          ISZ     TOOS
 1162 01731  5773@         JMP     BATAK
 1163 01732  5772@         JMP     GATAK
 1164 01733  0000  TOOS,   0000
 1165                      
 1166 01734  0000  PDLIN,  0000            /INITIALIZE THE LIST
 1167 01735  7200          CLA



      / CHEKMO II                                                        Page 26


 1168 01736  1371          TAD     (PDLS
 1169 01737  3142          DCA     PDLADR  /INITIALIZE LIST ADDRESS
 1170 01740  5734          JMP  I  PDLIN   /RETURN
 1171              
 1172 01741  0000  IPDL01,        0000            /INITIALIZE PUSH DOWN LIST #1
 1173 01742  7200          CLA
 1174 01743  1370          TAD     (PDLS+777
 1175 01744  3141          DCA     PC01
 1176 01745  5741          JMP  I  IPDL01  /RETURN
 1177              
 1178              /SUBROUTINE TO TEST FOR PUSH DOWN LIST OVERFLOW
 1179 01746  0000  OFLOW,  0000
 1180 01747  1141          TAD     PC01    /GET ADDR OF BOTTOM PDL#1
 1181 01750  7041          CIA             /COMPARE IT WITH
 1182 01751  1142          TAD     PDLADR  /THE ADDR OF BOTTOM PDL#2
 1183 01752  7640          SZA CLA         /ARE THEY THE SAME?
 1184 01753  5746          JMP  I  OFLOW   /NO. RETURN.
 1185              /PUSH DOWN LIST HAS OVERFLOWED!!!!!
 1186                      IFNZRO  LPTREE<
 1187 01754  1367          TAD     (OUT
 1188 01755  3026          DCA     ZOUT    /MAKE SURE OUTPUT GOES TO THE TTY
 1189              >
 1190 01756  4575          PRINTO; MESG26  /PRINT "I RESIGN"
      01757  1762
 1191 01760  4430          JMS  I  ZCRLF
 1192 01761  7402          HLT
 1193 01762  1140  MESG26, TEXT \I RESIGN\
      01763  2205
      01764  2311
      01765  0716
      01766  0000
 1194              
      01767  5231
      01770  7377
      01771  6400
      01772  2337
      01773  2266
      01774  0720
      01775  1410
      01776  1400
      01777  0647
 1195              PAGE
 1196              
 1197              /CHECK FOR LEGAL KING MOVE
 1198 02000  7200  ISLKM,  CLA
 1199 02001  1037          TAD     M1
 1200 02002  7041          CIA
 1201 02003  1041          TAD     M3
 1202 02004  7500          SMA
 1203 02005  7041          CIA



      / CHEKMO II                                                        Page 27


 1204 02006  7440          SZA
 1205 02007  7001          IAC
 1206 02010  7640          SZA CLA
 1207 02011  5777@         JMP     BATAK
 1208 02012  1040          TAD     M2
 1209 02013  7041          CIA
 1210 02014  1042          TAD     M4
 1211 02015  7500          SMA
 1212 02016  7041          CIA
 1213 02017  7440          SZA
 1214 02020  7001          IAC
 1215 02021  7650          SNA CLA
 1216 02022  5776@         JMP     GATAK
 1217 02023  5777@         JMP     BATAK
 1218              
 1219              /ROUTINE TO CHECK FOR PIECES IN THE MOVE ROW
 1220 02024  0000  ROW,    0000
 1221 02025  7200          CLA
 1222 02026  1037          TAD     M1
 1223 02027  7041          CIA
 1224 02030  1041          TAD     M3
 1225 02031  7104          RAL CLL         /GET THE SIGN
 1226 02032  7640          SZA CLA
 1227 02033  1375          TAD     (10
 1228 02034  7430          SZL
 1229 02035  7041          CIA
 1230 02036  3023          DCA     TEMP3
 1231 02037  1042          TAD     M4
 1232 02040  7041          CIA
 1233 02041  1040          TAD     M2
 1234 02042  7104          RAL CLL         /GET THE SIGN
 1235 02043  7640          SZA CLA
 1236 02044  7001          IAC
 1237 02045  7420          SNL
 1238 02046  7041          CIA
 1239 02047  1023          TAD     TEMP3
 1240 02050  3025          DCA     TMP
 1241 02051  1774@         TAD     TMATK   /GET THE SQUARE OF THE ATTACKER
 1242 02052  3023          DCA     TEMP3   /COPY IT SO WE DONT HAVE TO DESTROY THE ORIGINAL
 1243 02053  1023  MIDLIN, TAD     TEMP3   /SET TO NEXT SQUARE
 1244 02054  1025          TAD     TMP
 1245 02055  3023          DCA     TEMP3
 1246 02056  1023          TAD     TEMP3   /COMPARE IT WITH THE ATTACKED SQUARE
 1247 02057  7041          CIA
 1248 02060  1020          TAD     TEMP
 1249 02061  7650          SNA CLA         /ARE THEY THE SAME?
 1250 02062  5624          JMP  I  ROW     /YES RETURN
 1251 02063  1423          TAD  I  TEMP3   /NO. GET THE VALUE OF THE PIECE ON THE SQUARE
 1252 02064  7650          SNA CLA         /IS THE SQUARE EMPTY?
 1253 02065  5253          JMP     MIDLIN  /YES- KEEP GOING UNTIL WE FIND ONE THAT ISN'T



      / CHEKMO II                                                        Page 28


 1254 02066  2224          ISZ     ROW     /NO. ITS NOT A LEGAL ATTACK--INC RETURN ADDRESS
 1255 02067  5624          JMP  I  ROW     /RETURN
 1256              
 1257              /CHECK FOR LEGAL BISHOP MOVE
 1258 02070  0000  SUBR1,  0000
 1259 02071  7200          CLA
 1260 02072  1037          TAD     M1
 1261 02073  7041          CIA
 1262 02074  1041          TAD     M3
 1263 02075  7500          SMA
 1264 02076  7041          CIA
 1265 02077  3023          DCA     TEMP3
 1266 02100  1040          TAD     M2
 1267 02101  7041          CIA
 1268 02102  1042          TAD     M4
 1269 02103  7510          SPA
 1270 02104  7041          CIA
 1271 02105  1023          TAD     TEMP3
 1272 02106  7640          SZA CLA         /ARE BOTH SQUARES ON THE SAME DIAGONAL?
 1273 02107  5670          JMP  I  SUBR1   /NO
 1274 02110  4224          JMS     ROW     /YES. FIND OUT IF ANY PIECES ARE BLOCKING THAT DIAGONAL
 1275 02111  2270          ISZ     SUBR1   /NONE FOUND -- INC RETURN ADDRESS
 1276 02112  5670          JMP  I  SUBR1   /RETURN
 1277              
 1278              /CHECK FOR LEGAL ROOK MOVE
 1279 02113  0000  SUBR2,  0000
 1280 02114  7200          CLA
 1281 02115  1037          TAD     M1
 1282 02116  7041          CIA
 1283 02117  1041          TAD     M3
 1284 02120  7650          SNA CLA
 1285 02121  5327          JMP     .+6     /SAME RANK. FORGET FILE
 1286 02122  1040          TAD     M2
 1287 02123  7041          CIA
 1288 02124  1042          TAD     M4
 1289 02125  7640          SZA CLA
 1290 02126  5713          JMP  I  SUBR2   /BOTH RANK AND FILE CHANGED?!
 1291 02127  4224          JMS     ROW
 1292 02130  2313          ISZ     SUBR2   /NO PIECES IN THE WAY-- INC RETURN ADDRESS
 1293 02131  5713          JMP  I  SUBR2
 1294              
 1295              /CHECK FOR LEGAL QUEEN MOVE
 1296              /GO TO 'GATAK' IF IT IS
 1297 02132  4313  ISLQM,  JMS     SUBR2   /CHECK FOR A QUEEN MOVE 'ROOK STYLE'
 1298 02133  7410          SKP             /NOT FOUND
 1299 02134  5776@         JMP     GATAK   /FOUND
 1300 02135  4270          JMS     SUBR1   /IF NOT CHECK FOR BISHOP STYLE QUEEN MOVE
 1301 02136  5777@         JMP     BATAK   /NIETHER ONE
 1302 02137  5776@         JMP     GATAK   /FOUND BISHOP STYLE QUEEN MOVE
 1303              



      / CHEKMO II                                                        Page 29


 1304 02140  7200  ISLBM,  CLA
 1305 02141  4270          JMS     SUBR1
 1306 02142  5777@         JMP     BATAK
 1307 02143  5776@         JMP     GATAK
 1308              
 1309 02144  7200  ISLRM,  CLA
 1310 02145  4313          JMS     SUBR2
 1311 02146  5777@         JMP     BATAK
 1312 02147  5776@         JMP     GATAK
 1313              
      02174  2260
      02175  0010
      02176  2337
      02177  2266
 1314              PAGE
 1315              
 1316              
 1317              /SUBROUTINE TO TEST IF A SQUARE IS ATTACKED BY A PIECE.
 1318              /ALSO FINDS OUT HOW MANY ATTACKERS, AND THE VALUE OF THE LEAST VALUABLE ATTACKER
 1319              /CALL WITH ADDRESS OF SQUARE TO BE TESTED IN LOCATION 'TEMP'
 1320              /ALSO PONDIR AND COLR SET IN REVERSE OF THE ATTACKERS
 1321              /AND THE ATTACKERS PIECE LIST ADDRESS-1 IN LOC 'OMAP'
 1322              /RETURNS WITH NUMBER OF ATTACKERS IN LOC. 'PCNT', THE ADDRESS
 1323              /OF THE LEATST VALUABLE ATTACKER IN LOC "PSQR" AND VALUE OF THE LEAST
 1324              /VALUABLE ATTACKER IN LOC. 'PVAL'
 1325              /IF THE VALUE OF THE LEAST VALUABLE ATTACKER, AND THE # OF ATTACKERS
 1326              /IS NOT IMPORTANT, CALL WITH AC NOT =0
 1327              /RETURN IN THIS CASE IS DIRECTLY AFTER THE FIRST ATTACK IS FOUND
 1328 02200  0000  CHKATK, 0000
 1329 02201  3261          DCA     CKMODE  /SET RETURN MODE SWITCH
 1330 02202  7240          CLA CMA
 1331 02203  3260          DCA     TMATK   /INITIALIZE SWITCH ENABLING 1 LOOPBACK IN THE PAWN SECTION
 1332 02204  3100          DCA     PCNT    /INITIALIZE PIECE COUNT
 1333 02205  3101          DCA     PVAL    /INITIALIZE PIECE VALUE TO 0
 1334 02206  3102          DCA     PSQR    /INIT PIECE ADDRESS
 1335 02207  1020          TAD     TEMP    /GET SQUARE TO BE CHECKED
 1336 02210  0166          AND     [0007   /EXTRACT THE FILE #
 1337 02211  3042          DCA     M4      /RECORD IT
 1338 02212  1020          TAD     TEMP    /GET SQUARE ADDR AGAIN
 1339 02213  7112          RTR CLL         /ROTATE RIGHT 3 BITS SO THAT THE RANK CAN
 1340 02214  7010          RAR             /BE EXTRACTED IN A SIMILAR MANNER
 1341 02215  0166          AND     [0007
 1342 02216  3041          DCA     M3      /STORE RANK #
 1343 02217  1036          TAD     PONDIR  /CHECK FOR AN ATTACK BY A PAWN
 1344 02220  1041          TAD     M3
 1345 02221  4570          SNO             /IMPOSIBLE RANK?
 1346 02222  5263          JMP     TAG1    /YES. FORGET PAWN ATTACKS
 1347 02223  3037          DCA     M1      /NO. SAVE THE RANK
 1348 02224  7201          IAC CLA         /NOW BUILD A FILE
 1349 02225  1042  TAG0,   TAD     M4



      / CHEKMO II                                                        Page 30


 1350 02226  4570          SNO             /IS THAT FILE REALY ON THE BOARD?
 1351 02227  5254          JMP     TAG3    /NO.
 1352 02230  7112          RTR CLL         /YES: PASTE TOGETHER THE ADDRESS OF THIS HYPOTHETICAL PAWN
 1353 02231  7010          RAR
 1354 02232  1037          TAD     M1
 1355 02233  7006          RTL
 1356 02234  7004          RAL
 1357 02235  1163          TAD     [BOARD  /ADD IN BOARD ADDRESS CONSTANT
 1358 02236  3021          DCA     TEMP1   /VOLIA! STORE THE ADDRESS
 1359 02237  1421          TAD  I  TEMP1   /GET THE VALUE OF THE PIECE AT THAT ADDR
 1360 02240  4777@         JMS     CLRFIX
 1361 02241  1376          TAD     (PAWN
 1362 02242  7640          SZA CLA         /PER CHANCE A PAWN?
 1363 02243  5254          JMP     TAG3    /NO: TRY NEXT PIECE 
 1364 02244  2100  TAG2,   ISZ     PCNT    /YES. ITS A PAWN ATTACK. INC PIECE COUNT
 1365 02245  1421          TAD  I  TEMP1   /SET LOWEST VALUED ATTACKING PIECE VALUE = PAWN
 1366 02246  3101          DCA     PVAL
 1367 02247  1021          TAD     TEMP1   /ALSO SET THE ADDRESS OF THE LOWEST ATTACKING PIECE
 1368 02250  3102          DCA     PSQR    /EQUAL TO THE ADDRESS OF THE PAWN
 1369 02251  1261          TAD     CKMODE  /TEST FOR 'FAST RETURN' MODE
 1370 02252  7640          SZA CLA
 1371 02253  5600          JMP  I  CHKATK  /RETURN NOW
 1372 02254  2260  TAG3,   ISZ     TMATK   /TESTED FOR PAWNS ON BOTH ADJACENT FILES?
 1373 02255  5263          JMP     TAG1    /YES
 1374 02256  7240          CMA CLA         /NO. LOOP BACK FOR THE OTHER FILE
 1375 02257  5225          JMP     TAG0
 1376 02260  0000  TMATK,  0000
 1377 02261  0000  CKMODE, 0000
 1378 02262  0000  TMATK1, 0000
 1379 02263  7200  TAG1,   CLA
 1380 02264  1057          TAD     OMAP    /GET ADDRESS-1 OF THE ATTACKERS PIECE MAP
 1381 02265  3060          DCA     TOMAK1
 1382 02266  2060  BATAK,  ISZ     TOMAK1  /INC THE PIECE TABLE ADDRESS
 1383 02267  1460          TAD  I  TOMAK1  /GET THE ADDRESS OF THE PIECE
 1384 02270  7450          SNA             /IS IT REALY A PIECE, OR IS THE SQUARE BLANK?
 1385 02271  5600          JMP  I  CHKATK  /BLANK. TABLE EXAUSTED:RETURN
 1386 02272  3260          DCA     TMATK   /NO. SOMTHINGS THERE. STORE ITS ADDRESS
 1387 02273  1260          TAD     TMATK   /GET THE ATTACKERS SQR ADDR
 1388 02274  7041          CIA
 1389 02275  1020          TAD     TEMP    /COMPARE WITH THE ATTACKED SQUARS ADDRESS
 1390 02276  7650          SNA CLA         /ARE THEY THE SAME?
 1391 02277  5266          JMP     BATAK   /YES.PIECES CANNOT ATTACK THEMSELVES
 1392 02300  1660          TAD  I  TMATK
 1393 02301  4777@         JMS     CLRFIX
 1394 02302  1376          TAD     (PAWN
 1395 02303  7650          SNA CLA         /IS IT A PAWN?
 1396 02304  5266          JMP     BATAK   /YES, DONE PAWNS ALLREADY, TRY NEXT PIECE
 1397 02305  1260          TAD     TMATK   /NO GET SQUARE ADDRESS
 1398 02306  0166          AND     [0007   /EXTRACT THE FILE
 1399 02307  3040          DCA     M2      /STORE IT



      / CHEKMO II                                                        Page 31


 1400 02310  1260          TAD     TMATK   /GET ADDRESS AGAIN
 1401 02311  7012          RTR             /ROTATE RANK # INTO BITS 9-11
 1402 02312  7010          RAR
 1403 02313  0166          AND     [0007   /ISOLATE RANK INFO
 1404 02314  3037          DCA     M1      /STORE IT
 1405 02315  1660          TAD  I  TMATK   /GET THE VALUE OF THE PIECE AGAIN
 1406 02316  4777@         JMS     CLRFIX
 1407 02317  1375          TAD     (ROOK   /NOW IDENTIFY IT
 1408 02320  7450          SNA             /IS IT A ROOK?
 1409 02321  5774@         JMP     ISLRM   /YES
 1410 02322  1373          TAD     (-ROOK+BISHOP
 1411 02323  7450          SNA             /IS IT A BISHOP?
 1412 02324  5772@         JMP     ISLBM   /YES
 1413 02325  1371          TAD     (-BISHOP+KNIGHT
 1414 02326  7450          SNA             /IS IT A KNIGHT?
 1415 02327  5770@         JMP     ISLNM   /YES
 1416 02330  1367          TAD     (-KNIGHT+KING
 1417 02331  7450          SNA             /IS IT A KING?
 1418 02332  5766@         JMP     ISLKM   /YES
 1419 02333  1365          TAD     (-KING+QUEEN
 1420 02334  7650          SNA CLA         /IS IT A QUEEN?
 1421 02335  5764@         JMP     ISLQM   /YES
 1422 02336  5266          JMP     BATAK   /NO? WHATEVER WAS THERE MUST HAVE MOVED! PLEASE TO IGNORE.
 1423              
 1424              /WE REACH HERE IF AN ATTACK ON THE SQUARE IN QUESTION IS FOUND
 1425 02337  2100  GATAK,  ISZ     PCNT    /INC ATTACK COUNTER
 1426 02340  1261          TAD     CKMODE  /TEST FOR FAST RETURN
 1427 02341  7640          SZA CLA         /'FAST RETURN' MODE?
 1428 02342  5600          JMP  I  CHKATK  /YES. RETURN NOW
 1429 02343  7240          CMA CLA
 1430 02344  1100          TAD     PCNT
 1431 02345  7650          SNA CLA         /IS THIS THE FIRST ATTACK FOUND?
 1432 02346  5355          JMP     TAG4    /YES. DONT COMPARE
 1433 02347  1660          TAD  I  TMATK   /NOW COMPARE THE VALUE OF THIS ATTACKING PIECE
 1434 02350  7041          CIA             /WITH THE LOWEST VALUED ATTACKER FOUND SO FAR
 1435 02351  1101          TAD     PVAL
 1436 02352  4777@         JMS     CLRFIX
 1437 02353  7700          SMA CLA         /IS THE VALUE OF THIS PIECE LOWER?
 1438 02354  5266          JMP     BATAK   /NO
 1439 02355  1660  TAG4,   TAD  I  TMATK   /YES. REPLACE THE OLD VALUE WITH THIS ONE
 1440 02356  3101          DCA     PVAL
 1441 02357  1260          TAD     TMATK
 1442 02360  3102          DCA     PSQR
 1443 02361  5266          JMP     BATAK
 1444              
      02364  2132
      02365  7500
      02366  2000
      02367  0574
      02370  1673



      / CHEKMO II                                                        Page 32


      02371  7772
      02372  2140
      02373  7712
      02374  2144
      02375  0240
      02376  0040
      02377  1410
 1445              PAGE
 1446              
 1447              /TEST FOR KING IN CHECK BY MOVING A PIECE AND CALLING CHKATK
 1448              /CALL WITH MSW IN AC, AND THE KINGS ADDRESS IN "CKING"
 1449              /RETURN TO THE ADDRESS+1 OF THE CALLING JMS IF THE KING IS IN CHECK
 1450              /RETURN TO THE ADDRESS+2 OF THE CALLING JMS IF THE KING IS NOT IN CHECK
 1451 02400  0000  TSTCHK, 0000
 1452 02401  3311          DCA     MMUMTM  /STORE THE MSW FOR THE MOMENT
 1453 02402  1777@         TAD     GNCHEK  /GET # OF ATTACKS ON THE KING
 1454 02403  7640          SZA CLA         /WAS THE KING IN CHECK?
 1455 02404  5244          JMP     TSTCH1  /YES. DO A COMPLETE TEST FOR KING IN CHECK
 1456 02405  1137          TAD     CTNEED
 1457 02406  7510          SPA             /HAVE WE DETERMINED THAT A CHECK TEST IS NESCESARY?
 1458 02407  5244          JMP     TSTCH1  /YES. DO ONE
 1459 02410  7650          SNA CLA         /NO. HAVE WE DETERMINED THAT IT IS NOT?
 1460 02411  5257          JMP     TSTCH2  /YES. DONT DO ONE THEN
 1461 02412  3137          DCA     CTNEED  /NO. DETERMINE THAT NOW
 1462 02413  1067          TAD     CKING
 1463 02414  3020          DCA     TEMP
 1464 02415  1064          TAD     CNTR1
 1465 02416  3776@         DCA     TMATK
 1466 02417  1020          TAD     TEMP
 1467 02420  7112          RTR CLL
 1468 02421  7010          RAR
 1469 02422  0166          AND     [0007
 1470 02423  3041          DCA     M3
 1471 02424  1020          TAD     TEMP
 1472 02425  0166          AND     [0007
 1473 02426  3042          DCA     M4
 1474 02427  1064          TAD     CNTR1
 1475 02430  7112          RTR CLL
 1476 02431  7010          RAR
 1477 02432  0166          AND     [0007
 1478 02433  3037          DCA     M1
 1479 02434  1064          TAD     CNTR1
 1480 02435  0166          AND     [0007
 1481 02436  3040          DCA     M2
 1482 02437  4775@         JMS     SUBR1
 1483 02440  7410          SKP
 1484 02441  5244          JMP     TSTCH1
 1485 02442  4774@         JMS     SUBR2
 1486 02443  5257          JMP     TSTCH2
 1487 02444  7240  TSTCH1, CLA CMA



      / CHEKMO II                                                        Page 33


 1488 02445  3137          DCA     CTNEED  /SET CHECK TEST NEED SWITCH
 1489 02446  1311          TAD     MMUMTM  /GET THE MSW BACK AGAIN
 1490 02447  4266          JMS     MMOVE
 1491 02450  1067          TAD     CKING   /ADDRESS TO TEST FOR ATTACK
 1492 02451  3020          DCA     TEMP
 1493 02452  7001          IAC             /RETURN AFTER FIRST ATTACK IS FOUND
 1494 02453  4773@         JMS     CHKATK
 1495 02454  4300          JMS     UMOVE   /PUT THE PIECE BACK WHERE IT BELONGS
 1496 02455  1100          TAD     PCNT    /GET # OF ATTACKS
 1497 02456  7450          SNA             /ANY?
 1498 02457  2200  TSTCH2, ISZ     TSTCHK  /NO. INC RETURN ADDRESS
 1499 02460  7650          SNA CLA         /I'LL ASK AGAIN: WERE THERE ANY?
 1500 02461  5600          JMP  I  TSTCHK  /NO. RETURN
 1501 02462  1777@         TAD     GNCHEK
 1502 02463  7640          SZA CLA         /WAS IT A CHECK REPLY?
 1503 02464  2133          ISZ     MOBMOD  /TALLY ONE MORE ILLEGAL BY VIRTUE OF KING IN CHECK
 1504 02465  5600          JMP  I  TSTCHK
 1505              
 1506              /SUBROUTINE TO MAKE A SIMPLE TYPE MOVE
 1507              /CALL WITH MSW IN AC
 1508 02466  0000  MMOVE,  0000
 1509 02467  3312          DCA     MMUMT1  /STORE THE MSW
 1510 02470  1312          TAD     MMUMT1
 1511 02471  4503          JMS  I  ZSPLIT  /SPLIT THE MSW UP INTO 'TO' AND 'FROM' SQUARE ADDRESSES
 1512 02472  1421          TAD  I  TEMP1   /GET VALUE  OF CAPTURED PIECE
 1513 02473  3311          DCA     MMUMTM  /STORE IT
 1514 02474  1422          TAD  I  TEMP2   /MOVE THE PIECE
 1515 02475  3421          DCA  I  TEMP1   /ONTO ITS NEW SQR
 1516 02476  3422          DCA  I  TEMP2   /CLEAR OUT OLD SQR
 1517 02477  5666          JMP  I  MMOVE
 1518              
 1519              /SUBROUTINE TO UMMAKE SIMPLE TYPE MOVES
 1520              /AS MADE BY THE MMOVE SUBROUTINE
 1521 02500  0000  UMOVE,  0000
 1522 02501  7200          CLA
 1523 02502  1312          TAD     MMUMT1  /GET THE MSW
 1524 02503  4503          JMS  I  ZSPLIT  /SPLIT IT UP INTO 'TO' AND 'FROM' SQUARE ADDRESSES
 1525 02504  1421          TAD  I  TEMP1   /GET VALUE OF THE PIECE BEING UNMOVED
 1526 02505  3422          DCA  I  TEMP2   /PUT IT BACK ON ITS ORIGINAL SQUARE
 1527 02506  1311          TAD     MMUMTM
 1528 02507  3421          DCA  I  TEMP1   /RESTORE CAPTURED PIECE
 1529 02510  5700          JMP  I  UMOVE
 1530 02511  0000  MMUMTM, 0000
 1531 02512  0000  MMUMT1, 0000
 1532              
 1533              /SUBROUTINE TO GENERATE ALL MOVES FOR WHITE
 1534 02513  0000  GNWMV,  0000
 1535 02514  7240          CMA CLA         /SETUP FIRST RANK CONSTANT
 1536 02515  3051          DCA     FSTRNK
 1537 02516  4475          JMS  I  ZMAPEC  /MAP THE PIECES



      / CHEKMO II                                                        Page 34


 1538 02517  1372          TAD     (NOP    /SETUP COLOR COMPLIMENTOR
 1539 02520  3771@         DCA     COLR
 1540 02521  7001          IAC             /SETUP PAWN DIRECTION CONSTANT
 1541 02522  3036          DCA     PONDIR
 1542 02523  1065          TAD     WKING   /SAVE THE ADDRESS OF THE WHITE KING
 1543 02524  3067          DCA     CKING
 1544 02525  1370          TAD     (MAP-1  /SETUP ADDRESS OF WHITE PIECE MAP
 1545 02526  3056          DCA     GMAP
 1546 02527  1367          TAD     (MAP+23 /SETUP ADDRESS OF BLACK PIECE MAP
 1547 02530  3057          DCA     OMAP
 1548 02531  1366          TAD     (WPSW   /SETUP CURRENT PSW ADDRESS
 1549 02532  3055          DCA     CPSW
 1550 02533  4472          JMS  I  ZGNMV   /GENERATE THE MOVES
 1551 02534  5713          JMP  I  GNWMV   /RETURN
 1552              
 1553              
 1554              /SUBROUTINE TO GENERATE ALL MOVES FOR BLACK
 1555 02535  0000  GNBMV,  0000
 1556 02536  7240          CMA CLA         /SETUP THE PAWN DIRECTION CONSTANT
 1557 02537  3036          DCA     PONDIR
 1558 02540  4475          JMS  I  ZMAPEC  /MAP THE PIECES
 1559 02541  1161          TAD     [CIA    /SETUP COLOR COMPLIMENTOR
 1560 02542  3771@         DCA     COLR
 1561 02543  1066          TAD     BKING   /SAVE THE ADDRESS OF THE BLACK KING
 1562 02544  3067          DCA     CKING
 1563 02545  1365          TAD     (7772   /SETUP FIRST RANK CONSTANT
 1564 02546  3051          DCA     FSTRNK
 1565 02547  1367          TAD     (MAP+23 /SETUP ADDRESS OF BLACK PIECE MAP
 1566 02550  3056          DCA     GMAP
 1567 02551  1370          TAD     (MAP-1  /SETUP ADDRESS OF WHITE PIECE MAP
 1568 02552  3057          DCA     OMAP
 1569 02553  1364          TAD     (BPSW   /SETUP POSITION STATUS WORD ADDRESS
 1570 02554  3055          DCA     CPSW
 1571 02555  4472          JMS  I  ZGNMV   /GENERATE THE MOVES
 1572 02556  5735          JMP  I  GNBMV   /RETURN
 1573              
      02564  0054
      02565  7772
      02566  0053
      02567  7423
      02570  7377
      02571  1411
      02572  7000
      02573  2200
      02574  2113
      02575  2070
      02576  2260
      02577  0513
 1574              PAGE
 1575              



      / CHEKMO II                                                        Page 35


 1576              /SUBROUTINE TO TEST FOR WHITE ATTACKS
 1577              /CALL WITH ADDRESS OF THE SQUARE TO BE TESTED IN AC
 1578 02600  0000  TSTWAT, 0000
 1579 02601  3020          DCA     TEMP
 1580 02602  1161          TAD     [CIA
 1581 02603  3777@         DCA     COLR
 1582 02604  7240          CLA CMA
 1583 02605  3036          DCA     PONDIR
 1584 02606  1376          TAD     (MAP-1  /ADDRESS-1 OF MAP OF ATTACKING PIECES
 1585 02607  3057          DCA     OMAP
 1586 02610  4775@         JMS     CHKATK  /DO THE TEST
 1587 02611  5600          JMP  I  TSTWAT  /RETURN
 1588              
 1589              /SUBROUTINE TO TEST FOR BLACK ATTACKS ON ANY SQUARE
 1590              /CALL WITH THE ADDRESS OF THE SQUARE TO BE TESTED IN AC
 1591 02612  0000  TSTBAT, 0000
 1592 02613  3020          DCA     TEMP    /STORE ADDRESS OF SQUARE TO BE TESTED
 1593 02614  1374          TAD     (NOP
 1594 02615  3777@         DCA     COLR
 1595 02616  7201          CLA IAC
 1596 02617  3036          DCA     PONDIR
 1597 02620  1373          TAD     (MAP+23 /ADDRESS-1 OF THE BLACK PIECE MAP
 1598 02621  3057          DCA     OMAP
 1599 02622  4775@         JMS     CHKATK  /DO THE TEST
 1600 02623  5612          JMP  I  TSTBAT  /RETURN
 1601              
 1602              
 1603              
 1604              /SUBROUTINE TO MAKE A MOVE. CALLED WITH MSW IN LOCATION 'TOMAK1'
 1605              /AND MDW IN LOCATION 'TOMAK2'
 1606 02624  0000  MKMV,   0000
 1607 02625  7300          CLA CLL
 1608 02626  2151          ISZ     DOMAP   /SET SWITCH INDICATING THAT A PIECE MAP IS NESSECARY
 1609                      IFNZRO  DEBUG<
 1610 02627  4772@         JMS     TSTBRD  /TEST BOARD
 1611              >
 1612 02630  1060          TAD     TOMAK1
 1613 02631  4577          PUSH1           /SAVE THE MSW
 1614 02632  1060          TAD     TOMAK1  /GET THE MSW
 1615 02633  4503          JMS  I  ZSPLIT  /SPLIT  THE MSW UP INTO A 'TO' AND A 'FROM' ADDRESSES
 1616 02634  1061          TAD     TOMAK2  /MDW TO AC
 1617 02635  7700          SMA CLA         /IS THE MOVE A CAPTURE?
 1618 02636  5245          JMP     MKMV1   /NO.
 1619 02637  1421          TAD  I  TEMP1   /YES. SAVE ITS VALUE IN
 1620 02640  4577          PUSH1           /THE PUSH DOWN LIST
 1621 02641  1421          TAD  I  TEMP1   /GET VAL OF CAPTURED PIECE
 1622 02642  7041          CIA             /SUBTRACT IT FROM THE
 1623 02643  1076          TAD     PW      /TOTAL VALUE OF THE BOARD
 1624 02644  3076          DCA     PW
 1625 02645  1422  MKMV1,  TAD  I  TEMP2   /NOW PHYSICALY MOVE THE PIECE



      / CHEKMO II                                                        Page 36


 1626 02646  3421          DCA  I  TEMP1   /ONTO ITS NEW SQUARE
 1627 02647  3422          DCA  I  TEMP2   /REMOVE THE PIECE FROM ITS OLD SQUARE
 1628 02650  1053          TAD     WPSW    /SAVE WHITES POSITION STATUS WORD
 1629 02651  4577          PUSH1
 1630 02652  1054          TAD     BPSW    /SAVE BLACKS POSITION STATUS WORD
 1631 02653  4577          PUSH1
 1632 02654  1071          TAD     LSTMV
 1633 02655  4577          PUSH1           /SAVE THE 'LSTMV' INFORMATION
 1634 02656  1061          TAD     TOMAK2  /INSTALL NEW INFORMATION ON THE LAST(THIS) MOVE MADE
 1635 02657  3071          DCA     LSTMV
 1636 02660  1061          TAD     TOMAK2
 1637 02661  0166          AND     [0007
 1638 02662  7450          SNA             /IS THIS ONE OF THE SPECIAL TYPES OF MOVES?
 1639 02663  5356          JMP     MKMVDN  /NO. ALL DONE SO RETURN
 1640 02664  1371          TAD     (JMP    .+2     /YES. BUILD A 'JMP' TO THE PROPER SPECIAL CASE HANDLER
 1641 02665  3266          DCA     .+1
 1642 02666  7402          HLT             /PUT THE JUMP HERE
 1643              /A JMP TO  ONE OF THE FOLLOWING 7 INSTRUCTIONS WAS EXECUTED
 1644              /BY THE PREVIOUS INSTRUCTION
 1645 02667  5316          JMP     MKQSC   /MAKE A QUEEN SIDE CASTLING MOVE
 1646 02670  5335          JMP     MKKSC   /MAKE A KING SIDE CASTLING MOVE
 1647 02671  5342          JMP     MKEP    /EN PASANT
 1648 02672  1370          TAD     (KNIGHT-BISHOP  /PROMOTING TO A KNIGHT
 1649 02673  1367          TAD     (BISHOP-ROOK    /PROMOTING TO A BISHOP
 1650 02674  1366          TAD     (ROOK-QUEEN     /PROMOTING TO A ROOK
 1651 02675  1365          TAD     (QUEEN          /PROMOTE TO A QUEEN
 1652 02676  3023          DCA     TEMP3   /STORE ABS VALUE OF THE PROM PIECE
 1653 02677  1421          TAD  I  TEMP1   /GET THE VALUE OF THE PROMOTEING PAWN
 1654 02700  7041          CIA             /SUBTRACT IT FROM THE
 1655 02701  1076          TAD     PW      /TOTAL VALUE OF THE BOARD
 1656 02702  3076          DCA     PW
 1657 02703  1421          TAD  I  TEMP1   /GET THE VAL OF THE MOVING PAWN
 1658 02704  7004          RAL             /LOAD THE SIGN INTO THE LINK
 1659 02705  7200          CLA
 1660 02706  1023          TAD     TEMP3   /GET ABS VALUE OF PROM PIECE
 1661 02707  7430          SZL             /WAS THE PROMOTING PAWN BLACK?
 1662 02710  7041          CIA             /YES. MAKE THE PROMOTION PIECE BLACK ALSO
 1663 02711  3421          DCA  I  TEMP1   /PLACE THE NEW PIECE ON THE BOARD
 1664 02712  1421          TAD  I  TEMP1   /ADD THE VALUE OF THE NEW PIECE
 1665 02713  1076          TAD     PW      /IN WITH THE TOTAL VALUE
 1666 02714  3076          DCA     PW
 1667 02715  5356          JMP     MKMVDN
 1668              
 1669 02716  1021  MKQSC,  TAD     TEMP1   /IT'S QUEENS SIDE CASTLING
 1670 02717  0164          AND     [7770
 1671 02720  3022          DCA     TEMP2   /STORE THE ADDR OF QUEENS ROOK BEFORE CASTLING
 1672 02721  1022          TAD     TEMP2
 1673 02722  1364          TAD     (3
 1674 02723  3021          DCA     TEMP1   /STORE ADDRESS OF ROOKS NEW SQUARE
 1675 02724  1422  MKCA1,  TAD  I  TEMP2   /LOAD AC WITH VALUE OF THE ROOK



      / CHEKMO II                                                        Page 37


 1676 02725  3421          DCA  I  TEMP1   /PUT THE ROOK DOWN ON ITS NEW SQR
 1677 02726  3422          DCA  I  TEMP2   /REMOVE THE ROOK FROM ITS OLD SQR
 1678 02727  1421          TAD  I  TEMP1   /GET COLOR OF CASTLING SIDE
 1679 02730  7510          SPA             /IS IT BLACK?
 1680 02731  2054          ISZ     BPSW    /YES. SET BIT 11 OF HIS PSW
 1681 02732  7700          SMA CLA         /OR IS IT WHITE?
 1682 02733  2053          ISZ     WPSW    /YES. SET BIT 11 OF HIS PSW
 1683 02734  5356          JMP     MKMVDN
 1684              
 1685 02735  1021  MKKSC,  TAD     TEMP1   /BUILD ADDRESS OF THE
 1686 02736  7001          IAC             /KINGS ROOK
 1687 02737  3022          DCA     TEMP2   /STORE THE ADDR OF KINGS ROOK BEFORE CASTLING
 1688 02740  1363          TAD     (-5     /BUILD THE ADDRESS OF THE ROOKS
 1689 02741  5321          JMP     MKCA1-3 /NEW SQUARE
 1690              
 1691 02742  1022  MKEP,   TAD     TEMP2   /IT'S AN 'EN PASSANT' CAPTURE
 1692 02743  0164          AND     [7770   /BUILD ADDRESS OF THE PAWN THAT WAS TAKEN
 1693 02744  3023          DCA     TEMP3
 1694 02745  1021          TAD     TEMP1
 1695 02746  0166          AND     [0007
 1696 02747  1023          TAD     TEMP3
 1697 02750  3023          DCA     TEMP3
 1698 02751  1423          TAD  I  TEMP3   /SUBTRACT THE PAWNS VALUE
 1699 02752  7041          CIA             /FROM THE TOTAL
 1700 02753  1076          TAD     PW
 1701 02754  3076          DCA     PW
 1702 02755  3423          DCA  I  TEMP3   /REMOVE CAPTURED PAWN FROM THE BOARD
 1703              MKMVDN, IFNZRO  DEBUG   <
 1704 02756  4772@         JMS     TSTBRD  /TEST BOARD VALUE
 1705              >
 1706 02757  1077          TAD     WHOSE   /NOW THAT THE MOVE IS MADE
 1707 02760  7040          CMA             /COMPLIMENT
 1708 02761  3077          DCA     WHOSE   /THE "WHOSE MOVE" SWITCH
 1709 02762  5624          JMP  I  MKMV    /AND RETURN
 1710              
      02763  7773
      02764  0003
      02765  0440
      02766  7600
      02767  7712
      02770  7772
      02771  5266
      02772  3156
      02773  7423
      02774  7000
      02775  2200
      02776  7377
      02777  1411
 1711              PAGE
 1712              



      / CHEKMO II                                                        Page 38


 1713              
 1714              /SUBROUTINE TO UNMAKE A MOVE  MADE BY THE 'MKMV' ROUTINE
 1715              /LIKE THE 'MKMV' SUBROUTINE 'UNMV' IS COLOR INDEPENDENT- USES NO 'CLRFIX'
 1716 03000  0000  UNMV,   0000
 1717 03001  7300          CLA CLL
 1718 03002  2151          ISZ     DOMAP   /SET SWITCH FOR OBSOLETE PIECE MAP
 1719                      IFNZRO  DEBUG<
 1720 03003  4356          JMS     TSTBRD  /MAKE SURE BOARD VALUE IS OK
 1721              >
 1722 03004  1071          TAD     LSTMV   /GET THE MDW FOR THE LAST(THIS) MOVE MADE
 1723 03005  3061          DCA     TOMAK2
 1724 03006  4576          POP1            /GET THE OLD 'LSTMV' INFO
 1725 03007  3071          DCA     LSTMV   /RESTORE IT
 1726 03010  4576          POP1            /RESTORE BLACKS PSW
 1727 03011  3054          DCA     BPSW
 1728 03012  4576          POP1            /RESTORE WHITES PSW
 1729 03013  3053          DCA     WPSW
 1730 03014  1061          TAD     TOMAK2  /GET THE MDW FOR THE MOVE
 1731 03015  7710          SPA CLA         /IS IT A CAPTURE?
 1732 03016  4576          POP1            /YES. GET THE VALUE OF THE CAPTURED PIECE
 1733 03017  3023          DCA     TEMP3   /STORE IT
 1734 03020  4576          POP1            /GET THE OLD MSW
 1735 03021  3060          DCA     TOMAK1  /STORE THE MSW
 1736 03022  1060          TAD     TOMAK1  /BACK AGAIN
 1737 03023  4503          JMS  I  ZSPLIT  /UNPACK THE MSW AND BUILD THE 'TO' AND 'FROM' ADDRESSES
 1738 03024  1421          TAD  I  TEMP1   /GET THE MOVED PIECE AND
 1739                      IFNZRO  DEBUG<  
 1740 03025  7450          SNA             /IS IT STILL THERE?
 1741 03026  7402          HLT             /BUG!!!
 1742              >
 1743 03027  3422          DCA  I  TEMP2   /PUT IT BACK ON ITS OLD SQUARE
 1744 03030  1023          TAD     TEMP3
 1745 03031  3421          DCA  I  TEMP1   /RESTORE THE VALUE OF THE CAPTURED PIECE(OR EMPTY SQUARE)
 1746 03032  1023          TAD     TEMP3   /ADD VAL OF CAPTURED PIECE
 1747 03033  1076          TAD     PW      /BACK IN WITH THE TOTAL
 1748 03034  3076          DCA     PW
 1749 03035  1061          TAD     TOMAK2
 1750 03036  0166          AND     [0007
 1751 03037  7450          SNA             /WAS THE MOVE A SPECIAL TYPE?
 1752 03040  5323          JMP     UNMVDN  /NO. RETURN
 1753 03041  1377          TAD     (JMP    .+2
 1754 03042  3243          DCA     .+1
 1755 03043  7402          HLT             /THE JUMP GOES HERE
 1756              /A JUMP TO ONE OF THE FOLLOWING 7 LOCATIONS WAS
 1757              /EXECUTED BY THE PREVIOUS INSTRUCTION
 1758 03044  5301          JMP     UNQSC   /UNMAKE A QUEEN SIDE CASTLING MOVE
 1759 03045  5267          JMP     UNKSC   /UNMAKE KING SIDE CASTLING MOVE
 1760 03046  5306          JMP     UNEP    /UNMAKE AN EN PASSANT CAPTURE
 1761 03047  5252          JMP     UNQP
 1762 03050  5252          JMP     UNQP



      / CHEKMO II                                                        Page 39


 1763 03051  5252          JMP     UNQP
 1764 03052  1422  UNQP,   TAD  I  TEMP2   /PAWN PROM. MOVE
 1765 03053  7041          CIA             /SUBTRACT PROMOTION VALUE
 1766 03054  1076          TAD     PW      /FROM THE TOTAL
 1767 03055  3076          DCA     PW
 1768 03056  1422          TAD  I  TEMP2   /GET VALUE OF THE PROMOTION PIECE
 1769 03057  7700          SMA CLA         /WHICH COLOR IS MOVING?
 1770 03060  1376          TAD     (PAWN+PAWN      /WHITE IS MOVING.
 1771 03061  1165          TAD     [-PAWN
 1772 03062  3422          DCA  I  TEMP2   /RESTORE THE PROMOTION PIECE BACK TO A PAWN
 1773 03063  1422          TAD  I  TEMP2   /ADD THE VAL OF THE PAWN
 1774 03064  1076          TAD     PW      /IN WITH THE TOTAL VALUE
 1775 03065  3076          DCA     PW
 1776 03066  5323          JMP     UNMVDN
 1777              
 1778 03067  1022  UNKSC,  TAD     TEMP2   /BUILD ADDR OF ROOKS 'POST CASTLING' SQUARE 
 1779 03070  7001          IAC             /BY ADDING +1 TO THE KINGS 'PRE CASTLING' SQUARE ADDRESS
 1780 03071  3022          DCA     TEMP2   /STORE IT
 1781 03072  1022  UNKS1,  TAD     TEMP2   /BUILD ADDRESS OF THE ROOKS 'PRE CASTLING' SQUARE ADDR
 1782 03073  1375          TAD     (2      /BY ADDING +2 TO ITS 'POST-CASTLING' SQUARE ADDR
 1783 03074  3021          DCA     TEMP1   /STORE ROOKS PRE CASTLING SQUARE ADDRESS
 1784 03075  1422          TAD  I  TEMP2   /GET THE ROOKS VALUE
 1785 03076  3421          DCA  I  TEMP1   /PLACE THE ROOK BACK ON ITS 'PRE CASTLING' SQUARE
 1786 03077  3422          DCA  I  TEMP2   /REMOVE IT FROM ITS 'POST CASTLING SQUARE'
 1787 03100  5323          JMP     UNMVDN
 1788              
 1789 03101  1021  UNQSC,  TAD     TEMP1   /BUILD THE ADDR OF THE ROOKS 'POST CASTLING SQUARE
 1790 03102  7001          IAC             /BY ADDING +1 TO THE KINGS 'POST CASTLING' SQUARE ADDRESS
 1791 03103  3022          DCA     TEMP2   /STORE IT
 1792 03104  1374          TAD     (-5     /BUILD THE ADDRESS OF THE ROOKS 'PRE CASTLING SQUARE'
 1793 03105  5272          JMP     UNKS1   /SAME AS KING SIDE EXCEPT OVER 5 FILES
 1794 03106  1021  UNEP,   TAD     TEMP1   /BUILD THE ADDRESS OF THE CAPTURED PAWN
 1795 03107  0166          AND     [0007   /TAKE THE FILE OF THE 'TO SQUARE'
 1796 03110  3023          DCA     TEMP3   /STORE THE TO SQUARE' FILE #
 1797 03111  1022          TAD     TEMP2   /AND EVERYTHING BUT THE FILE #
 1798 03112  0164          AND     [7770   /FROM THE FROM SQUARE ADDRESS
 1799 03113  1023          TAD     TEMP3   /ADD THEN TOGEATHER
 1800 03114  3023          DCA     TEMP3   /STORE
 1801 03115  1422          TAD  I  TEMP2   /GET THE VALUE OF THE CAAPTURING PAWN
 1802 03116  7041          CIA             /MAKE THE VALUE THAT OF AN OPOSITE COLORED PAWN
 1803 03117  3423          DCA  I  TEMP3   /REPLACE THE PAWN THAT WAS TAKEN 'EN PASSANT'
 1804 03120  1423          TAD  I  TEMP3   /ADD PAWNS VALUE
 1805 03121  1076          TAD     PW      /IN WITH THE TOTAL
 1806 03122  3076          DCA     PW
 1807              UNMVDN, IFNZRO  DEBUG   <
 1808 03123  4356          JMS     TSTBRD  /VERIFY BOARD VALUE
 1809              >
 1810 03124  1077          TAD     WHOSE   /NOW THAT THE MOVE IS UNMADE
 1811 03125  7040          CMA             /COMPLIMENT
 1812 03126  3077          DCA     WHOSE   /THE "WHOSE MOVE" SWITCH



      / CHEKMO II                                                        Page 40


 1813 03127  5600          JMP  I  UNMV    /RETURN
 1814              
 1815              /SUBROUTINE TO SPLIT A MSW UP LEAVING THE ADDRESS
 1816              /OF THE 'TO' SQUARE IN LOC 'TEMP1' AND THE ADDRESS OF THE 'FROM'
 1817              /SQUARE IN LOC. 'TEMP2'. CALL WITH MSW IN AC
 1818 03130  0000  SPLIT,  0000
 1819 03131  3021          DCA     TEMP1
 1820 03132  1021          TAD     TEMP1   /FIRST BUILD THE 'FROM' SQUARE ADDRESS
 1821 03133  7112          RTR CLL
 1822 03134  7012          RTR
 1823 03135  7012          RTR
 1824 03136  0167          AND     [0077   /MASK OUT THE GARBAGE IN BITS 0-5
 1825 03137  1163          TAD     [BOARD  /ADD IN BOARD ADDRESS CONSTANT
 1826 03140  3022          DCA     TEMP2   /STORE 'FROM' SQUARE ADDRESS
 1827 03141  1021          TAD     TEMP1   /NOW FOR THE 'TO' SQUARE.
 1828 03142  0167          AND     [0077   /MASK OUT BITS 0-5
 1829 03143  1163          TAD     [BOARD  /ADD IN BOARD ADDRESS CONSTANT
 1830 03144  3021          DCA     TEMP1   /STORE THE ADDRESS OF THE 'TO' SQUARE
 1831 03145  5730          JMP  I  SPLIT   /RETURN
 1832              
 1833              /SUBROUTINE TO RETURN THE PLY#-1 IN THE AC.
 1834              /IF THE PLY # IS 8 OR GREATER,  7 IS RETURNED, AND THE LINK IS SET
 1835              /IF PLY # <8 THE LINK IS RETURNED CLEAR
 1836 03146  0000  PLYCHP, 0000
 1837 03147  7320          CLA STL
 1838 03150  1122          TAD     PLY     /GET PLY #
 1839 03151  1164          TAD     [7770   /SUBTRACT 8
 1840 03152  7500          SMA             /IS PLY # 8 OR GREATER ?
 1841 03153  7200          CLA             /YES. PRETEND IT WAS 8
 1842 03154  1166          TAD     [0007   /RESTORE AC VALUE TO PLY#-1
 1843 03155  5746          JMP  I  PLYCHP  /RETURN
 1844              
 1845                      IFNZRO  DEBUG   <
 1846              /SUBROUTINE TO GET AN OLD BOARD VALUE FROM PDL#1 AND COMPARE IT WITH THE CURRENT
 1847              /BOARD VALUE. TO VERIFY THE "MKMV" AND "UNMV" SUBROUTINES
 1848 03156  0000  TSTBRD, 0000
 1849 03157  7200          CLA
 1850 03160  1076          TAD     PW
 1851 03161  3021          DCA     TEMP1
 1852 03162  4773@         JMS     BRDVAL  /GET CURRENT BOARD VALUE
 1853 03163  7041          CIA
 1854 03164  1021          TAD     TEMP1
 1855 03165  7640          SZA CLA         /ARE THEY THE SAME?
 1856 03166  7402          HLT             /NO. ERROR SOMEWHERE
 1857 03167  5756          JMP  I  TSTBRD  /ALL IS WELL
 1858              >
      03173  3233
      03174  7773
      03175  0002
      03176  0100



      / CHEKMO II                                                        Page 41


      03177  5243
 1859              PAGE
 1860              
 1861              
 1862              /SUBROUTINE TO COMPARE THE AC WITH LOCATION 'COMP'
 1863              /RETURN NORMALY IF THEY ARE EQUAL
 1864              /RETURN TO THE ADDRESS+2 OF THE JMS IF THE AC IS LARGER
 1865              /RETURN TO THE ADDRESS+3 OF THE JMS IF 'COMP' IS LARGER
 1866 03200  0000  COMPAR, 0000
 1867 03201  7041          CIA
 1868 03202  3232          DCA     COMPAC  /STORE THE COMPLIMENT OF THE AC
 1869 03203  1232          TAD     COMPAC  /COMPARE THE AC WITH 'COMP'
 1870 03204  1114          TAD     COMP
 1871 03205  7650          SNA CLA         /ARE THEY EQUAL?
 1872 03206  5600          JMP  I  COMPAR  /YES. RETURN NORMALY
 1873 03207  1232          TAD     COMPAC  /NO. GET COMPLIMENT OF THE AC AGAIN
 1874 03210  7750          SPA SNA CLA     /WAS THE AC POSITIVE?
 1875 03211  5221          JMP     XXAP    /YES. AC WAS POSITIVE
 1876 03212  1114          TAD     COMP    /NEGATIVE
 1877 03213  7500          SMA             /IS 'COMP' POSITIVE?
 1878 03214  5226          JMP     XXCL    /YES. 'COMP' IS LARGER ALSO
 1879 03215  1232          TAD     COMPAC  /NO. BOTH ARE NEGATIVE
 1880 03216  7710          SPA CLA         /BUT WHICH IS THE LARGER?
 1881 03217  5227          JMP     XXAL    /THE AC IS THE LARGER
 1882 03220  5226          JMP     XXCL    /'COMP' IS THE LARGER
 1883 03221  1114  XXAP,   TAD     COMP    /THE AC WAS POSITIVE
 1884 03222  7510          SPA             /TEST 'COMP' FOR ITS SIGN
 1885 03223  5227          JMP     XXAL    /'COMP' IS NEGATIVE, AND THEREFORE LARGER
 1886 03224  1232          TAD     COMPAC
 1887 03225  7700          SMA CLA
 1888 03226  2200  XXCL,   ISZ     COMPAR  /'COMP' IS LARGER
 1889 03227  2200  XXAL,   ISZ     COMPAR  /AC IS LARGER
 1890 03230  7200          CLA
 1891 03231  5600          JMP  I  COMPAR  /RETURN
 1892 03232  0000  COMPAC, 0000
 1893              
 1894              /SUBROUTINE TO TALLY UP THE VALUES OF ALL PIECES ON THE BOARD
 1895              /STORE THE RESULT IN LOC "PW", AND IN THE AC  ON RETURN
 1896 03233  0000  BRDVAL, 0000
 1897 03234  7200          CLA
 1898 03235  1377          TAD     (-100   /INITIALIZE FOR 64 SQUARES
 1899 03236  3020          DCA     TEMP
 1900 03237  1376          TAD     (BOARD-1/ADDRESS-1 OF BOARD
 1901 03240  3014          DCA     ITMP1   /TO AUTO INDEX REG
 1902 03241  1414          TAD  I  ITMP1
 1903 03242  2020          ISZ     TEMP    /DONE ALL SQUARES?
 1904 03243  5241          JMP     .-2     /NO DO ANNOTHER
 1905 03244  3076          DCA     PW      /YES. STORE BOARD VALUE
 1906 03245  1076          TAD     PW      /ALSO LOAD INTO AC
 1907 03246  5633          JMP  I  BRDVAL  /RETURN



      / CHEKMO II                                                        Page 42


 1908              
 1909 03247  0000  PRNCNT, 0000
 1910              
 1911 03250  0000  EVAL,  0000
 1912 03251  7200          CLA
 1913                      IFNZRO RANVAL<
 1914 03252  1411          TAD  I  RANDOM  /INTRODUCE A RANDOM VARIATION INTO THIS EVALUATION
 1915 03253  0375          AND     (0001   /LET IT BE NO GREATER THAN +1
 1916              >
 1917 03254  3140          DCA     STRATG
 1918 03255  4774@         JMS     BREV    /DO A BACK RANK EVALUATION
 1919 03256  4773@         JMS     COEV    /DO A CENTER OCCUPATION EVALUATION
 1920 03257  4772@         JMS     CASTEV  /EVALUATE CASTLING STATUS
 1921 03260  1076          TAD     PW      /ADD THE VALUE OF ALL PIECES ON THE BOARD
 1922 03261  1140          TAD     STRATG  /ADD IN STRATEGICAL VALUE
 1923 03262  4771@         JMS     LCLRFX  /DO A COLOR FIX
 1924 03263  3140          DCA     STRATG  /STORE
 1925 03264  4310          JMS     MOBGET  /GET MOBILITY VALUE
 1926 03265  1140          TAD     STRATG  /ADD IT IN WITH THE TOTAL
 1927 03266  3140          DCA     STRATG  /STORE
 1928              /UPCOMING IS A MINI ALPHA BETA PRUNER
 1929              /SINCE THE "HIEP" PART OF THE EVALUATION IS TIME CONSUMING
 1930              /AND IT ONLY SERVES TO MAKE THE EVALUATION RETURNED LESS
 1931              /FAVORABLE FOR THE SIDE TO THAT JUST MOVED, IT IS BOTH
 1932              /WISE AND PROFITABLE TO TRY SAVE TIME THIS WAY
 1933 03267  1140          TAD     STRATG
 1934 03270  4770@         JMS     PLYFIX
 1935 03271  3114          DCA     COMP    /LOAD SOFTWARE COMPARE REGISTER
 1936 03272  1116          TAD     UVAL1
 1937 03273  4770@         JMS     PLYFIX
 1938 03274  4200          JMS     COMPARE/COMPARE VALUES
 1939 03275  5304          JMP     EVAL2   /THEY ARE EQUAL. PRUNE
 1940 03276  5300          JMP     EVAL1   /"HIEP" EVALUATION IS NESSECARY
 1941 03277  5304          JMP     EVAL2   /NO "HIEP" NESSECARY(GOOD)
 1942 03300  4767@ EVAL1,  JMS     HIEP    /GET THE CONTROVERSIAL VALUE
 1943 03301  4771@         JMS     LCLRFX
 1944 03302  1140          TAD     STRATG
 1945 03303  5650          JMP  I  EVAL    /RETURN
 1946              
 1947              EVAL2,  IFNZRO LPTREE<
 1948 03304  1366          TAD     ("_     /SIGNAL THAT A MINI-PRUNE WAS DONE
 1949 03305  4426          JMS  I  ZOUT
 1950              >
 1951 03306  1140          TAD     STRATG  /GET VALUE
 1952 03307  5650          JMP  I  EVAL    /RETURN
 1953              
 1954              /SUBROUTINE TO GET THE MOBILITY VALUE FOR THIS POINT IN
 1955              /THE ANALYSIS
 1956              /RETURN WITH VALUE IN THE AC
 1957 03310  0000  MOBGET, 0000



      / CHEKMO II                                                        Page 43


 1958 03311  7200          CLA
 1959 03312  1135          TAD     MOB0
 1960 03313  7640          SZA CLA         /DO SE HAVE ANY RELIABLE INFORMATION AT HAND ALREADY?
 1961 03314  5342          JMP     MOBGE1  /YES. USE IT
 1962 03315  2150          ISZ     BOGUS   /NO. GET SOME NOW
 1963 03316  1106          TAD     GNCNT   /SAVE COUNTERS WE ARE ABOUT TO MODIFY
 1964 03317  4577          PUSH1
 1965 03320  1133          TAD     MOBMOD
 1966 03321  4577          PUSH1
 1967 03322  4765@         JMS     GNBMV   /DO A PSEUDO MOVE GENERATION
 1968 03323  1133          TAD     MOBMOD  /GET MOBILITY VALUE FOR BLACK
 1969 03324  3352          DCA     MOBGTM  /SAVE FOR THE MOMENT
 1970 03325  2150          ISZ     BOGUS
 1971 03326  4764@         JMS     GNWMV   /DO ANOTHER PSUEDO MOVE GENERATION
 1972 03327  1352          TAD     MOBGTM  /SUBTRACT BLACKS MOBILITY VALUE
 1973 03330  7041          CIA
 1974 03331  1133          TAD     MOBMOD  /FROM WHITES
 1975 03332  4771@         JMS     LCLRFX
 1976 03333  3352          DCA     MOBGTM  /STORE VALUE FOR THE MOMENT
 1977 03334  4576          POP1            /RESTORE THE COUNTERS THAT WE DESTROYED
 1978 03335  3133          DCA     MOBMOD
 1979 03336  4576          POP1
 1980 03337  3106          DCA     GNCNT
 1981 03340  1352          TAD     MOBGTM  /GET VALUE BACK AGAIN
 1982 03341  5710          JMP  I  MOBGET  /RETURN
 1983 03342  1133  MOBGE1, TAD     MOBMOD  /GET MOBILITY VALUE FOR THIS LEVEL
 1984 03343  7450          SNA             /IS THERE ONE FOR THIS LEVEL?
 1985 03344  1135          TAD     MOB0    /NO. USE THE ONE FOR 2 PLYS BACK
 1986 03345  7041          CIA
 1987 03346  1136          TAD     MOB1
 1988 03347  7041          CIA
 1989 03350  4770@         JMS     PLYFIX
 1990 03351  5710          JMP  I  MOBGET  /RETURN
 1991 03352  0000  MOBGTM, 0000
 1992              
      03364  2513
      03365  2535
      03366  0337
      03367  4600
      03370  4063
      03371  4066
      03372  4345
      03373  4316
      03374  4253
      03375  0001
      03376  7477
      03377  7700
 1993              PAGE
 1994              /THIS IS THE RECURSIVE LOOKAHEAD SUBROUTINE
 1995              /SEARCHES THE GAME TREE "DEPTH" PLYS DEEP. LOACTION "PLY"



      / CHEKMO II                                                        Page 44


 1996              /HOLDS THE CURRENT RECURSION LEVEL, OR DEPTH LEVEL OF THE SEARCH
 1997              /AND MUST BE SET TO = 0, BEFORE THIS ROUTINE IS CALLED FOR THE FIRST TIME
 1998              /SETTING "CVAL1" TO -3777 BEFORE CALLING THIS ROUTINE FOR THE FIRST TIME 
 1999              /IS ALSO NICE, TO PREVENT ALPHA-BETA PRUNING AT LEVEL #1
 2000              /THIS ROUTINE ASSUMES THAT THE COMPUTER HAS WHITE, BUT THE "LCLRFX" SUBROUTINE
 2001              /ALLOWS THE COMPUTER TO PLAY BLACK, BY SETING LOCATION "LCLRFX"+1 TO EQUAL
 2002              /A CIA INSTRUCTION
 2003 03400  0000  LOOKA,  0000
 2004 03401  7300          CLA CLL
 2005 03402  1200          TAD     LOOKA   /GET RETURN ADDRESS
 2006 03403  4577          PUSH1           /SAVE IT IN PDL#1
 2007 03404  2122          ISZ     PLY     /INC PLY NUMBER
 2008 03405  7240          CMA CLA         /-1 TO AC
 2009 03406  1122          TAD     PLY
 2010 03407  7640          SZA CLA         /IS THIS THE FIRST PLY?
 2011 03410  5222          JMP     LOOKA1  /NO
 2012 03411  1077          TAD     WHOSE   /YES. SETUP "LCLRFX"
 2013 03412  7700          SMA CLA         /WHICH COLOR ARE WE TO LOOK AHEAD ON BEHALF OF?
 2014 03413  1377          TAD     (NOP-CIA/WHITE
 2015 03414  1161          TAD     [CIA    /BLACK
 2016 03415  3776@         DCA     LCLRFX+1
 2017 03416  3133          DCA     MOBMOD  /INITIALIZE MOBILITY VALUES
 2018 03417  3135          DCA     MOB0
 2019 03420  3136          DCA     MOB1
 2020 03421  3143          DCA     ENO     /SET EVALUATION COUNTER TO 0
 2021 03422  1116  LOOKA1, TAD     UVAL1   /SAVE THE OLD "UPPER LEVEL VALUE"
 2022 03423  4577          PUSH1           /IN PDL#1
 2023 03424  1117          TAD     CVAL1   /THE OLD "CURRENT LEVEL VALUE"
 2024 03425  3116          DCA     UVAL1   /BECOMES THE NEW "UPPER LEVEL VALUE"
 2025 03426  1775@         TAD     PLYFIX+1        /SAVE PLY COMPENSATOR VALUE
 2026 03427  4577          PUSH1
 2027 03430  1106          TAD     GNCNT   /SAVE GENERATION COUNTER
 2028 03431  4577          PUSH1           /IN PDL#1
 2029 03432  1140          TAD     STRATG  /SAVE STRATEGIC VALUE
 2030 03433  4577          PUSH1
 2031 03434  3106          DCA     GNCNT   /CLEAR OUT GENERATION COUNTER, IN CASE NO MOVES ARE GENERATED
 2032 03435  1135          TAD     MOB0    /SAVE MOBILITY OF THE LEVEL 2 ABOVE THIS ONE
 2033 03436  4577          PUSH1
 2034 03437  1136          TAD     MOB1    /BUMP ALL THE LEVELS BY 1
 2035 03440  3135          DCA     MOB0
 2036 03441  1133          TAD     MOBMOD
 2037 03442  3136          DCA     MOB1
 2038 03443  3133          DCA     MOBMOD  /!!!BUG OF AUG 13 FIXED!!!/
 2039                      IFNZRO  DEBUG   <
 2040 03444  1142          TAD     PDLADR  /PUSH A MARKER SO THAT PDL#2 CAN BE VERIFIED
 2041 03445  4577          PUSH1
 2042 03446  1141          TAD     PC01    /PUSH A MARKER SO THAT PDL#1 CAN BE
 2043 03447  4577          PUSH1           /VERIFIED TO BE IN LINE
 2044              >
 2045 03450  1122          TAD     PLY     /BUILD A NEW PLY COMPENSATOR. FIRST GET PLY #



      / CHEKMO II                                                        Page 45


 2046 03451  7010          RAR             /EVEN/ODD BIT TO LINK
 2047 03452  7630          SZL CLA         /IS PLY #  EVEN ?
 2048 03453  1377          TAD     (NOP-CIA/NO. BUILD A NOP INSTRUCTION
 2049 03454  1161          TAD     [CIA
 2050 03455  3775@         DCA     PLYFIX+1
 2051 03456  1122          TAD     PLY     /PLY # TO AC
 2052 03457  7041          CIA             /COMPARE AGAINST
 2053 03460  1123          TAD     DEPTH   /THE MAXIMUM DEPTH
 2054 03461  7710          SPA CLA         /DOES CURRENT PLY# EXCCEDE THE MAX DEPTH #?
 2055 03462  5774@         JMP     LEVAL   /YES. DO A STATIC EVALUATION OF THE POSITION
 2056 03463  1373  LKFUR,  TAD     (-3777  /NO. BUILD A STARTING VALUE FOR THIS LEVEL
 2057 03464  4772@         JMS     PLYFIX
 2058 03465  3117          DCA     CVAL1   /INITIALIZE VALUE FOR THIS LEVEL
 2059 03466  4326          JMS     GNMVSM  /GENERATE THE MOVES OF THE SIDE WHOSE MOVE IT IS
 2060 03467  1112          TAD     CMSW    /GIT CHECKMATE SWITCH
 2061 03470  7640          SZA CLA         /IS SIDE TO MOVE IN CHECKMATE?
 2062 03471  5771@         JMP     LKCM    /YES. DO SOMTHING
 2063 03472  1113          TAD     SMSW    /GET STALEMATE SWITCH
 2064 03473  7640          SZA CLA         /IS THE SIDE TO MOVE IN STALEMATE?
 2065 03474  5770@         JMP     LKSM    /YES. DO SOMTHING
 2066 03475  4767@         JMS     PRUNE   /ONLY CONSIDER "GOOD" MOVES
 2067 03476  4572  PICK,   POP2            /POP A MOVE OUT OF PDL2
 2068 03477  3061          DCA     TOMAK2  /STORE THE MDW
 2069 03500  4572          POP2
 2070 03501  7450          SNA             /IS IT A MOVE OR THE END OF THE LIST?
 2071 03502  5766@         JMP     LKAD    /ITS THE END OF THE LIST.
 2072 03503  3060          DCA     TOMAK1  /ITS A MOVE--STORE THE MSW
 2073              IFNZRO  LPTREE  <
 2074 03504  1060          TAD     TOMAK1
 2075 03505  3111          DCA     IOMSW
 2076 03506  1061          TAD     TOMAK2
 2077 03507  3110          DCA     IOMDW
 2078 03510  4765@         JMS     OUTMV   /PRINT OUT THE MOVE
 2079 03511  4764@         JMS     SPACE   /ALSO A SPACE SO THAT THE NEXT TAB STOP IS REACHED
 2080              >
 2081 03512  4473          JMS  I  ZMKMV   /MAKE THE MOVE
 2082 03513  4515          JMS  I  ZLOOKA  /PEER FURTHER INTO THE MURKY DEPTHS OF THE GAME TREE
 2083                      IFNZRO  LPTREE<
 2084 03514  4430          JMS  I  ZCRLF   /PRINT A CARRIAGE RETURN
 2085              >
 2086 03515  4474          JMS  I  ZUNMV   /UNMAKE THE MOVE
 2087 03516  5763@         JMP     COMPMV  /GO DO A COMPARE
 2088              
 2089              /SUBROUTINE TO POP OUT A GROUP OF MOVES FROM PDP#2
 2090 03517  0000  POPOUT, 0000
 2091 03520  7200          CLA
 2092 03521  4572          POP2            /OUT MDW
 2093 03522  4572          POP2            /OUT MSW
 2094 03523  7640          SZA CLA         /IS IT AN MSW OR IS IT THE END  OF THE MOVES MARKER?
 2095 03524  5321          JMP     .-3     /IST AN MSW. GO POP OUT ANOTHER MOVE



      / CHEKMO II                                                        Page 46


 2096 03525  5717          JMP  I  POPOUT  /END. RETURN
 2097              
 2098              /SUBROUTINE TO GENERATE THE MOVES OF THE SIDE WHOSE TURN IT IS TO MOVE
 2099              /AS INDICATED BY THE "WHOSE" SWITCH
 2100              /RETURN WITH THE MOVES IN PDL#2, AND THE AC CLEARED
 2101 03526  0000  GNMVSM, 0000
 2102 03527  7200          CLA
 2103 03530  1077          TAD     WHOSE   /GET "WHOSE MOVE" SWITCH
 2104 03531  7700          SMA CLA         /IS IT WHITES MOVE?
 2105 03532  4762@         JMS     GNWMV   /YES. GENERATE WHITES MOVES
 2106 03533  1077          TAD     WHOSE
 2107 03534  7710          SPA CLA         /OR IS IT BLACKS MOVE?
 2108 03535  4761@         JMS     GNBMV   /YES. GENERATE BLACKS MOVES
 2109 03536  5726          JMP  I  GNMVSM  /RETURN
      03561  2535
      03562  2513
      03563  3600
      03564  5335
      03565  5600
      03566  4000
      03567  4123
      03570  4004
      03571  4051
      03572  4063
      03573  4001
      03574  4071
      03575  4064
      03576  4067
      03577  7737
 2110              PAGE
 2111              
 2112 03600  7200  COMPMV,        CLA
 2113              IFNZRO  LPTREE  <
 2114 03601  4777@         JMS     TABPLY  /TAB TO COLOMN "PLY"
 2115 03602  1120          TAD     RVAL1
 2116 03603  4776@         JMS     OCTOUT
 2117 03604  1117          TAD     CVAL1
 2118 03605  4776@         JMS     OCTOUT  /PRINT THE VALUE TO BEAT
 2119              >
 2120 03606  1120          TAD     RVAL1   /GET VALUE RETURNED
 2121 03607  4775@         JMS     PLYFIX  /FIX W/RESPECT TO PLY NUMBER
 2122 03610  3114          DCA     COMP    /LOAD SOFTWARE COMPARE REGISTER WITH IT
 2123 03611  1117          TAD     CVAL1   /GET CURRENT VALUE FOR THIS LEVEL
 2124 03612  4775@         JMS     PLYFIX  /FIX W/RESPECT TO PLY #
 2125 03613  4774@         JMS     COMPAR  /COMPARE IT WITH THE RETURNED VALUE NOW IN COMPARE REGISTER
 2126 03614  5246          JMP     JMPICK  /THEY ARE EQUAL:
 2127 03615  5246          JMP     JMPICK  /UNFAVORABLE COMPARE: GO ON TO NEXT MOVE
 2128 03616  1120  RPLACE, TAD     RVAL1   /HAIL NEW "BEST MOVE VALUE"
 2129 03617  3117          DCA     CVAL1   /STORE NEW "BEST MOVE VALUE"
 2130                      IFNZRO  LPTREE  <



      / CHEKMO II                                                        Page 47


 2131 03620  1373          TAD     ("*
 2132 03621  4426          JMS  I  ZOUT    /THE RETURN MOVE WON INDICATION
 2133              >
 2134 03622  4322          JMS     SETPNT
 2135 03623  1060          TAD     TOMAK1  /MSW
 2136 03624  3412          DCA  I  XR0     /INTO "BEST MOVE" TABLE
 2137 03625  1061          TAD     TOMAK2  /MDW
 2138 03626  3412          DCA  I  XR0     /INTO THE "BEST MOVE" TABLE
 2139              
 2140                                      /COMING UP IS THE "ALPHA BETA PRUNER"
 2141                                      /IT CHECKS IF THE NEW "BEST VALUE" FOR THIS LEVEL
 2142                                      /IS COMPETITIVE WITH THE "BEST VALUE" ON THE LEVEL ABOVE
 2143 03627  7200  ALPHAB, CLA
 2144 03630  1117          TAD     CVAL1   /GET CURRENT LEVEL VALUE
 2145 03631  4775@         JMS     PLYFIX  /COMPLIMENT IF THIS IS AN EVEN PLY
 2146 03632  3114          DCA     COMP    /LOAD COMPARE REGISTER WITH IT
 2147 03633  1116          TAD     UVAL1   /GET THE VALUE OF THE LEVEL ABOVE
 2148 03634  4775@         JMS     PLYFIX
 2149 03635  4774@         JMS     COMPAR  /COMPARE WITH THE CURRENT LEVEL VALUE IN THE COMPARE REGISTER
 2150 03636  5240          JMP     ALPHAP  /EQUAL MEANS PRUNE
 2151 03637  5246          JMP     JMPICK  /SORRY. THE VALUE WOULD STILL BE COMPETITIVE ON THE LEVEL ABOVE
 2152 03640  4772@ ALPHAP, JMS     POPOUT  /REMOVE ALL OTHER MOVES ON THIS LEVEL
 2153 03641  1122          TAD     PLY     /FOR DEBUG
 2154 03642  7300          CLA CLL
 2155                      IFNZRO  LPTREE<
 2156 03643  1371          TAD     ("!
 2157 03644  4426          JMS  I  ZOUT    /PRINT INDICATION FOR PRUNE
 2158              >
 2159 03645  5770@         JMP     LKAD    /YES. GO SET RETURN VALUE
 2160              
 2161              JMPICK, IFNZRO  LPTREE  <
 2162 03646  4430          JMS  I  ZCRLF   /CARRIAGE RETURN
 2163 03647  4777@         JMS     TABPLY  /TAD TO COLOMN # "PLY"
 2164              >
 2165 03650  7200          CLA
 2166 03651  5767@         JMP     PICK
 2167              
 2168 03652  0240  SAVBRD, ROOK
 2169 03653  0144          KNIGHT
 2170 03654  0152          BISHOP
 2171 03655  0440          QUEEN
 2172 03656  0740          KING
 2173 03657  0152          BISHOP
 2174 03660  0144          KNIGHT
 2175 03661  0240          ROOK
 2176 03662  0040          PAWN
 2177 03663  0040          PAWN
 2178 03664  0040          PAWN
 2179 03665  0040          PAWN
 2180 03666  0040          PAWN



      / CHEKMO II                                                        Page 48


 2181 03667  0040          PAWN
 2182 03670  0040          PAWN
 2183 03671  0040          PAWN
 2184 03672  0000  BESTBL, ZBLOCK  30      /TABLE TO HOLD THE LAST "BEST MOVE" ON ANY LEVEL
      03673  0000
      03674  0000
      03675  0000
      03676  0000
      03677  0000
      03700  0000
      03701  0000
      03702  0000
      03703  0000
      03704  0000
      03705  0000
      03706  0000
      03707  0000
      03710  0000
      03711  0000
      03712  0000
      03713  0000
      03714  0000
      03715  0000
      03716  0000
      03717  0000
      03720  0000
      03721  0000
 2185              
 2186              /SUBROUTINE TO SET AUTO-INDEX REG "XRO0" TO POINT TO
 2187              /THE WORD BEFORE THE 2WORD ENTRY IN THE "BESTBL" COROSPONDING WITH THIS PLY
 2188 03722  0000  SETPNT, 0000
 2189 03723  7200          CLA
 2190 03724  1122          TAD     PLY     /GET PLY #
 2191 03725  7104          CLL RAL         /MULT TIMES 2 WORDS IN EACH ENTRY
 2192 03726  1331          TAD     ADCON   /ADD IN ADDRESS CONSTANT
 2193 03727  3012          DCA     XR0     /STORE ADDR AS ADVERTISED
 2194 03730  5722          JMP  I  SETPNT  /RETURN
 2195 03731  3667  ADCON,  BESTBL-3
 2196 03732  7740          -PAWN
 2197 03733  7740          -PAWN
 2198 03734  7740          -PAWN
 2199 03735  7740          -PAWN
 2200 03736  7740          -PAWN
 2201 03737  7740          -PAWN
 2202 03740  7740          -PAWN
 2203 03741  7740          -PAWN
 2204 03742  7540          -ROOK
 2205 03743  7634          -KNIGHT
 2206 03744  7626          -BISHOP
 2207 03745  7340          -QUEEN



      / CHEKMO II                                                        Page 49


 2208 03746  7040          -KING
 2209 03747  7626          -BISHOP
 2210 03750  7634          -KNIGHT
 2211 03751  7540          -ROOK
 2212              
      03767  3476
      03770  4000
      03771  0241
      03772  3517
      03773  0252
      03774  3200
      03775  4063
      03776  5300
      03777  5347
 2213              PAGE
 2214              
 2215 04000  7200  LKAD,   CLA             /FINISHED GENERATING & EXPLORING MOVES ON THIS LEVEL
 2216 04001  1117          TAD     CVAL1   /SET RETURN VALUE = THIS LEVELS VALUE
 2217 04002  3120          DCA     RVAL1
 2218 04003  5211          JMP     DONE    /PREPARE TO RETURN
 2219              
 2220 04004  7200  LKSM,   CLA             /ITS A STALEMATE!
 2221                      IFNZRO  LPTREE<
 2222 04005  1377          TAD     ("=
 2223 04006  4426          JMS  I  ZOUT    /PRINTOUT STALEMATE INDICATION
 2224              >
 2225 04007  3120          DCA     RVAL1   /SET RETURN VALUE TO TOTALY EVEN GAME ( 0 )
 2226 04010  5260          JMP     LKXM    /TAKE SAME RETURN PATH AS A CHECKMATE NOW
 2227              
 2228              /COME HERE TO RETURN FROM THE "LOOKA" SUBROUTINE
 2229 04011  7240  DONE,   CLA CMA         /-1 TO AC
 2230 04012  1122          TAD     PLY     /DECREMENT PLY #
 2231 04013  3122          DCA     PLY
 2232 04014  1116          TAD     UVAL1   /RESTORE VARIOUS DATA TO ITS STATE BEFORE CALLING
 2233 04015  3117          DCA     CVAL1
 2234                      IFNZRO  DEBUG   <
 2235 04016  4576          POP1            /POP OUT PDL#1 VERIFIER WORD
 2236 04017  7041          CIA             /SHOULD BE SAME ON EXIT AS WAS ON ENTRY
 2237 04020  1141          TAD     PC01
 2238 04021  7440          SZA             /AFTER COMPLIMENTING, SHOULD BE 0. IS IT?
 2239 04022  7402          HLT             /NO. SURE GLAD I PUT THIS TEST IN!
 2240 04023  4576          POP1            /DO THE SAME THING FOR PDL#2
 2241 04024  7041          CIA
 2242 04025  1142          TAD     PDLADR
 2243 04026  7440          SZA             /IS PDL#2 IN LINE?
 2244 04027  7402          HLT             /NO. AMOUNT OFF IS IN THE AC
 2245              >
 2246 04030  1136          TAD     MOB1
 2247 04031  3133          DCA     MOBMOD  /RESTORE MOBMOD COUNTER
 2248 04032  1135          TAD     MOB0



      / CHEKMO II                                                        Page 50


 2249 04033  3136          DCA     MOB1
 2250 04034  4576          POP1
 2251 04035  3135          DCA     MOB0
 2252 04036  4576          POP1
 2253 04037  3140          DCA     STRATG  /RESTORE STRATEGIC VALUE
 2254 04040  4576          POP1
 2255 04041  3106          DCA     GNCNT   /RESTORE OLD MOVE GENERATION COUNTER
 2256 04042  4576          POP1            /POP OFF OLD PLY COMPENSATOR VALUE
 2257 04043  3264          DCA     PLYFIX+1        /RESTORE IT
 2258 04044  4576          POP1
 2259 04045  3116          DCA     UVAL1   /RESTORE "UPPER LEVEL VALUE"
 2260 04046  4576          POP1            /POP OFF RETURN ADDRESS
 2261 04047  3020          DCA     TEMP    /RESTORE IT
 2262 04050  5420          JMP  I  TEMP    /RETURN FROM "LOOKA" SUBROUTINE
 2263              
 2264 04051  7200  LKCM,  CLA             /ITS A CHECKMATE.
 2265                      IFNZRO  LPTREE<
 2266 04052  1376          TAD     ("+
 2267 04053  4426          JMS  I  ZOUT    /PRINT CHECKMATE INDICATION
 2268              >
 2269 04054  1122          TAD     PLY     /SUBTRACT PLY # FROM
 2270 04055  1375          TAD     (-3740  /VALUE FOR RETURN VALUE
 2271 04056  4263          JMS     PLYFIX  /RETURN VALUE IS POSITIVE IF THIS IS AN EVEN PLY
 2272 04057  3120          DCA     RVAL1
 2273 04060  4572  LKXM,   POP2            /POP THE 2 MARKER WORDS OFF OF PDL2
 2274 04061  4572          POP2            /THAT "GNMV" PUT THERE
 2275 04062  5211          JMP     DONE    /READY TO RETURN
 2276              
 2277              /COLOR FIXING SUBROUTINE EXCLUSIVLY FOR THE "LOOKA" SUBROUTINE.
 2278              /FIXES COLOR WITH RESPECT TO PLY EVEN/ODD
 2279 04063  0000  PLYFIX, 0000
 2280 04064  7041          CIA             /=NOP IF PLY IS ODD, OR TO = CIA IF PLY IS EVEN
 2281 04065  5663          JMP  I  PLYFIX  /RETURN
 2282              
 2283              /GENERAL PURPOSE COLOR FIXING ROUTINE
 2284              /SET "LCLRFX"+1 ONLY ONCE A PROGRAM INITIALIZATION TIME. SET IT TO
 2285              /EQUAL A "NOP" INSTRUCTION IF THE COMPUTER HAS WHITE, SET IT TO A
 2286              /"CIA" INSTRUSTION IF THE COMPUTER HAS BLACK
 2287 04066  0000  LCLRFX, 0000
 2288 04067  7000          NOP             /COMPUTER HAS: WHITE="NOP", BLACK="CIA"
 2289 04070  5666          JMP  I  LCLRFX  /RETURN
 2290              
 2291              /STATIC EVALUATION ROUTINE
 2292 04071  7300  LEVAL,  CLA CLL
 2293 04072  4475          JMS  I  ZMAPEC  /MAP PIECES
 2294 04073  1077          TAD     WHOSE   /GET "WHOSE MOVE SWITCH"
 2295 04074  7700          SMA CLA         /IS IT WHITES OR BLACKS?
 2296 04075  5301          JMP     .+4     /WHITES
 2297 04076  1066          TAD     BKING   /BLACKS. GET BLACKS KING ADDRESS
 2298 04077  4774@         JMS     TSTWAT  /FIND OUT IF IT IS ATTACKED



      / CHEKMO II                                                        Page 51


 2299 04100  5303          JMP     .+3
 2300 04101  1065          TAD     WKING   /GET WHITES KINGS ADDRESS
 2301 04102  4773@         JMS     TSTBAT  /FIND OUT IF IT IS ATTACKED
 2302 04103  1100          TAD     PCNT    /GET # OF ATTACKERS
 2303 04104  7640          SZA CLA         /IS THE KING IN CHECK?
 2304 04105  5772@         JMP     LKFUR   /YES. LOOK AHEAD 1 MORE MOVE
 2305              IFNZRO  LPTREE  <
 2306 04106  1371          TAD     ("#
 2307 04107  4426          JMS  I  ZOUT    /PRINT EVALUATION INDICATOR
 2308 04110  2143          ISZ     ENO     /INC EVALUATION #
 2309 04111  1143          TAD     ENO     /FIND OUT IF IT IS OF SPECIAL INTREST
 2310 04112  7041          CIA             /BY TESTING TO SE IF IT IS THE SAME
 2311 04113  1144          TAD     ENOB    /AS "ENOB"
 2312 04114  7650          SNA CLA         /IS IT?
 2313 04115  7000          NOP             /YES. A BREAKPOINT FOR ODT MAY BE PLACED HERE
 2314 04116  1143          TAD     ENO     /PRINT OUT THE EVALUATION #
 2315 04117  4770@         JMS     OCTNFM
 2316              >
 2317 04120  4767@         JMS     EVAL    /GET AN EVALUATION
 2318 04121  3120          DCA     RVAL1   /SETUP RETURN VALUE
 2319 04122  5211          JMP     DONE    /READY TO RETURN
 2320              
 2321              
 2322              /SUBROUTINE TO PRUNE UNDESIRABLE MOVES OUT OF THE TREE BEFORE THEY CREATE
 2323              /HUGE BRANCHES. WHAT TYPES OF MOVES ARE DESIRABLE AND UNDESIRABLE AT ANY GIVEN
 2324              /PLY, IS DETERMINED BY THE TABLE AT LOCATION "PRNPRO"
 2325              /THIS ROUTINE SHOULD SET "PRNCNT" TO THE NUMBER OF MOVES PRUNED
 2326 04123  0000  PRUNE,  0000
 2327 04124  7200          CLA
 2328 04125  3766@         DCA     PRNCNT  /INIT PRUNED MOVE COUNTER TO 0
 2329 04126  1765@         TAD     GNCHEK  /GET # OF CHECKS ON THE KING
 2330 04127  7440          SZA             /IS THE KING IN CHECK?
 2331 04130  5723          JMP  I  PRUNE   /NO. DONT PRUNE ANY MOVES
 2332 04131  4764@         JMS     PLYCHP  /GET PLY #
 2333 04132  1363          TAD     (JMP  I .+3     /BUILD A JMP I  TO THE PROPER PRUNE PROCEDURE
 2334 04133  3334          DCA     .+1     /PUT THE JMP I  DOWN SO THAT IT MAY BE EXECUTED
 2335 04134  7402          HLT             /JMP GOES HERE
 2336              
 2337 04135  4145  PRNPRO, PPA             /PRUNE PROCEDURE FOR PLY 1
 2338 04136  4147          PPB             /PRUNE PROCEDURE FOR PLY 2
 2339 04137  4147          PPB             /PRUNE PROCEDURE FOR PLY 3
 2340 04140  4147          PPB             /PRUNE PROCEDURE FOR PLY 4 
 2341 04141  4147          PPB             /PRUNE PROCEDURE FOR PLY 5 
 2342 04142  4147          PPB             /PRUNE PROCEDURE FOR PLY 6 
 2343 04143  4147          PPB             /PRUNE PROCEDURE FOR PLY 7 
 2344 04144  4147          PPB             /PRUNE PROCEDURE FOR PLY 8 OR GREATER
 2345              
 2346 04145  4762@ PPA,    JMS     BSTOP   /COUNT ON A "PRE-ANALYSIS"
 2347 04146  5723  PPZ,    JMP  I  PRUNE   /RETURN
 2348              



      / CHEKMO II                                                        Page 52


 2349 04147  4761@ PPB,    JMS     HIEP    /FIND OUT THE VALUE OF THE MOST FAVORABLE EN PRISE PIECE CAPTURE
 2350 04150  7650          SNA CLA         /DOES A FAVORABLE ONE EXIST?
 2351 04151  5355          JMP     .+4     /NO. COUNT ON THE ENTRY IN "BESTBL"
 2352 04152  4760@         JMS     SETPNT  /YES. SETUP POINTER FOR THE INSERTION
 2353 04153  1757@         TAD     HIEPMS  /OF THE EN PRISE PIECE CAPTURE MSW
 2354 04154  3412          DCA  I  XR0     /INTO THE "BESTBL"
 2355 04155  4762@         JMS     BSTOP   /IF IT EXISTS, BSTOP WILL INSURE THAT IT IS LOOKED AT FIRST
 2356 04156  5723          JMP  I  PRUNE   /RETURN
      04157  4702
      04160  3722
      04161  4600
      04162  4200
      04163  5735
      04164  3146
      04165  0513
      04166  3247
      04167  3250
      04170  5315
      04171  0243
      04172  3463
      04173  2612
      04174  2600
      04175  4040
      04176  0253
      04177  0275
 2357              PAGE
 2358              /SUBROUTINE TO SCAN THROUGH THE LAST BUNCH OF MOVES IN PDL#2
 2359              /IF A MOVE EXISTS, WHICH HAS THE SAME MSW AS THE LAST "BEST MOVE"
 2360              /ON THIS PLY, THAT MOVE IS SWAPED WITH THE MOVE ON THE TOP OF THE LIST
 2361 04200  0000  BSTOP,  0000
 2362 04201  4777@         JMS     SETPNT
 2363 04202  1412          TAD  I  XR0
 2364 04203  7041          CIA
 2365 04204  3022          DCA     TEMP2
 2366 04205  1106          TAD     GNCNT
 2367 04206  7041          CIA
 2368 04207  1776@         TAD     PRNCNT
 2369 04210  7450          SNA             /ANY MOVES TO RUMMAGE THRU?
 2370 04211  5600          JMP  I  BSTOP   /NO. RETURN
 2371 04212  3020          DCA     TEMP    /SETUP COUNT
 2372 04213  1020          TAD     TEMP
 2373 04214  7104          CLL RAL         /MULT TIMES 2 WORDS PER MOVE
 2374 04215  1142          TAD     PDLADR
 2375 04216  3021          DCA     TEMP1
 2376 04217  1421  BSTOP1, TAD  I  TEMP1   /GET AN MSW
 2377                      IFNZRO  DEBUG   <
 2378 04220  7450          SNA             /DOES IT LOOK LIKE AN MSW
 2379 04221  7402          HLT             /NOT IF ITS 0 IT DOESNT
 2380              >
 2381 04222  1022          TAD     TEMP2



      / CHEKMO II                                                        Page 53


 2382 04223  7650          SNA CLA         /IS IT A MATCH?
 2383 04224  5232          JMP     BSTOP2  /YES!! GO SWAP IT WITH THE MOVE ON TOP
 2384 04225  2021          ISZ     TEMP1   /BUMP POINTER BY 2 TO POINT TO THE NEXT MSW
 2385 04226  2021          ISZ     TEMP1
 2386 04227  2020          ISZ     TEMP    /COMPARED AGAINST ALL MOVES?
 2387 04230  5217          JMP     BSTOP1  /NO. DO ANOTHER
 2388 04231  5600          JMP  I  BSTOP   /YES. RETURN
 2389 04232  1142  BSTOP2, TAD     PDLADR
 2390 04233  1375          TAD     (-2
 2391 04234  3020          DCA     TEMP
 2392 04235  1420          TAD  I  TEMP
 2393 04236  3421          DCA  I  TEMP1
 2394 04237  1022          TAD     TEMP2
 2395 04240  7041          CIA
 2396 04241  3420          DCA  I  TEMP
 2397 04242  2020          ISZ     TEMP
 2398 04243  2021          ISZ     TEMP1
 2399 04244  1421          TAD  I  TEMP1
 2400 04245  3012          DCA     XR0
 2401 04246  1420          TAD  I  TEMP
 2402 04247  3421          DCA  I  TEMP1
 2403 04250  1012          TAD     XR0
 2404 04251  3420          DCA  I  TEMP
 2405 04252  5600          JMP  I  BSTOP
 2406              
 2407              
 2408              /SUBROUTINE TO EVALUATE THE BACK RANK
 2409              /TO FIND OUT WHAT'S NOT DEVELOPED, AND RETURN A VALUE FOR DEVELOPMENT
 2410 04253  0000  BREV,   0000
 2411 04254  7200          CLA
 2412 04255  1374          TAD     (NOP
 2413 04256  3301          DCA     BREV2   /SETUP TO DO THE WHITE SIDE FIRST
 2414 04257  4272          JMS     BREV1   /DO AN EVALUATION
 2415 04260  7041          CIA             /NEGATE THE VALUE FOR WHITES SIDE
 2416 04261  1140          TAD     STRATG
 2417 04262  3140          DCA     STRATG
 2418 04263  1161          TAD     [CIA
 2419 04264  3301          DCA     BREV2   /SETUP TO DO THE BLACK SIDE
 2420 04265  1373          TAD     (70     /RANK 8
 2421 04266  4272          JMS     BREV1   /DO THE BLACK EVALUATION
 2422 04267  1140          TAD     STRATG
 2423 04270  3140          DCA     STRATG
 2424 04271  5653          JMP  I  BREV    /RETURN WITH IT
 2425              
 2426 04272  0000  BREV1,  0000
 2427 04273  1372          TAD     (BOARD-1/CONSTANT FOR BOARD ADDRESS
 2428 04274  3013          DCA     ITMP0
 2429 04275  3022          DCA     TEMP2   /INIT MINOR PIECE COUNTER
 2430 04276  1164          TAD     [7770   /COUNT FOR 10 SQUARES ON THE BACK RANK
 2431 04277  3021          DCA     TEMP1



      / CHEKMO II                                                        Page 54


 2432 04300  1413          TAD  I  ITMP0   /GET THE PIECES VALUE
 2433 04301  7402  BREV2,  HLT             /COMPLIMENT IT IF IT IS BLACK
 2434 04302  1371          TAD     (-KNIGHT
 2435 04303  7450          SNA             /IS IT A KNIGHT?
 2436 04304  2022          ISZ     TEMP2   /YES. INC MINOR PIECE COUNTER
 2437 04305  1370          TAD     (KNIGHT-BISHOP
 2438 04306  7650          SNA CLA         /IS IT A BISHOP?
 2439 04307  2022          ISZ     TEMP2   /YES. INC MINOR PIECE COUNTER
 2440 04310  2021          ISZ     TEMP1   /DONE ALL 8 SQUARES YET?
 2441 04311  5300          JMP     BREV2-1 /NO. GO BACK AND DO ANOTHER
 2442 04312  1022          TAD     TEMP2   /ADD IN # OF MINOR PIECES
 2443 04313  7104          RAL CLL         /MULT TIMES 2
 2444 04314  7104          RAL CLL         /MULT TIMES 2 AGAIN (2*2=4)
 2445 04315  5672          JMP  I  BREV1   /RETURN WITH RANK EVALUATION IN THE AC
 2446              /
 2447              /CENTER OCCUPATION EVALUATOR
 2448 04316  0000  COEV,   0000
 2449 04317  7200          CLA
 2450 04320  1367          TAD     (-4     /SETUP COUNT FOR 4 CENTER SQUARES
 2451 04321  3021          DCA     TEMP1
 2452 04322  1366          TAD     (TAD  I  COTB   /SETUP TO ACCESS ADDRESSES OF THE 4 CENTER SQUARES
 2453 04323  3324          DCA     COEV1
 2454 04324  7402  COEV1,  HLT             /GET SQUARES VALUE
 2455 04325  7450          SNA             /IS IT OCCUPIED
 2456 04326  5334          JMP     COEV2   /NO. TEST TO SEE IF DONE
 2457 04327  7700          SMA CLA         /IS IT A WHITE PIECE?
 2458 04330  1365          TAD     (10     /VALUE WILL BE +4
 2459 04331  1367          TAD     (-4     /OR -4 IF IT IS BLACK
 2460 04332  1140          TAD     STRATG  /ADD TO THE CENTER OCCUPATION VALUE
 2461 04333  3140          DCA     STRATG
 2462 04334  2324  COEV2,  ISZ     COEV1   /INC INSTRUCTION SO THAT IT REFFRENCES THE NEXT CENTER SQUARE
 2463 04335  2021          ISZ     TEMP1   /DONE ALL 4 SQUARES YET?
 2464 04336  5324          JMP     COEV1   /NO. DO ANOTHER
 2465 04337  1020          TAD     TEMP    /YES. GET FINAL VALUE
 2466 04340  5716          JMP  I  COEV    /AND RETURN
 2467              
 2468              /ADDRESSES OF THE 4 CENTER SQUARES
 2469 04341  7533  COTB,   BOARD+33
 2470 04342  7534          BOARD+34
 2471 04343  7543          BOARD+43
 2472 04344  7544          BOARD+44
 2473              
 2474              /CASTLING STATUS EVALUATOR
 2475 04345  0000  CASTEV, 0000
 2476 04346  7200          CLA
 2477 04347  1053          TAD     WPSW
 2478 04350  7010          RAR             /MOVE "CASTLED BIT" INTO LINK
 2479 04351  7630          SZL CLA         /HAS WHITE CASTLED?
 2480 04352  1365          TAD     (10     /YES ADD TO STRATEGIC VALUE
 2481 04353  1140          TAD     STRATG



      / CHEKMO II                                                        Page 55


 2482 04354  3140          DCA     STRATG
 2483 04355  1054          TAD     BPSW
 2484 04356  7010          RAR             /MOVE "CASTLED BIT" TO THE LINK
 2485 04357  7630          SZL CLA         /HAS BLACK CASTLED YET?
 2486 04360  1164          TAD     [7770   /YES. SUBTRACT POINTS FROM THE STRATEGIC VALUE
 2487 04361  1140          TAD     STRATG
 2488 04362  3140          DCA     STRATG
 2489 04363  5745          JMP  I  CASTEV  /RETURN
 2490              
      04365  0010
      04366  1741
      04367  7774
      04370  7772
      04371  7634
      04372  7477
      04373  0070
      04374  7000
      04375  7776
      04376  3247
      04377  3722
 2491              PAGE
 2492              /SUBROUTINE TO TEST IF A PIECE IS EN PRISE
 2493              /CALL WITH THE ADDRESS OF THE SQUARE TO BE TESTED IN THE AC
 2494              /IF THE PIECE IS EN PRISE, RETURN WITH THE PREDICTED EXCHANGE
 2495              /LOSS IN THE AC, IF NOT 0 IS RETURNED
 2496              /THE ADDRESS OF THE SQUARE IS RETURNED IN "ENPRAD"
 2497              /RETURN WITH ADDR OF ATTACKER IN "ENPSQR"
 2498              /RETURN WITH ADDR OF THE LEAST VALUABLE DEFENDER IN "PSQR"
 2499              /RETURN WITH THE # OF ATTACKERS IN "ENPCNT"
 2500              /RETURN WITH THE # OF DEFENDERS IN "PCNT"
 2501 04400  0000  ENPRIS, 0000
 2502 04401  3311          DCA     ENPRAD  /SAVE ADDR OF EN PRIS SQUARE
 2503 04402  4475          JMS  I  ZMAPEC  /MAKE SURE PIECE MAP IS UP TO DATE
 2504 04403  1711          TAD  I  ENPRAD
 2505 04404  7450          SNA             /IS THERE A PIECE ON IT?
 2506 04405  5600          JMP  I  ENPRIS  /NO. IDIOT! CONSIDER YOURSELF SAVED
 2507 04406  7700          SMA CLA         /YES. IS IT WHITE OR BLACK?
 2508 04407  5225          JMP     ENPRWH  /ITS WHITE
 2509 04410  1311          TAD     ENPRAD  /BLACK. FIND OUT ABOUT WHITES ATTACKS
 2510 04411  4777@         JMS     TSTWAT
 2511 04412  1101          TAD     PVAL
 2512 04413  3312          DCA     ENPVAL  /SAVE VALUE OF SMALEST ATTACKER
 2513 04414  1100          TAD     PCNT
 2514 04415  7450          SNA             /ANY ATTACKERS?
 2515 04416  5600          JMP  I  ENPRIS  /NO.RETURN
 2516 04417  3314          DCA     ENPCNT  /SAVE # OF ATTACKERS
 2517 04420  1102          TAD     PSQR
 2518 04421  3313          DCA     ENPSQR  /SAVE ADDR OF LEAST VALUABLE ATTACKER
 2519 04422  1311          TAD     ENPRAD  /FIND OUT ABOUT DEFENDERS NOW
 2520 04423  4776@         JMS     TSTBAT



      / CHEKMO II                                                        Page 56


 2521 04424  5245          JMP     ENPR0   /ALL DONE SETTING UP. GO TO THE BUISINESS PART
 2522 04425  1311  ENPRWH, TAD     ENPRAD  /FIND OUT ABOUT BLACK ATTACKS
 2523 04426  4776@         JMS     TSTBAT
 2524 04427  1101          TAD     PVAL
 2525 04430  7041          CIA
 2526 04431  3312          DCA     ENPVAL  /SAVE VALUE OF LEAST VALUABLE ATTACKER
 2527 04432  1102          TAD     PSQR
 2528 04433  3313          DCA     ENPSQR  /SAVE ADDR OF LEAST VALUABLE ATTACKER
 2529 04434  1100          TAD     PCNT
 2530 04435  7450          SNA             /ANY ATTACKERS?
 2531 04436  5600          JMP  I  ENPRIS  /NO. RETURN
 2532 04437  3314          DCA     ENPCNT  /STORE # OF ATTACKERS
 2533 04440  1311          TAD     ENPRAD  /FIND OUT ABOUT WHITES DEFENCE
 2534 04441  4777@         JMS     TSTWAT
 2535 04442  1101          TAD     PVAL
 2536 04443  7041          CIA             /COMPLIMENT VALUE OF LEAST VALUABLE DEFENDER
 2537 04444  3101          DCA     PVAL
 2538 04445  1314  ENPR0,  TAD     ENPCNT  /GET # OF ATTACKERS
 2539 04446  7041          CIA
 2540 04447  1100          TAD     PCNT    /COMPARE WITH # OF DEFENDERS
 2541 04450  7700          SMA CLA         /MORE ATTACKERS THAN DEFENDERS?
 2542 04451  5300          JMP     ENPR1   /NO.
 2543 04452  1100          TAD     PCNT    /# OF DEFENDERS
 2544 04453  7110          CLL RAR
 2545 04454  7640          SZA CLA         /MORE THAN 1 DEFENDER?
 2546 04455  5300          JMP     ENPR1   /YES. TOO COMPLICATED TO PREDICT THE SWAP ALL THE WAY DOWN
 2547 04456  7620          SNL CLA         /NO. ARE THERE ANY DEFENDERS AT ALL?
 2548 04457  5275          JMP     ENPR2   /NO. ITS EN PRISE ALL RIGHT
 2549 04460  1711          TAD  I  ENPRAD  /YES. ITS EXACTLY 1 DEFENDER
 2550 04461  4775@         JMS     CLRFIX
 2551 04462  1101          TAD     PVAL    /ADD VALUE OF DEFENDER PLUS OBJECT
 2552 04463  1312          TAD     ENPVAL  /COMPARE WITH THE ATTACKERS VALUE
 2553 04464  7700          SMA CLA         /IS ATTACKER SMALLER THAN DEFENDER PLUS OBJECT?
 2554 04465  5305          JMP     ENPR3   /NO. THE OBJECT IS NOT EN PRISE
 2555 04466  1101          TAD     PVAL    /-D
 2556 04467  1312          TAD     ENPVAL  /+A
 2557 04470  7750          SPA SNA CLA     /IS DEFENDER SMALLER THAN ATTACKER?
 2558 04471  5275          JMP     ENPR2   /NO. HE WONT CAPTURE BACK THEN
 2559 04472  1101          TAD     PVAL    /YES
 2560 04473  1312          TAD     ENPVAL
 2561 04474  4775@         JMS     CLRFIX
 2562 04475  1711  ENPR2,  TAD  I  ENPRAD
 2563 04476  7041          CIA
 2564 04477  5600          JMP  I  ENPRIS  /RETURN
 2565 04500  7200  ENPR1,  CLA
 2566 04501  1711          TAD  I  ENPRAD  /COMPARE VALUE OF OBJECT
 2567 04502  4775@         JMS     CLRFIX
 2568 04503  1312          TAD     ENPVAL  /WITH THE VALUE OF THE ATTACKER
 2569 04504  7500          SMA             /IS THE ATTACKERS VALUE SMALLER?
 2570 04505  7200  ENPR3,  CLA             /NO. PIECE IS NOT EN PRISE



      / CHEKMO II                                                        Page 57


 2571 04506  7041          CIA
 2572 04507  4775@         JMS     CLRFIX
 2573 04510  5600          JMP  I  ENPRIS  /RETURN
 2574 04511  0000  ENPRAD, 0000
 2575 04512  0000  ENPVAL, 0000
 2576 04513  0000  ENPSQR, 0000
 2577 04514  0000  ENPCNT, 0000
 2578                      IFNZRO DEBUG<
 2579              /TEST OF THE "ENPRIS" ROUTINE
 2580 04515  4774@ TESTEP, JMS     INPUT
 2581 04516  4475          JMS  I  ZMAPEC
 2582 04517  1163          TAD     [BOARD
 2583 04520  3341          DCA     TSTTMP
 2584 04521  1373          TAD     (7700
 2585 04522  3342          DCA     TSTCNT
 2586 04523  1341  TEP2,   TAD     TSTTMP
 2587 04524  4200          JMS     ENPRIS
 2588 04525  7450          SNA             /IS IT EN PRIS?
 2589 04526  5334          JMP     TEP1    /NO
 2590 04527  4772@         JMS     OCTOUT
 2591 04530  4771@         JMS     SPACE
 2592 04531  1341          TAD     TSTTMP
 2593 04532  4770@         JMS     OUTSQR
 2594 04533  4430          JMS  I  ZCRLF
 2595 04534  2341  TEP1,   ISZ     TSTTMP
 2596 04535  2342          ISZ     TSTCNT
 2597 04536  5323          JMP     TEP2
 2598 04537  7402          HLT
 2599 04540  5315          JMP     TESTEP
 2600 04541  0000  TSTTMP, 0000
 2601 04542  0000  TSTCNT, 0000
 2602              >
      04570  5650
      04571  5335
      04572  5300
      04573  7700
      04574  6200
      04575  1410
      04576  2612
      04577  2600
 2603              PAGE
 2604              /SUBROUTINE TO RETURN THE EXCHANGE VALUE OF THE HIGHEST EN PRISE
 2605              /PIECE THAT CAN BE TAKEN BY THE SIDE TO MOVE
 2606              /ADDED IN WITH THE VALUE IS A 10 POINT "PENALTY" FOR EACH ADDITIONAL EN PRISE PIECE
 2607              /THAT CAN BE TAKEN
 2608              /THE VALUE IS RETURNED IN SUCH A WAY THAT IT CAN SIMPLY BE ADDED
 2609              /TO THE  EVALUATION
 2610              /CALL WITH AC CLEAR TO USE NORMALY
 2611              /THIS ROUTINE CALCULATES WHOSE MOVE IT IS BY EXAMINING LOCATION "WHOSE"
 2612 04600  0000  HIEP,   0000



      / CHEKMO II                                                        Page 58


 2613 04601  7200          CLA
 2614 04602  1077          TAD     WHOSE
 2615 04603  7710          SPA CLA         /IS IT WHITES MOVE OR BLACKS?
 2616 04604  1377          TAD     (NOP-CIA        /BLACKS - SET "HIEPX"=NOP
 2617 04605  1161          TAD     [CIA    /WHITES - SET "HIEPX"=CIA
 2618 04606  3275          DCA     HIEPX   /SEE
 2619 04607  3277          DCA     HIEPVL  /INIT VALUE TO 0
 2620 04610  3301          DCA     HIEPCN  /INIT COUNT TO 0
 2621 04611  4475          JMS  I  ZMAPEC  /MAKE SURE THE PIECE MAP IS UP TO DATE
 2622 04612  1376          TAD     (-12
 2623 04613  4274          JMS     HIEPFX
 2624 04614  1375          TAD     (MAP+12 /BUILD THE ADDR OF THE PIECE MAP(WHICHEVER ONE IT IS)
 2625 04615  3303          DCA     HMAPAD
 2626 04616  7200  HIEP1,  CLA
 2627 04617  1703          TAD  I  HMAPAD  /GET PIECE ADDR
 2628 04620  2303          ISZ     HMAPAD  /INC MAP ADDRESS POINTER
 2629 04621  7450          SNA             /DONE ALL PIECES YET?
 2630 04622  5262          JMP     HIEP2   /YES
 2631 04623  3300          DCA     HIEPTM  /STORE ADDR FOR THE MOMENT
 2632 04624  1700          TAD  I  HIEPTM  /GET THE PIECES VALUE
 2633 04625  4274          JMS     HIEPFX
 2634 04626  1374          TAD     (-KING  /COMPARE IT WITH THAT OF A KING
 2635 04627  7650          SNA CLA         /IS IT A KING?
 2636 04630  5216          JMP     HIEP1   /YES. KINGS CANT BE SWAPED ANYWAYS
 2637 04631  1300          TAD     HIEPTM  /NO. GET THE PIECES ADDR
 2638 04632  4773@         JMS     ENPRIS  /FIND OUT IF IT IS ENPRIS
 2639 04633  7450          SNA             /IS IT?
 2640 04634  5216          JMP     HIEP1   /NO. TRY THE NEXT ONE
 2641 04635  3300          DCA     HIEPTM  /YES. SAVE THE EXCHANGE VALUE
 2642 04636  2301          ISZ     HIEPCN  /INC EN PRIS PIECE COUNTER
 2643 04637  1277          TAD     HIEPVL  /GET BEST VALUE SO FAR
 2644 04640  7041          CIA
 2645 04641  1300          TAD     HIEPTM  /COMPARE IT WITH THE ONE JUST AQUIRED
 2646 04642  4274          JMS     HIEPFX
 2647 04643  7700          SMA CLA         /IS THE ONE WE JUST GOT BIGGER?
 2648 04644  5216          JMP     HIEP1   /NO. GO TRY ANOTHER PIECE
 2649 04645  1300          TAD     HIEPTM  /YES.MAKE THE ONE WE JUST GOT THE NEW VALUE TO BEAT
 2650 04646  3277          DCA     HIEPVL
 2651 04647  1772@         TAD     ENPSQR  /BUILD MSW FOR THE MOVE TO CAPTURE THIS EN PRISE PIECE
 2652 04650  0167          AND     [0077   /"FROM SQUARE" IS THAT OF THE
 2653 04651  7106          RTL CLL         /LEAST VALUABLE ATTACKER
 2654 04652  7006          RTL
 2655 04653  7006          RTL
 2656 04654  3300          DCA     HIEPTM
 2657 04655  1771@         TAD     ENPRAD  /"TO SQUARE" IS THAT OF THE PIECE ITSELF
 2658 04656  0167          AND     [0077
 2659 04657  1300          TAD     HIEPTM  /COMBINE "TO" AND "FROM" 6BIT ADDRESSES
 2660 04660  3302          DCA     HIEPMS  /INTO ONE CONVIENIENT MSW
 2661 04661  5216          JMP     HIEP1   /GO TRY ANOTHER PIECE
 2662 04662  7240  HIEP2,  CLA CMA



      / CHEKMO II                                                        Page 59


 2663 04663  1301          TAD     HIEPCN  /GET # OF EN PRISE PIECES
 2664 04664  7510          SPA             /WERE THERE ANY?
 2665 04665  7200          CLA             /NO
 2666 04666  7106          CLL RTL
 2667 04667  7004          RAL             /MULT TIMES 8 AND INCLUDE IN THE VALUE RETURNED
 2668 04670  7041          CIA
 2669 04671  4274          JMS     HIEPFX
 2670 04672  1277          TAD     HIEPVL  /GET THE EXCHANGE VALUE
 2671 04673  5600          JMP  I  HIEP    /RETURN
 2672              
 2673 04674  0000  HIEPFX, 0000
 2674 04675  7402  HIEPX,  HLT             /NOP,BLACKS MOVE/CIA,WHITES MOVE
 2675 04676  5674          JMP  I  HIEPFX
 2676              
 2677 04677  0000  HIEPVL, 0000
 2678 04700  0000  HIEPTM, 0000
 2679 04701  0000  HIEPCN, 0000
 2680 04702  0000  HIEPMS, 0000
 2681 04703  0000  HMAPAD, 0000
 2682              
 2683              
 2684              /SUBROUTINE TO SETUP THE BOARD
 2685 04704  0000  SETBRD, 0000
 2686 04705  7300          CLA CLL
 2687 04706  1370          TAD     (-100   /IST PUT ALL OF THE PIECES ON THE BOARD
 2688 04707  3020          DCA     TEMP    /SETUP A COUNT FOR 64 SQUARES
 2689 04710  1367          TAD     (BOARD-1
 2690 04711  3013          DCA     ITMP0   /BOARD ADDRESS TO AUTO INDEX REG
 2691 04712  1366          TAD     (SAVBRD-1
 2692 04713  3014          DCA     ITMP1   /SAVED BOARD ADDRESS TO AUTO-INDEX REG
 2693 04714  1414          TAD  I  ITMP1   /MOVE FROM THE SAVED BOARD AREA
 2694 04715  3413          DCA  I  ITMP0   /TO THE WORKING AREA
 2695 04716  2020          ISZ     TEMP    /DONE 64 SQUARES YET?
 2696 04717  5314          JMP     .-3     /NO. DO MORE
 2697 04720  1365          TAD     (-40    /NOW CLEAR OUT THE MIDDLE
 2698 04721  3020          DCA     TEMP
 2699 04722  1364          TAD     (BOARD+17
 2700 04723  3014          DCA     ITMP1
 2701 04724  3414          DCA  I  ITMP1
 2702 04725  2020          ISZ     TEMP    /CLEARED OUT 32 SQUARES YET?
 2703 04726  5324          JMP     .-2     /NO. DO 1 MORE
 2704 04727  3071          DCA     LSTMV
 2705 04730  3053          DCA     WPSW    /ENABLE CASTLING BY WHITE
 2706 04731  3054          DCA     BPSW    /AND BY BLACK
 2707 04732  3076          DCA     PW      /INITIALIZE TOTAL PIECE VALUE
 2708 04733  5704          JMP  I  SETBRD  /RETURN
 2709              
 2710 04734  7001  COMTM,  IAC             /TOURNAMENT MODE SETTING
 2711 04735  7001          IAC
 2712 04736  7001  COMBM,  IAC             /BLITZ MODE SETTING



      / CHEKMO II                                                        Page 60


 2713 04737  3123          DCA     DEPTH   /DEPTH=3 FOR TOURNAMENT MODE, DEPTH=1 FOR BLITZ MODE
 2714 04740  5763@         JMP     COMMAN
 2715              
      04763  0212
      04764  7517
      04765  7740
      04766  3651
      04767  7477
      04770  7700
      04771  4511
      04772  4513
      04773  4400
      04774  7040
      04775  7412
      04776  7766
      04777  7737
 2716              PAGE
 2717              
 2718              /THIS IS THE INTERRUPT HANDLING ROUTINE
 2719 05000  3255  INTHAN, DCA     ACHOLD  /SAVE ACCUMULATOR
 2720 05001  7004          RAL             /LINK TO AC11
 2721 05002  3256          DCA     LKHOLD  /SAVE LINK
 2722 05003  6031          KSF             /KEYBOARD INTERRUPT?
 2723 05004  7402          HLT             /NO. UNEXPLANED INTERRUPT. PRESS START (CLEAR&CONT) TO CLEAR FLAGS
 2724 05005  6036          KRB             /YES. GET THE CHAR
 2725 05006  7450          SNA             /IS IT A NULL CHARACTER ?
 2726 05007  5247          JMP     RTINT   /YES. IGNOR IT TOTALY
 2727 05010  0377          AND     (0177   /MAKE SURE BIT 4 IS SET IN
 2728 05011  1376          TAD     (200    /CASE OF A PARITY TTY
 2729 05012  3027          DCA     CHAR    /NOW STORE THE CHAR. FOR EASY ACCESS
 2730 05013  1034          TAD     ISW     /GET INPUT IN PROGRESS SWITCH
 2731 05014  7650          SNA CLA         /IS IT SET?
 2732 05015  5247          JMP     RTINT   /NO. RETURN AND FORGET THAT THIS HAPPENED
 2733 05016  1027          TAD     CHAR    /LOAD IT BACK INTO THE AC
 2734 05017  4426          JMS  I  ZOUT    /ECCO IT
 2735 05020  1027          TAD     CHAR    /TEST IF IT IS TO BE IGNORED
 2736 05021  1375          TAD     (-240
 2737 05022  7650          SNA CLA         /IS IT A SPACE ?
 2738 05023  5247          JMP     RTINT   /YES. IGNOR IT
 2739 05024  2033          ISZ     CNTCHR  /TOO MUCH INPUT?
 2740 05025  7410          SKP             /NO
 2741 05026  5314          JMP     UGO     /YES. PRINT "^U", REINITIALIZE, AND TRY AGAIN
 2742 05027  1027          TAD     CHAR    /LOAD THE CHAR BACK INTO THE AC AGAIN
 2743 05030  1374          TAD     (-215   /FIND OUT IF IT IS A SPECIAL CHARACTER (CR OR RUBOUT)
 2744 05031  7450          SNA             /IS IT A CR?
 2745 05032  5257          JMP     LINDUN  /YES! HE'S DONE TYPING THE INPUT LINE
 2746 05033  1373          TAD     (215-377
 2747 05034  7450          SNA             /IS IT A RUBOUT CHAR?
 2748 05035  5300          JMP     RUBGO   /YES. DELETE THE LAST CHAR TYPED
 2749 05036  1372          TAD     (377-225        /NO



      / CHEKMO II                                                        Page 61


 2750 05037  7650          SNA CLA         /IS IT A CONTROL-U?
 2751 05040  5314          JMP     UGO     /YES. DELETE A WHOLE LINE
 2752 05041  1027          TAD     CHAR    /NO.
 2753              IFNZRO OS8<
 2754 05042  1371          TAD     (-203
 2755 05043  7650          SNA CLA         /IS CHAR A CONTROL-C  ?
 2756 05044  5770@         JMP     MONITR  /YES
 2757 05045  1027          TAD     CHAR    /NO. GET ITS VALUE BACK AGAIN
 2758              >
 2759 05046  3416          DCA  I  CLIST   /STORE THE CHAR. IN THE KEYBOARD BUFFER
 2760 05047  1256  RTINT,  TAD     LKHOLD  /RESTORE THE LINK TO ITS PRE-INTERRUPT STATE
 2761 05050  7110          CLL RAR
 2762 05051  1255          TAD     ACHOLD  /RESTORE ACCUMULATOR
 2763 05052  6244          RMF             /AND THE MEMORY FIELDS
 2764 05053  6001          ION             /WITH INTERRUPT ENABLED,
 2765 05054  5400          JMP  I  IFRM    /RETURN TO MAIN PROGRAM
 2766 05055  0000  ACHOLD, 0000            /HOLD AC AFTER INTERRUPT
 2767 05056  0000  LKHOLD, 0000            /HOLD LINK AFTER INTERRUPT
 2768              
 2769 05057  3416  LINDUN, DCA  I  CLIST   /MARK THE END OF INPUT WITH A 0000 CHAR. IN BUFFER
 2770 05060  1367          TAD     (KBUF-1 /REINITIALIZE THE KEYBOARD BUFFER
 2771 05061  3016          DCA     CLIST
 2772 05062  3034          DCA     ISW     /CLEAR THE INPUT SWITCH
 2773 05063  4430          JMS  I  ZCRLF   /PRINT A CARRIAGE RETURN-LINE FEED
 2774 05064  5247          JMP     RTINT   /RETURN
 2775              
 2776 05065  4430  LNOGO,  JMS  I  ZCRLF   /PRINT A CARRIAGE RETURN LINE FEED
 2777 05066  4432          JMS  I  ZBEGIN  /REINITIALIZE INPUT BUFFER
 2778 05067  5247          JMP     RTINT   /RETURN FROM THE LAST INTERRUPT
 2779              
 2780              /IO STALL SUBROUTINE: RETURN WHEN INPUT IS DONE
 2781 05070  0000  CHKIO,  0000
 2782 05071  7200          CLA
 2783 05072  1034          TAD     ISW     /GET THE INPUT SWITCH
 2784 05073  2011          ISZ     RANDOM  /INCREMENT THE RANDOM NUMBER
 2785 05074  7640          SZA CLA         /IS INPUT DONE?
 2786 05075  5271          JMP     .-4     /NO: CHECK AGAIN
 2787 05076  6002          IOF             /DONT NEED THIS ANYMORE
 2788 05077  5670          JMP  I  CHKIO   /YES: RETURN
 2789              
 2790 05100  7200  RUBGO,  CLA
 2791 05101  1367          TAD     (KBUF-1
 2792 05102  7041          CIA
 2793 05103  1016          TAD     CLIST
 2794 05104  7650          SNA CLA         /ARE WE AT THE BEGINING OF A LINE ALLREADY?
 2795 05105  5265          JMP     LNOGO   /YES.
 2796 05106  1366          TAD     ("\     /NO. PRINT A "\" CHAR
 2797 05107  4426          JMS  I  ZOUT
 2798 05110  7240          CMA CLA         /NOW MOVE BACK THE BUFFER POINTER
 2799 05111  1016          TAD     CLIST



      / CHEKMO II                                                        Page 62


 2800 05112  3016          DCA     CLIST
 2801 05113  5247          JMP     RTINT   /RETURN FROM INTERUPT
 2802              
 2803 05114  7200  UGO,    CLA
 2804 05115  4575          PRINTO; MESG21  /PRINT A "^U"
      05116  6005
 2805 05117  5265          JMP     LNOGO   /GO SETUP FOR A NEW LINE
 2806              
 2807              /FOLLOWING IS THE LEGAL  COMMAND LIST
 2808              /IT CONSISTS OF A NUMBER OF 2WORD ENTRIES
 2809              /THE 1ST WORD IN EACH ENTRY IS THE 6BIT REPRESENTATION(NEGATED FOR EASY COMPARING)
 2810              /OF A 2 CHARACTER COMMAND
 2811              /THE 2ND WORD CONTAINS THE ADDRESS TO GO TO IF THAT COMMAND IS TYPED
 2812 05120  5751  COMLST, -2027;  COMPW   /PW - PLAY WHITE
      05121  0261
 2813 05122  5776          -2002;  COMPB   /PB - PLAY BLACK
      05123  0263
 2814 05124  5762          -2016;  COMPN   /PN - PLAY NIETHER WHITE OR BLACK
      05125  0210
 2815 05126  7574          -0204;  COMBD   /BD - DISPLAY THE POSITION
      05127  0265
 2816 05130  6660          -1120;  COMIP   /IP - INPUT A POSITION
      05131  0267
 2817 05132  5573          -2205;  START   /RE - RESET  (RESIGN)
      05133  0200
 2818 05134  6252          -1526;  CMOVE   /MV - MOVE
      05135  0306
 2819 05136  5465          -2313;  COMSK   /SK - SKIP A MOVE
      05137  5742
 2820 05140  7563          -0215;  COMBM   /BM - BLITZ MODE
      05141  4736
 2821 05142  5363          -2415;  COMTM   /TM - TOURNAMENT
      05143  4734
 2822                      IFNZRO  LPTREE <
 2823 05144  6354          -1424;  COMLT   /LT - OUTPUT TREE TO LINE PRINTER(LP08)
      05145  5736
 2824              >
 2825 05146  0000          -0000;  0000    /END OF COMMAND LIST
      05147  0000
 2826              
 2827 05150  2324  MESG14, TEXT \STALEMATE\
      05151  0114
      05152  0515
      05153  0124
      05154  0500
 2828 05155  3117  MESG24, TEXT \YOUR MOVE? \
      05156  2522
      05157  4015
      05160  1726
      05161  0577



      / CHEKMO II                                                        Page 63


      05162  4000
 2829              
      05166  0334
      05167  7447
      05170  5342
      05171  7575
      05172  0152
      05173  7616
      05174  7563
      05175  7540
      05176  0200
      05177  0177
 2830              PAGE
 2831              
 2832              /MESSAGE PRINTING SUBROUTINE--CALL WITH ADDR OF MESSAGE IN AC
 2833              /RETURN WITH THE AC CLEAR
 2834              /IF CALLED WITH THE AC IS CLEAR THE ADDRESS OF THE MESSAGE IS TAKEN FROM THE WORD
 2835              /AT THE ADDRESS+1 OF THE CALL TO THIS SUBROUTINE, AND THE RETURN ADDRESS
 2836              /IS THE ADDRESS+2 OF THE CALLING JMS
 2837 05200  0000  MES,    0000
 2838 05201  7440          SZA             /IS THE ADDRESS OF THE MESSAGE IN THE AC?
 2839 05202  5205          JMP     .+3     /YES. DONT BOTHER GETTING IT FROM THE WORD FOLLOWING THE JMS
 2840 05203  1600          TAD  I  MES     /NO. BOTHER PLEASE
 2841 05204  2200          ISZ     MES     /AND INC THE RETURN ADDRESS
 2842 05205  3020          DCA     TEMP    /STORE THE ADDRESS OF THE MASSAGE
 2843 05206  1420  MES2,   TAD  I  TEMP    /GRAB 2 CHARS. PACKED INTO 1 WORD
 2844 05207  7012          RTR
 2845 05210  7012          RTR
 2846 05211  7012          RTR
 2847 05212  4217          JMS     TYPO    /PRINT CHAR IN BITS 0-5
 2848 05213  1420          TAD  I  TEMP
 2849 05214  4217          JMS     TYPO    /PRINT CHAR IN BITS 6-11
 2850 05215  2020          ISZ     TEMP    /NEXT WORD PLEASE
 2851 05216  5206          JMP     MES2
 2852              
 2853 05217  0000  TYPO,   0000
 2854 05220  0167          AND     [0077   /CLEAROUT BITS BELONGING TO THE OTHER CHAR.
 2855 05221  7450          SNA             /IS IT A NULL CHARACTER?
 2856 05222  5600          JMP  I  MES     /YES: RETURN
 2857 05223  1165          TAD     [-40    /NO. CONVERT IT TO 8 BIT
 2858 05224  7510          SPA
 2859 05225  1377          TAD     (100
 2860 05226  1376          TAD     (240
 2861 05227  4426          JMS  I  ZOUT    /NOW PRINT IT
 2862 05230  5617          JMP  I  TYPO
 2863              
 2864              /PRINTOUT SUBROUTINE--SINGLE CHARACTER
 2865 05231  0000  OUT,    0000
 2866 05232  6046          TLS             /FIRST PRINT THE CHAR
 2867 05233  6041          TSF             /WAIT FOR THE FLAG TO RETURN



      / CHEKMO II                                                        Page 64


 2868 05234  5233          JMP     .-1     /NOT YET IT HASN'T
 2869 05235  6042          TCF             /CLEAR FLAG TO AVOID TELLEPRINTER INTERUPTS
 2870 05236  7200          CLA
 2871 05237  5631          JMP  I  OUT     /RETURN
 2872              
 2873              /CARRIAGE RETURN & LINE FEED SUBROUTINE
 2874 05240  0000  CRLF,   0000
 2875 05241  7200          CLA
 2876 05242  1375          TAD     (215
 2877 05243  4426          JMS  I  ZOUT    /PRINT THE CR
 2878 05244  4426          JMS  I  ZOUT    /AND A NULL
 2879 05245  1374          TAD     (212
 2880 05246  4426          JMS  I  ZOUT    /PRINT THE LF
 2881 05247  4426          JMS  I  ZOUT    /PRINT A COUPLE OF NULL FILLER CHARS IN CASE SOMEONE
 2882 05250  4426          JMS  I  ZOUT    /TRYS TO USE A FANCY VIDEO-SCREEN TERMINAL
 2883 05251  5640          JMP  I  CRLF    /RETURN
 2884              
 2885              /INITIALIZE INPUT
 2886 05252  0000  BEGIN,  0000
 2887 05253  7201          CLA IAC
 2888 05254  3034          DCA     ISW     /SET THE 'INPUT IN PROGRESS' SWITCH
 2889 05255  1373          TAD     (KBUF-1 /INITIALIZE THE KEYBOARD BUFFER POINTER
 2890 05256  3016          DCA     CLIST
 2891 05257  1372          TAD     (-30
 2892 05260  3033          DCA     CNTCHR  /30 CHARACTERS MAXIMUM
 2893 05261  6032          KCC             /REINITIALZE THE KEYBOARD FLAG
 2894 05262  5652          JMP  I  BEGIN   /RETURN
 2895              
 2896              /GET A CHARACTER FROM THE INPUT BUFFER
 2897              /IGNOR  "-" AND ":" CHARACTERS
 2898 05263  0000  GETC,   0000
 2899 05264  7200          CLA
 2900 05265  1416          TAD  I  CLIST   /TAKE A CHAR. OUT OF THE BUFFER
 2901 05266  3020          DCA     TEMP    /MAKE IT EASILY REACHED
 2902 05267  1020          TAD     TEMP    /FIND OUT IF THE CHAR SHOULD BE IGNORED
 2903 05270  1371          TAD     (-"-
 2904 05271  7450          SNA             /IS IT A MINUS SIGN?
 2905 05272  5264          JMP     GETC+1  /YES. IGNOR IT
 2906 05273  1370          TAD     ("--":  /NO. TEST FOR A COLON
 2907 05274  7650          SNA CLA         /IS IT A COLON?
 2908 05275  5264          JMP     GETC+1  /YES. IGNOR IT
 2909 05276  1020          TAD     TEMP    /NO. LOAD IT BACK INTO AC
 2910 05277  5663          JMP  I  GETC    /RETURN
 2911              
 2912              /SUBROUTINE TO PRINT A "SIGNED OCTAL" NUMBER
 2913 05300  0000  OCTOUT, 0000
 2914 05301  3020          DCA     TEMP
 2915 05302  4335          JMS     SPACE   /PRINT A LEADING SPACE
 2916 05303  1020          TAD     TEMP
 2917 05304  7710          SPA CLA         /IS IT A NEGATIVE #?



      / CHEKMO II                                                        Page 65


 2918 05305  1367          TAD     ("--"   /YES PRINT A MINUS SIGN
 2919 05306  1376          TAD     (" 
 2920 05307  4426          JMS  I  ZOUT
 2921 05310  1020          TAD     TEMP    /GET # AGAIN
 2922 05311  7510          SPA             /IS IT NEGATIVE?
 2923 05312  7041          CIA             /YES. MAKE POSITIVE
 2924 05313  4315          JMS     OCTNFM  /PRINT IN OCTAL
 2925 05314  5700          JMP  I  OCTOUT  /RETURN
 2926              
 2927              /SUBROUTINE TO PRINT OUT AN OCTAL NUMBER WITH NO FORMATING
 2928 05315  0000  OCTNFM, 0000
 2929 05316  7004          RAL             /ROTATE INTO POSITION
 2930 05317  3020          DCA     TEMP
 2931 05320  1366          TAD     (-4
 2932 05321  3021          DCA     TEMP1   /SETUP COUNT FOR 4 DIGITS
 2933 05322  1020  OCTMID, TAD     TEMP
 2934 05323  7004          RAL
 2935 05324  7006          RTL
 2936 05325  3020          DCA     TEMP
 2937 05326  1020          TAD     TEMP
 2938 05327  0166          AND     [0007
 2939 05330  1365          TAD     ("0
 2940 05331  4426          JMS I   ZOUT
 2941 05332  2021          ISZ     TEMP1
 2942 05333  5322          JMP     OCTMID
 2943 05334  5715          JMP  I  OCTNFM  /RETURN
 2944              
 2945              /SUBROUTINE TO PRINT A SPACE CHARACTER
 2946 05335  0000  SPACE,  0000
 2947 05336  7200          CLA
 2948 05337  1376          TAD     (240    /LOAD AC WITH SPACE CODE
 2949 05340  4426          JMS  I  ZOUT    /SEND IT OUT
 2950 05341  5735          JMP  I  SPACE   /RETURN
 2951              
 2952              IFNZRO  OS8     <
 2953              /PRINT A "^C" AND RETURN TO THE OS8 MONITOR
 2954 05342  7200  MONITR, CLA
 2955 05343  4575          PRINTO; MESG18  /PRINT "^C"
      05344  5545
 2956 05345  6203          CIF CDF 0       /MONITOR IS IN FIELD 0
 2957 05346  5764          JMP  I  (7600   /GO TO MONITOR
 2958              >
 2959              
 2960              IFNZRO  LPTREE  <
 2961              /SUBROUTINE TO TAB OVER TO COLOMN # "PLY"
 2962 05347  0000  TABPLY, 0000
 2963 05350  7200          CLA
 2964 05351  1122          TAD     PLY     /GET PLY #
 2965 05352  7450          SNA             /IS IT ZERO?
 2966 05353  7001          IAC             /YES. DO ONE TAB ANYWAYS



      / CHEKMO II                                                        Page 66


 2967 05354  7041          CIA
 2968 05355  3363          DCA     CMBCNT  /SETUP COLOMN COUNTER
 2969 05356  4575          PRINTO; MESG19  /PRINT 8 SPACES
      05357  6000
 2970 05360  2363          ISZ     CMBCNT  /TABBED ENOUGH PLACES YET?
 2971 05361  5356          JMP     .-3     /NO. TAB AGAIN
 2972 05362  5747          JMP  I  TABPLY  /YES. RETURN
 2973 05363  0000  CMBCNT, 0000
 2974              >
      05364  7600
      05365  0260
      05366  7774
      05367  0015
      05370  7763
      05371  7523
      05372  7750
      05373  7447
      05374  0212
      05375  0215
      05376  0240
      05377  0100
 2975              PAGE
 2976              
 2977              /SUBROUTINE TO TRY TO INTERPERT THE CONTENTS OF THE KEYBOARD
 2978              /BUFFER AS A MOVE TYPED IN USING MODIFIED
 2979              /ALGEBREIC NOTATION, TEST THE MOVES LEGALITY, AND MAKE THE
 2980              /MOVE ON THE BOARD
 2981              /IF INPUT IS NOT A LEGAL MOVE RETURN IS TO THE ADDRESS+1
 2982              /OF THE CALLING JMS  AND THE AC  MAY NOT BE CLEARED
 2983 05400  0000  INMV,   0000
 2984 05401  7200          CLA
 2985 05402  3111          DCA     IOMSW   /INITIALIZE MSW AND MDW
 2986 05403  3110          DCA     IOMDW
 2987 05404  4435          JMS  I  ZGETC   /GET A CHARACTER
 2988 05405  4777@         JMS     ISA2H   /IS IT A LETTER "A" TO "H" ?
 2989 05406  5264          JMP     INCA    /NO. MOVE MUST BE CASTLING
 2990 05407  1376          TAD     (-301
 2991 05410  7106          RTL CLL
 2992 05411  7006          RTL
 2993 05412  7006          RTL
 2994 05413  4340          JMS     INPAK   /STORE THIS CHAR AND GET NEXT
 2995 05414  4775@         JMS     IS128   /IS IT A NUMBER "1" TO "8" ?
 2996 05415  5600          JMP  I  INMV    /NO: BAD INPUT, TAKE ERROR RETURN
 2997 05416  1374          TAD     (-261
 2998 05417  7112          RTR CLL         /ROTATE BITS 9-11 INTO THE 'FROM RANK' POSITION
 2999 05420  7012          RTR
 3000 05421  4340          JMS     INPAK   /PACK IT INTO MSW AND GET NEXT CHAR
 3001 05422  4777@         JMS     ISA2H   /IS IT A LETTER "A" TO "H" ?
 3002 05423  5600          JMP  I  INMV    /NO. TAKE ERROR RETURN
 3003 05424  1376          TAD     (-301



      / CHEKMO II                                                        Page 67


 3004 05425  4340          JMS     INPAK
 3005 05426  4775@         JMS     IS128   /IS IT A NUMBER "1" TO "8" ?
 3006 05427  5600          JMP  I  INMV    /NO. TAKE ERROR RETURN
 3007 05430  1374          TAD     (-261
 3008 05431  7106          RTL CLL         /YES. ROTATE BITS 9-11 INTO THE 'TO RANK' POSITION
 3009 05432  7004          RAL
 3010 05433  4340          JMS     INPAK
 3011 05434  1373          TAD     (-"=
 3012 05435  7640          SZA CLA         /IS IT AN EQUAL SIGN?
 3013 05436  5306          JMP     INMID-1 /NO. INPUT FINISHED, CHECK FOR LEGALITY
 3014 05437  7000          NOP             /YES. HE SAYS IT'S A PAWN PROMOTION
 3015 05440  4435          JMS  I  ZGETC   /GET THE LETTER OF THE PROMOTION PIECE
 3016 05441  1372          TAD     (-"Q
 3017 05442  7450          SNA             /IS IT A QUEEN?
 3018 05443  5256          JMP     IPPQ    /YES
 3019 05444  1371          TAD     ("Q-"R
 3020 05445  7450          SNA             /IS IT A ROOK?
 3021 05446  5257          JMP     IPPR    /YES
 3022 05447  1370          TAD     ("R-"B
 3023 05450  7450          SNA             /IS IT A BISHOP?
 3024 05451  5260          JMP     IPPB    /YES
 3025 05452  1367          TAD     ("B-"N
 3026 05453  7450          SNA             /IS IT A KNIGHT?
 3027 05454  5261          JMP     IPPN    /YES
 3028 05455  5600          JMP  I  INMV    /NO. NONE OF THE ABOVE. TAKE ERROR RETURN
 3029 05456  7001  IPPQ,   IAC
 3030 05457  7001  IPPR,   IAC
 3031 05460  7001  IPPB,   IAC
 3032 05461  1366  IPPN,   TAD     (0004
 3033 05462  3110          DCA     IOMDW
 3034 05463  5306          JMP     INMID-1
 3035              
 3036 05464  1365  INCA,   TAD     (-"O
 3037 05465  7640          SZA CLA         /COULD IT BE CASTLING?
 3038 05466  5600          JMP  I  INMV    /NO TAKE ERROR RETURN
 3039 05467  4435          JMS  I  ZGETC   /IT MUST BE CASTLING, GET NEXT CHAR
 3040 05470  1365          TAD     (-"O
 3041 05471  7640          SZA CLA         /IS IT AN "O" ?
 3042 05472  5600          JMP  I  INMV    /NO. TAKE ERROR RETURN
 3043 05473  1036          TAD     PONDIR  /YES. THE MOVE IS CASTLING CALCULATE THE 8TH RANK
 3044 05474  0364          AND     (7070   /AND USE IT TO HELP BUILD AN MSW
 3045              
 3046 05475  1363          TAD     (0406   /KING ALWAYS STARTS FROM FILE 4
 3047 05476  3111          DCA     IOMSW
 3048 05477  4435          JMS  I  ZGETC   /GET ANOTHER CHAR
 3049 05500  1365          TAD     (-"O    /ANOTHER "O" MEANS QUEEN SIDE CASTLING
 3050 05501  7440          SZA             /IS IT QUEENS SIDE?
 3051 05502  5306          JMP     INMID-1 /NO. INPUT DONE. CHECK FOR LEGALITY
 3052 05503  1362          TAD     (-4     /YES. CHANGE 'TO FILE' TO C
 3053 05504  1111          TAD     IOMSW



      / CHEKMO II                                                        Page 68


 3054 05505  3111          DCA     IOMSW
 3055 05506  4761@         JMS     GNMVSM  /GENERATE THE MOVES OF THE SIDE TO MOVE
 3056 05507  4572  INMID,  POP2            /POP OFF AN MDW
 3057 05510  3061          DCA     TOMAK2  /STORE IT
 3058 05511  4572          POP2            /POP OFF AN MSW
 3059 05512  7450          SNA             /IS IT AN MSW OR THE END OF THE LIST?
 3060 05513  5600          JMP  I  INMV    /END OF LIST AND MOVE NOT FOUND, TAKE ERROR RETURN
 3061 05514  7041          CIA
 3062 05515  1111          TAD     IOMSW   /COMPARE THE MSW WITH THE ONE HE INPUTED
 3063 05516  7640          SZA CLA         /MATCH?
 3064 05517  5307          JMP     INMID   /NO: TRY NEXT
 3065 05520  1111          TAD     IOMSW   /YES
 3066 05521  3060          DCA     TOMAK1  /STORE THE MSW
 3067 05522  1110          TAD     IOMDW   /GET THE INPUTED MDW
 3068 05523  7650          SNA CLA         /IS IT = 0  ?
 3069 05524  5333          JMP     INMID2  /YES. MOVE IS LEGAL
 3070 05525  1061          TAD     TOMAK2
 3071 05526  0166          AND     [0007   /CLEAR IRRELEVENT BITS
 3072 05527  7041          CIA
 3073 05530  1110          TAD     IOMDW
 3074 05531  7640          SZA CLA         /DO THE IMPORTANT PARTS OF THE MDW'S MATCH?
 3075 05532  5307          JMP     INMID   /NO TRY NEXT MOVE FOR A MATCK
 3076 05533  4473  INMID2, JMS  I  ZMKMV   /MAKE THE MOVE
 3077 05534  4574          IPDL1           /REINITIALIZE PUSH DOWN LIST #1
 3078 05535  4760@         JMS     POPOUT  /REINITIALIZE PDL2
 3079 05536  2200          ISZ     INMV    /NORMAL RETURN IS TO THE ADDRESS+2 OF THE CALLING JMS
 3080 05537  5600          JMP  I  INMV    /RETURN
 3081              
 3082              /SUBROUTINE USED BY INMV. ADDS NEW COMPONENT TO  'IOMSW'
 3083              /ALSO GETS NEXT CHAR FROM THE BUFFER, AND RETURN WITH ITS VALUE IN THE AC
 3084 05540  0000  INPAK,  0000
 3085 05541  1111          TAD     IOMSW
 3086 05542  3111          DCA     IOMSW
 3087 05543  4435          JMS  I  ZGETC
 3088 05544  5740          JMP  I  INPAK
 3089              
 3090 05545  3603  MESG18, TEXT \^C\
      05546  0000
 3091 05547  1755  MESG15, TEXT \O-O-O\
      05550  1755
      05551  1700
 3092 05552  0310  NAME,   TEXT \CHEKMO-II\
      05553  0513
      05554  1517
      05555  5511
      05556  1100
 3093              
      05560  3517
      05561  3526
      05562  7774



      / CHEKMO II                                                        Page 69


      05563  0406
      05564  7070
      05565  7461
      05566  0004
      05567  7764
      05570  0020
      05571  7777
      05572  7457
      05573  7503
      05574  7517
      05575  5674
      05576  7477
      05577  5706
 3094              PAGE
 3095              /SUBROUTINE TO OUTPUT A MOVE IN MODIFIED ALGEBREIC NOTATION
 3096              /CALL WITH MSW IN 'IOMSW', AND MDW IN 'IOMDW'
 3097 05600  0000  OUTMV,  0000
 3098 05601  7200          CLA
 3099 05602  1377          TAD     (" 
 3100 05603  3271          DCA     IOCH1
 3101 05604  1377          TAD     (" 
 3102 05605  3272          DCA     IOCH2
 3103 05606  1110          TAD     IOMDW
 3104 05607  0166          AND     [0007   /BUILD A JUMP
 3105 05610  1376          TAD     (JMP  .+3
 3106 05611  3212          DCA     .+1
 3107 05612  7402          HLT             /A JUMP TO ONE OF THE NEXT 8 INSTRUCTIONS IS PLACED HERE
 3108              
 3109 05613  5226          JMP     OUTSTD  /STANDARD OUTPUT FOR NORMAL MOVES
 3110 05614  5266          JMP     OUTQCA  /QUEEN-SIDE CASTLING
 3111 05615  5265          JMP     OUTKCA  /KING-SIDE CASTLING
 3112 05616  5226          JMP     OUTSTD  /STANDARD OUTPUT FOR 'EN PASSANT' CAPTURES
 3113 05617  1375          TAD     ("N-"B  /PRIMOTE TO A KNIGHT
 3114 05620  1374          TAD     ("B-"R  /PROMOTE TO A BISHOP
 3115 05621  1373          TAD     ("R-"Q  /PROMOTE TO A ROOK
 3116 05622  1372          TAD     ("Q     /PROMOTE TO A QUEEN
 3117 05623  3272          DCA     IOCH2
 3118 05624  1371          TAD     ("=     /PRINT AN EQUAL SIGN BEFORE LETTER OF THE PROMOTION PIECE
 3119 05625  3271          DCA     IOCH1
 3120 05626  7200  OUTSTD, CLA             /DO STANDARD OUTPUT
 3121 05627  1111          TAD     IOMSW   /GET THE MSW FOR THE MOVE TO BE OUTPUT
 3122 05630  7012          RTR             /ROTATE THE 'FROM FILE' BITS INTO AC 9-11
 3123 05631  7012          RTR
 3124 05632  7012          RTR
 3125 05633  4250          JMS     OUTSQR  /OUTPUT THE "FROM" SQUARE COORDINATES
 3126 05634  1110          TAD     IOMDW   /TEST TO SEE IF MOVE IS A CAPTURE
 3127 05635  7710          SPA CLA         /IS IT?
 3128 05636  1370          TAD     (":-"-  /YES: OUTPUT A ":" INSTEAD OF A "-"
 3129 05637  1367          TAD     ("-     /LOAD AC WITH THE CODE FOR A DASH
 3130 05640  4426          JMS  I  ZOUT    /OUTPUT IT



      / CHEKMO II                                                        Page 70


 3131 05641  1111          TAD     IOMSW   /GET MSW
 3132 05642  4250          JMS     OUTSQR  /OUTPUT THE "TO" SQUARE COORDINATES
 3133 05643  1271          TAD     IOCH1   /THIS IS A SPACE UNLESS MOVE IS A PAWN PROMOTION
 3134 05644  4426          JMS  I  ZOUT
 3135 05645  1272          TAD     IOCH2   /THIS IS A SPACE UNLESS MOVE IS A PAWN PROMOTION
 3136 05646  4426          JMS  I  ZOUT    /PRINT THE LAST CHARACTER AND,
 3137 05647  5600          JMP  I  OUTMV   /RETURN
 3138              
 3139              /SUBROUTINE TO OUTPUT THE COORDINATES OF A SQUARE
 3140              /CALL WITH SQUARE # IN AC BITS 6-11
 3141 05650  0000  OUTSQR, 0000
 3142 05651  3273          DCA     IOTMP   /SAVE  SQR #
 3143 05652  1273          TAD     IOTMP
 3144 05653  0166          AND     [0007   /CLEAR BITS 0-8
 3145 05654  1366          TAD     (301    /OUTPUT FILE AS A CHARACTER "A" TO "H"
 3146 05655  4426          JMS  I  ZOUT
 3147 05656  1273          TAD     IOTMP   /GET MSW
 3148 05657  7012          RTR             /MOVE RANK INTO BITS 9-11
 3149 05660  7010          RAR
 3150 05661  0166          AND     [0007
 3151 05662  1365          TAD     (261    /BUILD A CHARACTER "1" TO "8"
 3152 05663  4426          JMS  I  ZOUT    /OUTPUT IT
 3153 05664  5650          JMP  I  OUTSQR  /RETURN
 3154              
 3155 05665  7001  OUTKCA, IAC             /PASS OVER THE FIRST "O-" OF THE QUEEN SIDE CASTLING MESSAGE
 3156 05666  1364  OUTQCA, TAD     (MESG15 /GET ADDRESS OF THE QUEEN SIDE CASTLING MESSAGE
 3157 05667  4575          PRINTO          /TYPE THE MESSAGE
 3158 05670  5600          JMP  I  OUTMV   /RETURN
 3159 05671  0000  IOCH1,  0000
 3160 05672  0000  IOCH2,  0000
 3161 05673  0000  IOTMP,  0000
 3162              
 3163              /SUBROUTINE TO CHECK FOR A CHARACTER FROM "1" TO "8". SKIP IF IT IS
 3164              /CALL W/CHARACTER IN AC, RETURN SAME WAY
 3165 05674  0000  IS128,  0000
 3166 05675  1363          TAD     (-"1
 3167 05676  7510          SPA             /GREATER OR EQUAL TO "1"?
 3168 05677  5303          JMP     .+4     /NO. DON'T SKIP
 3169 05700  1164          TAD     [7770
 3170 05701  7710          SPA CLA         /LESS THAN "8"?
 3171 05702  2274          ISZ     IS128   /YES. INC RETURN ADDRESS
 3172 05703  7200          CLA
 3173 05704  1020          TAD     TEMP    /LOAD THE CHARACTER BACK INTO THE AC
 3174 05705  5674          JMP  I  IS128   /RETURN
 3175              
 3176              /SUBROUTINE TO CHECK FOR A CHARACTER FROM "A" TO "H"
 3177              /CALL W/CHARACTER IN AC, RETURN SAME
 3178              /SUBROUTINE EFFECTS A SKIP IF CHAR IS BETWEEN "A" AND "H"
 3179 05706  0000  ISA2H,  0000
 3180 05707  1362          TAD     (-"A



      / CHEKMO II                                                        Page 71


 3181 05710  7510          SPA             /IS IT >= "A" ?
 3182 05711  5315          JMP     .+4     /NO. DONT SKIP
 3183 05712  1164          TAD     [7770
 3184 05713  7710          SPA CLA         /IS IT <= "H" ?
 3185 05714  2306          ISZ     ISA2H   /YES. INC RETURN ADDRESS
 3186 05715  7200          CLA
 3187 05716  1020          TAD     TEMP    /GET CHAR BACK
 3188 05717  5706          JMP  I  ISA2H   /RETURN
 3189              
 3190              /SUBROUTINE TO TEST FOR CHECKMATE OR STALEMATE
 3191 05720  0000  QMATE,  0000
 3192 05721  4761@         JMS     GNMVSM  /GENERATE THE MOVES OF THE SIDE WHOSE MOVE IT IS
 3193 05722  4760@         JMS     POPOUT  /DONT NEED THE MOVES JUST THE INFO ON THEM
 3194 05723  1106          TAD     GNCNT   /GET # OF MOVES GENERATED
 3195 05724  7640          SZA CLA         /ANY?
 3196 05725  5720          JMP  I  QMATE   /YES. RETURN
 3197 05726  1112          TAD     CMSW    /NO. GET CHECKMATE SWITCH
 3198 05727  7650          SNA CLA         /IS IT SET?
 3199 05730  1357          TAD     (-MESG9+MESG14  /NO. GET ADDR OF STALEMATE MESSAGE
 3200 05731  1356          TAD     (MESG9  /ADD ADDR OF CHECKMATE MESAGE
 3201 05732  4575          PRINTO          /PRINT THE MESSAGE OUT
 3202 05733  4430          JMS  I  ZCRLF
 3203 05734  4755@         JMS     DISPLA  /PRINTOUT THE FINAL POSITION
 3204 05735  5754@         JMP     START   /START A NEW GAME
 3205              
 3206              
 3207                      IFNZRO  LPTREE <
 3208 05736  1753@ COMLT,  TAD     LTSW
 3209 05737  7040          CMA
 3210 05740  3753@         DCA     LTSW
 3211 05741  5752@         JMP     COMMAN
 3212              >
 3213 05742  1077  COMSK,  TAD     WHOSE   /COMPLIMENT THE "WHOSE MOVE" SWITCH
 3214 05743  7040          CMA             /SO THAT SOMEONE MISSES A MOVE
 3215 05744  3077          DCA     WHOSE
 3216 05745  3071          DCA     LSTMV   /DISABLE EN PASSANT PAWN CAPTURES FOR THE NEXT MOVE
 3217 05746  5752@         JMP     COMMAN
 3218              
      05752  0212
      05753  6034
      05754  0200
      05755  6035
      05756  6341
      05757  6607
      05760  3517
      05761  3526
      05762  7477
      05763  7517
      05764  5547
      05765  0261



      / CHEKMO II                                                        Page 72


      05766  0301
      05767  0255
      05770  0015
      05771  0275
      05772  0321
      05773  0001
      05774  7760
      05775  0014
      05776  5213
      05777  0240
 3219              PAGE
 3220 06000  4040  MESG19,        TEXT \        \
      06001  4040
      06002  4040
      06003  4040
      06004  0000
 3221 06005  3625  MESG21, TEXT \^U\
      06006  0000
 3222              
 3223              IFNZRO  LPTREE  <
 3224              /SUBROUTINE TO OUTPUT A CHARACTER TO THE LINE PRINTER
 3225              /CALL WITH THE CHAR. IN THE AC, RETURN WITH THE AC CLEARED
 3226 06007  0000  LPTOUT, 0000
 3227 06010  7450          SNA             /TRYING TO PRINT A NULL CHAR ?
 3228 06011  5607          JMP  I  LPTOUT  /YES. DONT BOTHER, JUST RETURN
 3229 06012  3233          DCA     LPTMP   /STORE THE CHAR JUST FOR A MOMENT
 3230 06013  1234          TAD     LTSW    /GET TREE PRINTOUT SWITCH
 3231 06014  7650          SNA CLA         /IS IT SET?
 3232 06015  5607          JMP  I  LPTOUT  /NO. DO NO OUTPUT TO THE LINE PRINTER
 3233 06016  7604          LAS             /READ SWITCHES
 3234 06017  7700          SMA CLA         /SWITCH 0 SET?
 3235 06020  5607          JMP  I  LPTOUT  /NO. DO NOT OUTPUT TO LINE PRINTER
 3236 06021  1233          TAD     LPTMP   /YES.
 3237 06022  6663          PSKE            /ERROR?
 3238 06023  7410          SKP             /NO. CONTINUE
 3239 06024  5222          JMP     .-2     /YES. WAIT FOR THE ERROR TO GO AWAY
 3240 06025  6661          PSKF            /IS THE PRINTER READY TO ACCEPT THE CHAR?
 3241 06026  5225          JMP     .-1     /NO. TEST AGAIN, AND AGAIN
 3242 06027  6666          PCLF PSTB       /YES. PRINT IT
 3243 06030  7200          CLA             /GET READY TO RETURN
 3244 06031  6667          PCIE            /CLEAR LINE PRINTER INTERUPT FLAG
 3245 06032  5607          JMP  I  LPTOUT  /RETURN
 3246 06033  0000  LPTMP,  0000            /TEMP STORAGE FOR LINE PRINTER ROUTINE
 3247 06034  0000  LTSW,   0000            /TREE PRINTOUT SWITCH
 3248              >
 3249              / CHESSBOARD PRINTER
 3250              
 3251 06035  0000  DISPLAY,0
 3252 06036  4430          JMS  I  ZCRLF   /PRINT A BLANK LINE
 3253 06037  1377          TAD (BOARD+70-1



      / CHEKMO II                                                        Page 73


 3254 06040  3132          DCA RNKPTR      /POINT TO TOP RANK
 3255 06041  1164          TAD [7770
 3256 06042  3126          DCA RNKKNT      /SET UP FOR 8 RANKS
 3257 06043  1132  RNKLUP, TAD RNKPTR
 3258 06044  3012          DCA XR0         /POINT TO BEFORE LEFTMOST SQUARE IN RANK
 3259 06045  1164          TAD [7770
 3260 06046  3127          DCA FILKNT      /SET UP FOR 8 SQUARES PER RANK
 3261 06047  5252          JMP RL1
 3262 06050  1376  RL2,    TAD (240
 3263 06051  4426          JMS I ZOUT
 3264 06052  3131  RL1,    DCA COLOR       /SET COLOR TO ZERO
 3265 06053  1412          TAD I XR0       /GET PIECE
 3266 06054  7450          SNA             /IS SQUARE OCCUPIED?
 3267 06055  5324          JMP EMPTY       /NO
 3268 06056  7510          SPA             /YES
 3269 06057  2131          ISZ COLOR       /SET COLOR TO 1 IF BLACK PIECE
 3270 06060  7510          SPA
 3271 06061  7041          CIA             /TAKE ABSOLUTE VALUE OF PIECE
 3272 06062  1165          TAD [-PAWN
 3273 06063  7450          SNA             /IS IT A PAWN?
 3274 06064  5305          JMP DP          /YES
 3275 06065  1375          TAD (PAWN-KNIGHT/NO
 3276 06066  7450          SNA             /IS IT A KNIGHT?
 3277 06067  5306          JMP DN          /YES
 3278 06070  1374          TAD (KNIGHT-BISHOP/NO
 3279 06071  7450          SNA             /IS IT A BISHOP?
 3280 06072  5307          JMP DB          /YES
 3281 06073  1373          TAD (BISHOP-ROOK/NO
 3282 06074  7450          SNA             /IS IT A ROOK?
 3283 06075  5310          JMP DR          /YES
 3284 06076  1372          TAD (ROOK-QUEEN /NO
 3285 06077  7450          SNA             /IS IT HER MAJESTY?
 3286 06100  5312          JMP DQ          /YES
 3287 06101  1371          TAD (QUEEN-KING /NO
 3288 06102  7650          SNA CLA         /IS IT HIS HIGHNESS?
 3289 06103  5311          JMP DK          /YES
 3290 06104  1370          TAD ("?-"P      /IT'S AN UNKNOWN PIECE
 3291 06105  1367  DP,     TAD ("P-"N
 3292 06106  1366  DN,     TAD ("N-"B
 3293 06107  1365  DB,     TAD ("B-"R
 3294 06110  1364  DR,     TAD ("R-"K
 3295 06111  1374  DK,     TAD ("K-"Q
 3296 06112  1363  DQ,     TAD ("Q
 3297 06113  3130          DCA PIECE       /SAVE PIECE
 3298 06114  1131          TAD COLOR       /WHICH COLOR PIECE IS IT?
 3299 06115  7640          SZA CLA
 3300 06116  1362          TAD ("B-"W      /BLACK
 3301 06117  1361          TAD ("W         /WHITE
 3302 06120  4426          JMS I ZOUT      /PRINT COLOR OF PIECE
 3303 06121  1130          TAD PIECE



      / CHEKMO II                                                        Page 74


 3304 06122  4426          JMS I ZOUT      /PRINT NAME OF PIECE
 3305 06123  5342          JMP NEXT
 3306 06124  1012  EMPTY,  TAD XR0
 3307 06125  7012          RTR
 3308 06126  7010          RAR
 3309 06127  0166          AND [0007       /ISOLATE RANK
 3310 06130  1012          TAD XR0         /ADD IN FILE
 3311 06131  7010          RAR             /PUT PARITY IN LINK
 3312 06132  7630          SZL CLA         /WHITE OR BLACK SQUARE?
 3313 06133  1360          TAD ("--"*      /WHITE
 3314 06134  1357          TAD ("*         /BLACK
 3315 06135  3130          DCA PIECE
 3316 06136  1130          TAD PIECE
 3317 06137  4426          JMS I ZOUT
 3318 06140  1130          TAD PIECE
 3319 06141  4426          JMS I ZOUT
 3320 06142  2127  NEXT,   ISZ FILKNT      /AT END OF RANK?
 3321 06143  5250          JMP RL2         /NO, GO ON TO NEXT SQUARE
 3322 06144  4430          JMS I ZCRLF     /YES, GO TO NEXT RANK
 3323 06145  1132          TAD RNKPTR
 3324 06146  1164          TAD [7770
 3325 06147  3132          DCA RNKPTR
 3326 06150  2126          ISZ RNKKNT      /WAS THIS THE LAST RANK?
 3327 06151  5243          JMP RNKLUP      /NO, PROCEED TO NEXT RANK
 3328 06152  4430          JMS I ZCRLF     /AN EXTRA CRLF FOR GOOD LUCK
 3329 06153  5635          JMP I DISPLAY   /RETURN
 3330              
      06157  0252
      06160  0003
      06161  0327
      06162  7753
      06163  0321
      06164  0007
      06165  7760
      06166  0014
      06167  0002
      06170  7757
      06171  7500
      06172  7600
      06173  7712
      06174  7772
      06175  7674
      06176  0240
      06177  7567
 3331              PAGE
 3332              
 3333              /CHESS POSITION INPUTTER
 3334              /INPUT A LINE AT A TIME IN FORSYTH NOTATION
 3335              /
 3336              / POSIBLE ERRORS....



      / CHEKMO II                                                        Page 75


 3337              / 1?    TRYING TO PUT TOO MUCH STUFF ON A RANK
 3338              / 2?    INCOMPLETE RANK SPECIFICATION(NOT ENOUGH STUFF)
 3339              / 3?    UNKNOWN PIECE LETTER
 3340              / 4?    PIECE COLOR NOT "W" OR "B"
 3341              
 3342 06200  0000  INPUT,  0
 3343 06201  4430          JMS I ZCRLF
 3344 06202  1377          TAD (BOARD+70-1
 3345 06203  3132          DCA RNKPTR
 3346 06204  1164          TAD [7770
 3347 06205  3126          DCA RNKKNT      /SET UP FOR 8 RANKS
 3348 06206  1132  RNLUP,  TAD RNKPTR
 3349 06207  3012          DCA XR0
 3350 06210  1376          TAD     (">
 3351 06211  4426          JMS  I  ZOUT    /PRINT A ">" TO INDIACTE READYNESS FOR INPUT
 3352 06212  1375          TAD     (7767
 3353 06213  3127          DCA FILKNT
 3354 06214  4432          JMS I ZBEGIN    /SETUP TO READ A LINE OF INPUT
 3355 06215  6001          ION             /GO !
 3356 06216  4452          JMS I ZCHKIO
 3357 06217  4435  RL3,    JMS I ZGETC     /READ A CHARACTER
 3358 06220  7450          SNA             /AT END OF LINE?
 3359 06221  5306          JMP EOL         /YES
 3360 06222  4774          JMS I (IS128    /IS CHAR A DIGIT?
 3361 06223  5234          JMP LETTR       /NO
 3362 06224  1373          TAD (-260       /YES, CONVERT TO DIGIT
 3363 06225  7041          CIA
 3364 06226  3131          DCA COLOR
 3365 06227  4335          JMS     CHK     /TEST FOR TOO ENOUGH STUFF ON THIS RANK ALREADY
 3366 06230  3412          DCA I XR0
 3367 06231  2131          ISZ COLOR
 3368 06232  5227          JMP .-3
 3369 06233  5217          JMP RL3
 3370              
 3371 06234  1372  LETTR,  TAD (-"B
 3372 06235  7450          SNA             /IS IT A BLACK PIECE?
 3373 06236  5243          JMP BLP         /YES
 3374 06237  1371          TAD ("B-"W
 3375 06240  7640          SZA CLA         /IS IT A WHITE PIECE?
 3376 06241  5324          JMP ERR4        /NOT "B" OR "W"
 3377 06242  7240  WHP,    STA
 3378 06243  3131  BLP,    DCA COLOR
 3379 06244  4335          JMS CHK
 3380 06245  4435          JMS I ZGETC     /GET PIECE NAME
 3381 06246  1372          TAD (-"B
 3382 06247  7450          SNA             /IS IT A BISHOP?
 3383 06250  5276          JMP GB          /YES
 3384 06251  1370          TAD ("B-"N      /NO
 3385 06252  7450          SNA             /IS IT A KNIGHT?
 3386 06253  5275          JMP GN          /YES



      / CHEKMO II                                                        Page 76


 3387 06254  1367          TAD ("N-"P      /NO
 3388 06255  7450          SNA             /IS IT A PAWN?
 3389 06256  5274          JMP GP          /YES
 3390 06257  1367          TAD ("P-"R      /NO
 3391 06260  7450          SNA             /IS IT A ROOK?
 3392 06261  5277          JMP GR          /YES
 3393 06262  1366          TAD ("R-"K      /NO
 3394 06263  7450          SNA             /IT IT A KING?
 3395 06264  5301          JMP GK          /YES
 3396 06265  1365          TAD ("K-"Q      /NO
 3397 06266  7450          SNA             /IT IT A QUEEN?
 3398 06267  5300          JMP GQ          /YES
 3399 06270  1367          TAD ("Q-"S      /NO
 3400 06271  7650          SNA CLA         /IS IT A SPRINGER?
 3401 06272  5275          JMP GN          /YES, ACCEPT AS KNIGHT
 3402 06273  5325          JMP ERR3        /UNKNOWN PIECE
 3403              
 3404 06274  1364  GP,     TAD (PAWN-KNIGHT
 3405 06275  1365  GN,     TAD (KNIGHT-BISHOP
 3406 06276  1363  GB,     TAD (BISHOP-ROOK
 3407 06277  1362  GR,     TAD (ROOK-QUEEN
 3408 06300  1361  GQ,     TAD (QUEEN-KING
 3409 06301  1360  GK,     TAD (KING
 3410 06302  2131          ISZ COLOR       /WHICH COLOR
 3411 06303  7041          CIA             /COMPLEMENT VALUE IF BLACK
 3412 06304  3412          DCA I XR0       /STORE AWAY PIECE
 3413 06305  5217          JMP RL3         /REITERATE
 3414              
 3415 06306  2127  EOL,    ISZ     FILKNT  /WERE 8 SQUARES INPUTTED?
 3416 06307  5326          JMP ERR2        /NO, TOO FEW SQUARES
 3417 06310  1132          TAD RNKPTR
 3418 06311  1164          TAD [7770
 3419 06312  3132          DCA RNKPTR      /POINT TO NEXT RANK
 3420 06313  2126          ISZ RNKKNT      /WAS THIS LAST RANK?
 3421 06314  5206          JMP RNLUP       /NO
 3422 06315  3054          DCA     BPSW    /YES. INITIALIZE POSITION STATUS WORDS
 3423 06316  3053          DCA     WPSW    /TO ALLOW CASTLING
 3424 06317  3071          DCA     LSTMV   /DISSALLOW EN PASSANT PAWN CAPTURES FOR THE NEXT MOVE
 3425 06320  4757@         JMS     BRDVAL  /THEN FIGURE OUT ITS VALUE
 3426              /<<DANGER>>    THE AC MIGHT NOT EQUAL ZERO NOW!
 3427 06321  4430          JMS I ZCRLF     /LET GUY KNOW HE'S THROUGH
 3428 06322  4756@         JMS     DISPLA  /PRINT OUT THE BOARD JUST INPUTED
 3429 06323  5600          JMP I INPUT     /RETURN
 3430              
 3431 06324  7001  ERR4,   IAC
 3432 06325  7001  ERR3,   IAC
 3433 06326  7001  ERR2,   IAC
 3434 06327  1355  ERR1,   TAD (61
 3435 06330  4426          JMS I ZOUT
 3436 06331  1354          TAD ("?



      / CHEKMO II                                                        Page 77


 3437 06332  4426          JMS I ZOUT
 3438 06333  4430          JMS I ZCRLF
 3439 06334  5206          JMP RNLUP
 3440              
 3441 06335  0000  CHK,    0
 3442 06336  2127          ISZ     FILKNT  /IS THIS RANK FULL ALREADY?
 3443 06337  5735          JMP  I  CHK     /NO. KEEP GOING
 3444 06340  5327          JMP     ERR1    /YES. SIGNAL ERROR
 3445              
 3446 06341  0310  MESG9,  TEXT \CHECKMATE\
      06342  0503
      06343  1315
      06344  0124
      06345  0500
 3447 06346  0256  MESG22, TEXT \B. \
      06347  4000
 3448 06350  2756  MESG23, TEXT \W. \
      06351  4000
 3449              
      06354  0277
      06355  0061
      06356  6035
      06357  3233
      06360  0740
      06361  7500
      06362  7600
      06363  7712
      06364  7674
      06365  7772
      06366  0007
      06367  7776
      06370  7764
      06371  7753
      06372  7476
      06373  7520
      06374  5674
      06375  7767
      06376  0276
      06377  7567
 3450              PAGE
 3451        7400  *7400
 3452              /TABLE AREA
 3453              
 3454 07400  0000  MAP,    ZBLOCK  50      /50 WORDS RESERVED FOR PIECE MAP
      07401  0000
      07402  0000
      07403  0000
      07404  0000
      07405  0000
      07406  0000



      / CHEKMO II                                                        Page 78


      07407  0000
      07410  0000
      07411  0000
      07412  0000
      07413  0000
      07414  0000
      07415  0000
      07416  0000
      07417  0000
      07420  0000
      07421  0000
      07422  0000
      07423  0000
      07424  0000
      07425  0000
      07426  0000
      07427  0000
      07430  0000
      07431  0000
      07432  0000
      07433  0000
      07434  0000
      07435  0000
      07436  0000
      07437  0000
      07440  0000
      07441  0000
      07442  0000
      07443  0000
      07444  0000
      07445  0000
      07446  0000
      07447  0000
 3455              
 3456 07450  0000  KBUF,   ZBLOCK  30      /30 WORDS RESERVED FOR THE KEYBOARD BUFFER
      07451  0000
      07452  0000
      07453  0000
      07454  0000
      07455  0000
      07456  0000
      07457  0000
      07460  0000
      07461  0000
      07462  0000
      07463  0000
      07464  0000
      07465  0000
      07466  0000
      07467  0000



      / CHEKMO II                                                        Page 79


      07470  0000
      07471  0000
      07472  0000
      07473  0000
      07474  0000
      07475  0000
      07476  0000
      07477  0000
 3457              
 3458              / THE BOARD
 3459              
 3460              BOARD,  IFNZRO  .&0077<?BOARD MUST OCCUPY 1ST OR 2ND HALF OF A PAGE ?>
 3461              
 3462              
 3463 07500  0240          ROOK
 3464 07501  0144          KNIGHT
 3465 07502  0152          BISHOP
 3466 07503  0440          QUEEN
 3467 07504  0740          KING
 3468 07505  0152          BISHOP
 3469 07506  0144          KNIGHT
 3470 07507  0240          ROOK
 3471              
 3472 07510  0040          PAWN
 3473 07511  0040          PAWN
 3474 07512  0040          PAWN
 3475 07513  0040          PAWN
 3476 07514  0040          PAWN
 3477 07515  0040          PAWN
 3478 07516  0040          PAWN
 3479 07517  0040          PAWN
 3480              
 3481 07520  0000  ZBLOCK  40
      07521  0000
      07522  0000
      07523  0000
      07524  0000
      07525  0000
      07526  0000
      07527  0000
      07530  0000
      07531  0000
      07532  0000
      07533  0000
      07534  0000
      07535  0000
      07536  0000
      07537  0000
      07540  0000
      07541  0000



      / CHEKMO II                                                        Page 80


      07542  0000
      07543  0000
      07544  0000
      07545  0000
      07546  0000
      07547  0000
      07550  0000
      07551  0000
      07552  0000
      07553  0000
      07554  0000
      07555  0000
      07556  0000
      07557  0000
 3482              
 3483 07560  7740          -PAWN
 3484 07561  7740          -PAWN
 3485 07562  7740          -PAWN
 3486 07563  7740          -PAWN
 3487 07564  7740          -PAWN
 3488 07565  7740          -PAWN
 3489 07566  7740          -PAWN
 3490 07567  7740          -PAWN
 3491              
 3492 07570  7540          -ROOK
 3493 07571  7634          -KNIGHT
 3494 07572  7626          -BISHOP
 3495 07573  7340          -QUEEN
 3496 07574  7040          -KING
 3497 07575  7626          -BISHOP
 3498 07576  7634          -KNIGHT
 3499 07577  7540          -ROOK
 3500              
      00161  7041
      00162  0004
      00163  7500
      00164  7770
      00165  7740
      00166  0007
      00167  0077
      00170  0544
      00171  1734
      00172  0742
      00173  0735
      00174  1741
      00175  5200
      00176  0761
      00177  0752
 3501              $&$

      No detected errors
      195 links generated
